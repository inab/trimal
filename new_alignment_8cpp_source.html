<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<title>trimAl: source/newAlignment.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0" width=100%>
 <tbody>
 <tr style="height: 12px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">trimAl
   &#20;<span id="projectnumber" style="font-size:12px">1.x</span>
   </div>
   <div id="projectbrief">A Multiple Alignment Sequence framework for Cleaning and Reformating.</div>
  </td>
<!--  <td style="float:right;margin-top:18px;vertical-align:bottom">
     <a href="http://assimilationsystems.com/download/">
       <img src="http://assimilationsystems.com/wp-content/uploads/2015/03/Download-Doxygen.png" style="float:right;" height="20" width="73">
     </a>
  </td>-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('new_alignment_8cpp_source.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">newAlignment.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &lt;TimerFactory.h&gt;</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">/* ***** ***** ***** ***** ***** ***** ***** ***** ***** ***** ***** ***** *****</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">   ***** ***** ***** ***** ***** ***** ***** ***** ***** ***** ***** ***** *****</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">    trimAl v1.4: a tool for automated newAlignment trimming in large-scale</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">                 phylogenetics analyses.</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">    readAl v1.4: a tool for automated newAlignment conversion among different</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">                 formats.</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">    statAl v1.4: a tool for getting stats about multiple sequence newAlignments.</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">    2009-2012 Capella-Gutierrez S. and Gabaldon, T.</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">              [scapella, tgabaldon]@crg.es</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">    This file is part of trimAl/readAl.</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">    trimAl/readAl are free software: you can redistribute it and/or modify</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">    it under the terms of the GNU General Public License as published by</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">    the Free Software Foundation, the last available version.</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">    trimAl/readAl are distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">    GNU General Public License for more details.</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">    You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">    along with trimAl/readAl. If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">***** ***** ***** ***** ***** ***** ***** ***** ***** ***** ***** ***** *****</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">***** ***** ***** ***** ***** ***** ***** ***** ***** ***** ***** ***** ***** */</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &lt;cfloat&gt;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;../include/newAlignment.h&quot;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;../include/Cleaner.h&quot;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &lt;cerrno&gt;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &lt;cctype&gt;</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;../include/values.h&quot;</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;../include/defines.h&quot;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &lt;sstream&gt;</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &lt;map&gt;</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;../include/reportsystem.h&quot;</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;../include/Statistics/statisticsGaps.h&quot;</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;../include/Statistics/statisticsConservation.h&quot;</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;../include/Statistics/statisticsConsistency.h&quot;</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="classnew_alignment.html#a07b1cb8e0045677f6684ff37352af1b1">   55</a></span>&#160;<a class="code" href="classnew_alignment.html#a07b1cb8e0045677f6684ff37352af1b1">newAlignment::newAlignment</a>() {</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="comment">// Create a timerLevel that will report times upon its destruction</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="comment">//  which means the end of the current scope.</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    StartTiming(<span class="stringliteral">&quot;newAlignment::newAlignment(void) &quot;</span>);</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    Cleaning = <span class="keyword">new</span> <a class="code" href="class_cleaner.html">Cleaner</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    Statistics = <span class="keyword">new</span> <a class="code" href="class_statistics_manager.html">StatisticsManager</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">// newAlignment parameter</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            originalResidNumber = 0;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            originalSequenNumber = 0;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    sequenNumber = 0;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    residNumber = 0;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">// Are the input sequences aligned?</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    isAligned = <span class="keyword">false</span>;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">// Sequence datatype: DNA, RNA or Protein</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    dataType = SequenceTypes::NotDefined;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="comment">// Columns and sequences that have been previously selected</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    saveResidues = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    saveSequences = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="comment">// Input sequences as well other information such as sequences name, etc </span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    sequences = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    seqsName = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    seqsInfo = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">// Information computed from newAlignment</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    SequencesMatrix = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    identities = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    SeqRef = <span class="keyword">new</span> int(1);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;}</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="classnew_alignment.html#a8e7fbe8f58d588cb10cb10981efb9915">   92</a></span>&#160;<a class="code" href="classnew_alignment.html#a07b1cb8e0045677f6684ff37352af1b1">newAlignment::newAlignment</a>(<a class="code" href="classnew_alignment.html">newAlignment</a> &amp;originalAlignment) {</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="comment">// Create a timerLevel that will report times upon its destruction</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">//  which means the end of the current scope.</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    StartTiming(<span class="stringliteral">&quot;newAlignment::newAlignment(newAlignment &amp;originalAlignment) &quot;</span>);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">this</span> != &amp;originalAlignment) {</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        filename = originalAlignment.<a class="code" href="classnew_alignment.html#a6c9904f7a01e200bd167f3cf736af4d6">filename</a>;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        aligInfo = originalAlignment.<a class="code" href="classnew_alignment.html#a34b1ee01d1030ce737034b35f3631e8a">aligInfo</a>;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        sequenNumber = originalAlignment.<a class="code" href="classnew_alignment.html#a4a6b47de8bef3e783f30548dfa48d84c">sequenNumber</a>;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        residNumber = originalAlignment.<a class="code" href="classnew_alignment.html#aff4e7761ec80bea74cdf28c0269b27db">residNumber</a>;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        isAligned = originalAlignment.<a class="code" href="classnew_alignment.html#ab6b16a670e278cd5e283573665fa450f">isAligned</a>;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        dataType = originalAlignment.<a class="code" href="classnew_alignment.html#ada2fb94cccdf0760c22dab39d278680c">dataType</a>;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        originalSequenNumber = originalAlignment.<a class="code" href="classnew_alignment.html#a6cdace1a82bc124173c80c978e42ac79">originalSequenNumber</a>;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        originalResidNumber = originalAlignment.<a class="code" href="classnew_alignment.html#a4250245146147c153df58a3334d7fb9d">originalResidNumber</a>;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        sequences = originalAlignment.<a class="code" href="classnew_alignment.html#a23f06ad268f0e720bf3d5699a4cb7225">sequences</a>;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        seqsName = originalAlignment.<a class="code" href="classnew_alignment.html#aa4bf60277ddf15e935a15b22becd6ad9">seqsName</a>;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        seqsInfo = originalAlignment.<a class="code" href="classnew_alignment.html#ad4e91d14819ffa8e6e57ae7c23d35327">seqsInfo</a>;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        saveSequences = <span class="keyword">new</span> <span class="keywordtype">int</span>[originalSequenNumber];</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        std::copy(originalAlignment.<a class="code" href="classnew_alignment.html#a76d057ddcebc7c88dd7f9e3ff0ce95bf">saveSequences</a>, originalAlignment.<a class="code" href="classnew_alignment.html#a76d057ddcebc7c88dd7f9e3ff0ce95bf">saveSequences</a> + originalAlignment.<a class="code" href="classnew_alignment.html#a6cdace1a82bc124173c80c978e42ac79">originalSequenNumber</a>, saveSequences);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        saveResidues = <span class="keyword">new</span> <span class="keywordtype">int</span>[originalResidNumber];</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        std::copy(originalAlignment.<a class="code" href="classnew_alignment.html#a5239bd4e742631b58efc7f09dd67f165">saveResidues</a>, originalAlignment.<a class="code" href="classnew_alignment.html#a5239bd4e742631b58efc7f09dd67f165">saveResidues</a> + originalAlignment.<a class="code" href="classnew_alignment.html#a4250245146147c153df58a3334d7fb9d">originalResidNumber</a>, saveResidues);</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        identities = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        SequencesMatrix = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        this-&gt;Cleaning = <span class="keyword">new</span> <a class="code" href="class_cleaner.html">Cleaner</a>(<span class="keyword">this</span>, originalAlignment.<a class="code" href="classnew_alignment.html#a2417feb815493866d0137ae5f5cd1028">Cleaning</a>);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        this-&gt;Statistics = <span class="keyword">new</span> <a class="code" href="class_statistics_manager.html">StatisticsManager</a>(<span class="keyword">this</span>, originalAlignment.<a class="code" href="classnew_alignment.html#a6324267e64b68bb85d993cf602d008eb">Statistics</a>);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        this-&gt;SeqRef = originalAlignment.<a class="code" href="classnew_alignment.html#a94afba152da4b05735f429781cd3da57">SeqRef</a>;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        (*SeqRef)++;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    }</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;}</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="classnew_alignment.html#a02ca374daf15b6af5fdf88c75454323a">  138</a></span>&#160;<a class="code" href="classnew_alignment.html#a02ca374daf15b6af5fdf88c75454323a">newAlignment::~newAlignment</a>() {</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">// Create a timerLevel that will report times upon its destruction</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">//  which means the end of the current scope.</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    StartTiming(<span class="stringliteral">&quot;newAlignment::~newAlignment(void) &quot;</span> + std::to_string(reinterpret_cast&lt;uintptr_t&gt;(<span class="keyword">this</span>)));</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keyword">delete</span>[] saveResidues;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    saveResidues = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keyword">delete</span>[] saveSequences;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    saveSequences = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">if</span> (identities != <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; sequenNumber; i++)</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            <span class="keyword">delete</span>[] identities[i];</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keyword">delete</span>[] identities;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    }</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    identities = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keyword">delete</span> SequencesMatrix;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    SequencesMatrix = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    sequenNumber = 0;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    residNumber = 0;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    isAligned = <span class="keyword">false</span>;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keyword">delete</span> Cleaning;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    Cleaning = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keyword">delete</span> Statistics;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    Statistics = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">if</span> (--(*SeqRef) == 0) {</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keyword">delete</span> SeqRef;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="keyword">delete</span>[] sequences;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        sequences = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="keyword">delete</span>[] seqsName;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        seqsName = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="keyword">delete</span>[] seqsInfo;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        seqsInfo = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*SeqRef &lt; 0) {</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="keyword">delete</span> SeqRef;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        SeqRef = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    }</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;}</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno"><a class="line" href="classnew_alignment.html#a781fd0f2ae6a9bda2802ffd28372bfaa">  190</a></span>&#160;<a class="code" href="classnew_alignment.html">newAlignment</a> *<a class="code" href="classnew_alignment.html#a781fd0f2ae6a9bda2802ffd28372bfaa">newAlignment::getTranslationCDS</a>(<a class="code" href="classnew_alignment.html">newAlignment</a> *ProtAlig) {</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">// Create a timerLevel that will report times upon its destruction</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">//  which means the end of the current scope.</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    StartTiming(<span class="stringliteral">&quot;newAlignment *newAlignment::getTranslationCDS(newAlignment *ProtAlig) &quot;</span>);</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordtype">int</span> x, y, counter, *mappedSeqs;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <a class="code" href="classnew_alignment.html">newAlignment</a> *newAlig = <span class="keyword">new</span> <a class="code" href="classnew_alignment.html">newAlignment</a>();</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">// Map the selected protein sequences to the input</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">// coding sequences</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    mappedSeqs = <span class="keyword">new</span> <span class="keywordtype">int</span>[ProtAlig-&gt;<a class="code" href="classnew_alignment.html#a4a6b47de8bef3e783f30548dfa48d84c">sequenNumber</a>];</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">for</span> (x = 0; x &lt; ProtAlig-&gt;<a class="code" href="classnew_alignment.html#a6cdace1a82bc124173c80c978e42ac79">originalSequenNumber</a>; x++) {</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="keywordflow">for</span> (y = 0; y &lt; originalSequenNumber; y++) {</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            <span class="keywordflow">if</span> (ProtAlig-&gt;<a class="code" href="classnew_alignment.html#aa4bf60277ddf15e935a15b22becd6ad9">seqsName</a>[x] == seqsName[y]) {</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                mappedSeqs[x] = y;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            }</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        }</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    }</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    newAlig-&gt;<a class="code" href="classnew_alignment.html#a23f06ad268f0e720bf3d5699a4cb7225">sequences</a> = <span class="keyword">new</span> std::string[ProtAlig-&gt;<a class="code" href="classnew_alignment.html#a4a6b47de8bef3e783f30548dfa48d84c">sequenNumber</a>];</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    newAlig-&gt;<a class="code" href="classnew_alignment.html#ad4e91d14819ffa8e6e57ae7c23d35327">seqsInfo</a> = <span class="keyword">new</span> std::string[ProtAlig-&gt;<a class="code" href="classnew_alignment.html#a4a6b47de8bef3e783f30548dfa48d84c">sequenNumber</a>];</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    newAlig-&gt;<a class="code" href="classnew_alignment.html#aa4bf60277ddf15e935a15b22becd6ad9">seqsName</a> = <span class="keyword">new</span> std::string[ProtAlig-&gt;<a class="code" href="classnew_alignment.html#a4a6b47de8bef3e783f30548dfa48d84c">sequenNumber</a>];</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">for</span> (x = 0; x &lt; ProtAlig-&gt;<a class="code" href="classnew_alignment.html#a6cdace1a82bc124173c80c978e42ac79">originalSequenNumber</a>; x++) {</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        newAlig-&gt;<a class="code" href="classnew_alignment.html#a23f06ad268f0e720bf3d5699a4cb7225">sequences</a>[x] = *<span class="keyword">new</span> std::string[ProtAlig-&gt;<a class="code" href="classnew_alignment.html#a23f06ad268f0e720bf3d5699a4cb7225">sequences</a>[x].size()];</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        std::string &amp;current = newAlig-&gt;<a class="code" href="classnew_alignment.html#a23f06ad268f0e720bf3d5699a4cb7225">sequences</a>[x];</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="keywordflow">if</span> (ProtAlig-&gt;<a class="code" href="classnew_alignment.html#ad4e91d14819ffa8e6e57ae7c23d35327">seqsInfo</a> != <span class="keyword">nullptr</span>)</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            newAlig-&gt;<a class="code" href="classnew_alignment.html#ad4e91d14819ffa8e6e57ae7c23d35327">seqsInfo</a>[x] = *<span class="keyword">new</span> std::string(ProtAlig-&gt;<a class="code" href="classnew_alignment.html#ad4e91d14819ffa8e6e57ae7c23d35327">seqsInfo</a>[x]);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        newAlig-&gt;<a class="code" href="classnew_alignment.html#aa4bf60277ddf15e935a15b22becd6ad9">seqsName</a>[x] = *<span class="keyword">new</span> std::string(ProtAlig-&gt;<a class="code" href="classnew_alignment.html#aa4bf60277ddf15e935a15b22becd6ad9">seqsName</a>[x]);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="keywordflow">for</span> (y = 0, counter = 0; y &lt; ProtAlig-&gt;<a class="code" href="classnew_alignment.html#a23f06ad268f0e720bf3d5699a4cb7225">sequences</a>[x].size(); y++) {</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            <span class="keywordflow">if</span> (ProtAlig-&gt;<a class="code" href="classnew_alignment.html#a5239bd4e742631b58efc7f09dd67f165">saveResidues</a>[y] == -1) {</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                <span class="keywordflow">if</span> (ProtAlig-&gt;<a class="code" href="classnew_alignment.html#a23f06ad268f0e720bf3d5699a4cb7225">sequences</a>[x][y] != <span class="charliteral">&#39;-&#39;</span>) counter++;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            }</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            <span class="keywordflow">if</span> (ProtAlig-&gt;<a class="code" href="classnew_alignment.html#a23f06ad268f0e720bf3d5699a4cb7225">sequences</a>[x][y] == <span class="charliteral">&#39;-&#39;</span>) {</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                current.push_back(<span class="charliteral">&#39;-&#39;</span>);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                current.push_back(<span class="charliteral">&#39;-&#39;</span>);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                current.push_back(<span class="charliteral">&#39;-&#39;</span>);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            }</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            current.push_back(sequences[mappedSeqs[x]][counter * 3]);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            current.push_back(sequences[mappedSeqs[x]][counter * 3 + 1]);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            current.push_back(sequences[mappedSeqs[x]][counter * 3 + 2]);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            counter++;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        }</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        current.shrink_to_fit();</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    }</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    newAlig-&gt;<a class="code" href="classnew_alignment.html#a4a6b47de8bef3e783f30548dfa48d84c">sequenNumber</a> = ProtAlig-&gt;<a class="code" href="classnew_alignment.html#a4a6b47de8bef3e783f30548dfa48d84c">sequenNumber</a>;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    newAlig-&gt;<a class="code" href="classnew_alignment.html#a6cdace1a82bc124173c80c978e42ac79">originalSequenNumber</a> = ProtAlig-&gt;<a class="code" href="classnew_alignment.html#a4a6b47de8bef3e783f30548dfa48d84c">sequenNumber</a>;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">return</span> newAlig;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;}</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno"><a class="line" href="classnew_alignment.html#acfd820148c267a3d698a39758ecf190d">  251</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classnew_alignment.html#acfd820148c267a3d698a39758ecf190d">newAlignment::getNumSpecies</a>(<span class="keywordtype">void</span>) {</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">// Create a timerLevel that will report times upon its destruction</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="comment">//  which means the end of the current scope.</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    StartTiming(<span class="stringliteral">&quot;int newAlignment::getNumSpecies(void) &quot;</span>);</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordflow">return</span> sequenNumber;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;}</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno"><a class="line" href="classnew_alignment.html#ad08d05c08eb66665defed4a16ab08e91">  258</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classnew_alignment.html#ad08d05c08eb66665defed4a16ab08e91">newAlignment::getNumAminos</a>(<span class="keywordtype">void</span>) {</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="comment">// Create a timerLevel that will report times upon its destruction</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">//  which means the end of the current scope.</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    StartTiming(<span class="stringliteral">&quot;int newAlignment::getNumAminos(void) &quot;</span>);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">return</span> residNumber;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;}</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="classnew_alignment.html#a8dd7e7438161fcaca8c8f35e63c5079e">  265</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classnew_alignment.html#a8dd7e7438161fcaca8c8f35e63c5079e">newAlignment::setWindowsSize</a>(<span class="keywordtype">int</span> ghWindow_, <span class="keywordtype">int</span> shWindow_) {</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">// Create a timerLevel that will report times upon its destruction</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="comment">//  which means the end of the current scope.</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    StartTiming(<span class="stringliteral">&quot;void newAlignment::setWindowsSize(int ghWindow_, int shWindow_) &quot;</span>);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    Statistics-&gt;ghWindow = ghWindow_;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    Statistics-&gt;shWindow = shWindow_;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;}</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno"><a class="line" href="classnew_alignment.html#a42894635dca6466308d9e21cec14d365">  273</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classnew_alignment.html#a42894635dca6466308d9e21cec14d365">newAlignment::setBlockSize</a>(<span class="keywordtype">int</span> blockSize_) {</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="comment">// Create a timerLevel that will report times upon its destruction</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="comment">//  which means the end of the current scope.</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    StartTiming(<span class="stringliteral">&quot;void newAlignment::setBlockSize(int blockSize_) &quot;</span>);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    Cleaning-&gt;blockSize = blockSize_;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;}</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno"><a class="line" href="classnew_alignment.html#a29f7f52115fd4ecf13120e54c71b1a1a">  280</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classnew_alignment.html#a29f7f52115fd4ecf13120e54c71b1a1a">newAlignment::setKeepSequencesFlag</a>(<span class="keywordtype">bool</span> flag) {</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="comment">// Create a timerLevel that will report times upon its destruction</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="comment">//  which means the end of the current scope.</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    StartTiming(<span class="stringliteral">&quot;void newAlignment::setKeepSequencesFlag(bool flag) &quot;</span>);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    Cleaning-&gt;keepSequences = flag;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;}</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div><div class="line"><a name="l00287"></a><span class="lineno"><a class="line" href="classnew_alignment.html#a66015efb0c5b9cd596d02d3c736cffe3">  287</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classnew_alignment.html#a66015efb0c5b9cd596d02d3c736cffe3">newAlignment::setKeepSeqsHeaderFlag</a>(<span class="keywordtype">bool</span> newFlagValue) {</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="comment">// Create a timerLevel that will report times upon its destruction</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="comment">//  which means the end of the current scope.</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    StartTiming(<span class="stringliteral">&quot;void newAlignment::setKeepSeqsHeaderFlag(bool flag) &quot;</span>);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    Cleaning-&gt;keepSequences = newFlagValue;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;}</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno"><a class="line" href="classnew_alignment.html#a4761e21288fc15f3b86cf80dd4c6c91b">  295</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classnew_alignment.html#a4761e21288fc15f3b86cf80dd4c6c91b">newAlignment::getBlockSize</a>() {</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="comment">// Create a timerLevel that will report times upon its destruction</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment">//  which means the end of the current scope.</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    StartTiming(<span class="stringliteral">&quot;int newAlignment::getBlockSize(void) &quot;</span>);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordflow">return</span> Cleaning-&gt;blockSize;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;}</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno"><a class="line" href="classnew_alignment.html#aa9178bd574db2b6171c0bb09133bdb94">  302</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classnew_alignment.html#aa9178bd574db2b6171c0bb09133bdb94">newAlignment::calculateSeqIdentity</a>() {</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="comment">// Create a timerLevel that will report times upon its destruction</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="comment">//  which means the end of the current scope.</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    StartTiming(<span class="stringliteral">&quot;void newAlignment::calculateSeqIdentity(void) &quot;</span>);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordtype">int</span> i, j, k, hit, dst;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordtype">char</span> indet;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="comment">// Depending on alignment type, indetermination symbol will be one or other</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    indet = getAlignmentType() &amp; <a class="code" href="defines_8h.html#a69d5409d6e7370d6bd3b4f931702e936adf8e3bb19d1b4de18399b64a58a39590">SequenceTypes::AA</a> ? <span class="charliteral">&#39;X&#39;</span> : <span class="charliteral">&#39;N&#39;</span>;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">// Create identities matrix to store identities scores</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    identities = <span class="keyword">new</span> <span class="keywordtype">float</span> *[sequenNumber];</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="comment">// For each seq, compute its identity score against the others in the MSA</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; sequenNumber; i++) {</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        identities[i] = <span class="keyword">new</span> <span class="keywordtype">float</span>[sequenNumber];</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="comment">// It&#39;s a symmetric matrix, copy values that have been already computed</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; i; j++)</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            identities[i][j] = identities[j][i];</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        identities[i][i] = 0;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="comment">// Compute identity scores for the current sequence against the rest</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="keywordflow">for</span> (j = i + 1; j &lt; sequenNumber; j++) {</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            <span class="keywordflow">for</span> (k = 0, hit = 0, dst = 0; k &lt; residNumber; k++) {</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                <span class="comment">// If one of the two positions is a valid residue,</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                <span class="comment">// count it for the common length</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                <span class="keywordflow">if</span> (((sequences[i][k] != indet) &amp;&amp; (sequences[i][k] != <span class="charliteral">&#39;-&#39;</span>)) ||</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                    ((sequences[j][k] != indet) &amp;&amp; (sequences[j][k] != <span class="charliteral">&#39;-&#39;</span>))) {</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                    dst++;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                    <span class="comment">// If both positions are the same, count a hit</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                    <span class="keywordflow">if</span> (sequences[i][k] == sequences[j][k])</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                        hit++;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                }</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            }</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            <span class="comment">// Identity score between two sequences is the ratio of identical residues</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            <span class="comment">// by the total length (common and no-common residues) among them</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            identities[i][j] = (float) hit / dst;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        }</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    }</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;}</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno"><a class="line" href="classnew_alignment.html#adaeafc911344fc10069f40d9fc41303f">  346</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classnew_alignment.html#adaeafc911344fc10069f40d9fc41303f">newAlignment::calculateRelaxedSeqIdentity</a>() {</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="comment">// Create a timerLevel that will report times upon its destruction</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="comment">//  which means the end of the current scope.</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    StartTiming(<span class="stringliteral">&quot;void newAlignment::calculateRelaxedSeqIdentity(void) &quot;</span>);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="comment">// Raw approximation of sequence identity computation designed for reducing</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">// comparisons for huge alignemnts</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordtype">int</span> i, j, k, hit;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">// Create identities matrix to store identities scores</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    identities = <span class="keyword">new</span> <span class="keywordtype">float</span> *[sequenNumber];</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="comment">// For each seq, compute its identity score against the others in the MSA</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; sequenNumber; i++) {</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        identities[i] = <span class="keyword">new</span> <span class="keywordtype">float</span>[sequenNumber];</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="comment">// It&#39;s a symmetric matrix, copy values that have been already computed</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; i; j++)</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            identities[i][j] = identities[j][i];</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        identities[i][i] = 0;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="comment">// Compute identity score between the selected sequence and the others</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <span class="keywordflow">for</span> (j = i + 1; j &lt; sequenNumber; j++) {</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            <span class="keywordflow">for</span> (k = 0, hit = 0; k &lt; residNumber; k++) {</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                <span class="comment">// If both positions are the same, count a hit</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                <span class="keywordflow">if</span> (sequences[i][k] == sequences[j][k])</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                    hit++;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            }</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            <span class="comment">// Raw identity score is computed as the ratio of identical residues between</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            <span class="comment">// alignment length</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            identities[i][j] = (float) hit / residNumber;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        }</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    }</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;}</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno"><a class="line" href="classnew_alignment.html#ae157ddd55e9f41d809fb664116619802">  382</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classnew_alignment.html#ae157ddd55e9f41d809fb664116619802">newAlignment::calculateSeqOverlap</a>() {</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="comment">// Create a timerLevel that will report times upon its destruction</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="comment">//  which means the end of the current scope.</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    StartTiming(<span class="stringliteral">&quot;void newAlignment::calculateSeqOverlap(void) &quot;</span>);</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="comment">// Compute the overlap between sequences taken each of them as the reference</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="comment">// to compute such scores. It will lead to a non-symmetric matrix.</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keywordtype">int</span> i, j, k, shared, referenceLength;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordtype">char</span> indet;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="comment">// Depending on alignment type, indetermination symbol will be one or other</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    indet = getAlignmentType() &amp; <a class="code" href="defines_8h.html#a69d5409d6e7370d6bd3b4f931702e936adf8e3bb19d1b4de18399b64a58a39590">SequenceTypes::AA</a> ? <span class="charliteral">&#39;X&#39;</span> : <span class="charliteral">&#39;N&#39;</span>;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="comment">// Create overlap matrix to store overlap scores</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    overlaps = <span class="keyword">new</span> <span class="keywordtype">float</span> *[sequenNumber];</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="comment">// For each seq, compute its overlap score against the others in the MSA</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; sequenNumber; i++) {</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        overlaps[i] = <span class="keyword">new</span> <span class="keywordtype">float</span>[sequenNumber];</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; sequenNumber; j++) {</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            <span class="keywordflow">for</span> (k = 0, shared = 0, referenceLength = 0; k &lt; residNumber; k++) {</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                <span class="comment">// If there a valid residue for the reference sequence, then see if</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                <span class="comment">// there is a valid residue for the other sequence.</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                <span class="keywordflow">if</span> ((sequences[i][k] != indet) &amp;&amp; (sequences[i][k] != <span class="charliteral">&#39;-&#39;</span>)) {</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                    referenceLength++;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                    <span class="keywordflow">if</span> ((sequences[j][k] != indet) &amp;&amp; (sequences[j][k] != <span class="charliteral">&#39;-&#39;</span>))</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                        shared++;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                }</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            }</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            <span class="comment">// Overlap score between two sequences is the ratio of shared valid</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            <span class="comment">// residues divided by the sequence length taken as reference. The</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            <span class="comment">// overlaps matrix, therefore, will be not symmetric.</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            overlaps[i][j] = (float) shared / referenceLength;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        }</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    }</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;}</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00420"></a><span class="lineno"><a class="line" href="classnew_alignment.html#a0db3e76f82a71c7a2fe5b9279f8fa310">  420</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classnew_alignment.html#a0db3e76f82a71c7a2fe5b9279f8fa310">newAlignment::getSequences</a>(<span class="keywordtype">string</span> *Names) {</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">// Create a timerLevel that will report times upon its destruction</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="comment">//  which means the end of the current scope.</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    StartTiming(<span class="stringliteral">&quot;void newAlignment::getSequences(string *Names) &quot;</span>);</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; sequenNumber; i++)</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        Names[i] = seqsName[i];</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;}</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno"><a class="line" href="classnew_alignment.html#af32ab6b3b73c5ad37c9f1c796a4fbc44">  428</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classnew_alignment.html#a0db3e76f82a71c7a2fe5b9279f8fa310">newAlignment::getSequences</a>(<span class="keywordtype">string</span> *Names, <span class="keywordtype">int</span> *lengths) {</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="comment">// Create a timerLevel that will report times upon its destruction</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="comment">//  which means the end of the current scope.</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    StartTiming(<span class="stringliteral">&quot;void newAlignment::getSequences(string *Names, int *lengths) &quot;</span>);</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; sequenNumber; i++) {</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        lengths[i] = (int) <a class="code" href="classutils.html#a1dce160519187ef2c6e14beb93a2050d">utils::removeCharacter</a>(<span class="charliteral">&#39;-&#39;</span>, sequences[i]).length();</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        Names[i] = seqsName[i];</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    }</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;}</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno"><a class="line" href="classnew_alignment.html#a2fc0d691c0cce400f007446cc162704e">  438</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classnew_alignment.html#a0db3e76f82a71c7a2fe5b9279f8fa310">newAlignment::getSequences</a>(<span class="keywordtype">string</span> *Names, <span class="keywordtype">string</span> *Sequences, <span class="keywordtype">int</span> *Lengths) {</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="comment">// Create a timerLevel that will report times upon its destruction</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="comment">//  which means the end of the current scope.</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    StartTiming(<span class="stringliteral">&quot;void newAlignment::getSequences(string *Names, string *Sequences, int *Lengths) &quot;</span>);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; sequenNumber; i++) {</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        Names[i] = seqsName[i];</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        Sequences[i] = <a class="code" href="classutils.html#a1dce160519187ef2c6e14beb93a2050d">utils::removeCharacter</a>(<span class="charliteral">&#39;-&#39;</span>, sequences[i]);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        Lengths[i] = (int) Sequences[i].length();</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    }</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;}</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno"><a class="line" href="classnew_alignment.html#ac3d5c9670904bba45707746640aac382">  449</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classnew_alignment.html#ac3d5c9670904bba45707746640aac382">newAlignment::getSequenceNameOrder</a>(<span class="keywordtype">string</span> *names, <span class="keywordtype">int</span> *orderVector) {</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="comment">// Create a timerLevel that will report times upon its destruction</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="comment">//  which means the end of the current scope.</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    StartTiming(<span class="stringliteral">&quot;bool newAlignment::getSequenceNameOrder(string *names, int *orderVector) &quot;</span>);</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordtype">int</span> i, j, numNames;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="comment">// For each name in the current newAlignment, we look</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="comment">// for its correspondence in the input set</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordflow">for</span> (i = 0, numNames = 0; i &lt; sequenNumber; i++) {</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; sequenNumber; j++) {</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            <span class="keywordflow">if</span> (seqsName[i] == names[j]) {</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                orderVector[i] = j;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                numNames++;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            }</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        }</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    }</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="comment">// Depending on if we get the complete correspondence</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="comment">// between both sets of names, we return true or not</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordflow">return</span> sequenNumber == numNames ? true : <span class="keyword">false</span>;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;}</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div><div class="line"><a name="l00473"></a><span class="lineno"><a class="line" href="classnew_alignment.html#a670d5ef1ced9ed6041c3f6afdbd2cc02">  473</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classnew_alignment.html#a670d5ef1ced9ed6041c3f6afdbd2cc02">newAlignment::getAlignmentType</a>() {</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="comment">// Create a timerLevel that will report times upon its destruction</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="comment">//  which means the end of the current scope.</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    StartTiming(<span class="stringliteral">&quot;int newAlignment::getAlignmentType(void) &quot;</span>);</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordflow">if</span> (dataType == 0)</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        dataType = <a class="code" href="classutils.html#a1f1dcbfa7276e54acec72bdbae1b1255">utils::checkAlignmentType</a>(sequenNumber, residNumber, sequences);</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordflow">return</span> dataType;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;}</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div><div class="line"><a name="l00482"></a><span class="lineno"><a class="line" href="classnew_alignment.html#ace3be92e3229fc241557597090977ba5">  482</a></span>&#160;<span class="keywordtype">int</span> *<a class="code" href="classnew_alignment.html#ace3be92e3229fc241557597090977ba5">newAlignment::getCorrespResidues</a>() {</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="comment">// Create a timerLevel that will report times upon its destruction</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="comment">//  which means the end of the current scope.</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    StartTiming(<span class="stringliteral">&quot;int *newAlignment::getCorrespResidues(void) &quot;</span>);</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keywordflow">return</span> saveResidues;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;}</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno"><a class="line" href="classnew_alignment.html#a0c3cd77c8a6b118efb84b577bb4ab1ce">  489</a></span>&#160;<span class="keywordtype">int</span> *<a class="code" href="classnew_alignment.html#a0c3cd77c8a6b118efb84b577bb4ab1ce">newAlignment::getCorrespSequences</a>() {</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="comment">// Create a timerLevel that will report times upon its destruction</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="comment">//  which means the end of the current scope.</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    StartTiming(<span class="stringliteral">&quot;int *newAlignment::getCorrespSequences(void) &quot;</span>);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordflow">return</span> saveSequences;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;}</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div><div class="line"><a name="l00496"></a><span class="lineno"><a class="line" href="classnew_alignment.html#ab865e218a05742c00d604f4a71ce9e10">  496</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classnew_alignment.html#ab865e218a05742c00d604f4a71ce9e10">newAlignment::isFileAligned</a>() {</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="comment">// Create a timerLevel that will report times upon its destruction</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="comment">//  which means the end of the current scope.</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    StartTiming(<span class="stringliteral">&quot;bool newAlignment::isFileAligned(void) &quot;</span>);</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="keywordflow">return</span> isAligned;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;}</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div><div class="line"><a name="l00503"></a><span class="lineno"><a class="line" href="classnew_alignment.html#a3de39c62c08a265178f1fa7df76c3ab7">  503</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classnew_alignment.html#a3de39c62c08a265178f1fa7df76c3ab7">newAlignment::fillNewDataStructure</a>(<span class="keywordtype">string</span> *newMatrix, <span class="keywordtype">string</span> *newNames) {</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="comment">// Create a timerLevel that will report times upon its destruction</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="comment">//  which means the end of the current scope.</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    StartTiming(<span class="stringliteral">&quot;void newAlignment::fillNewDataStructure(string *newMatrix, string *newNames) &quot;</span>);</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="comment">// TODO Remove method as it doesn&#39;t make sense now</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordtype">int</span> i, j, k;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="comment">// Copy only those sequences/columns selected</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordflow">for</span> (i = 0, j = 0; i &lt; sequenNumber; i++) {</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="keywordflow">if</span> (saveSequences[i] == -1)</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        newNames[j] = seqsName[i];</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="keywordflow">for</span> (k = 0; k &lt; residNumber; k++) {</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;            <span class="keywordflow">if</span> (saveResidues[k] == -1)</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            newMatrix[j].resize(newMatrix[j].size() + 1, sequences[i][k]);</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        }</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        j++;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    }</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;}</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div><div class="line"><a name="l00525"></a><span class="lineno"><a class="line" href="classnew_alignment.html#ad50ba126247276cd0bf89119e439c483">  525</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classnew_alignment.html#ad50ba126247276cd0bf89119e439c483">newAlignment::prepareCodingSequence</a>(<span class="keywordtype">bool</span> splitByStopCodon, <span class="keywordtype">bool</span> ignStopCodon, <a class="code" href="classnew_alignment.html">newAlignment</a> *proteinAlig) {</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="comment">// Create a timerLevel that will report times upon its destruction</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="comment">//  which means the end of the current scope.</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    StartTiming(<span class="stringliteral">&quot;bool newAlignment::prepareCodingSequence(bool splitByStopCodon, bool ignStopCodon, newAlignment *proteinAlig) &quot;</span>);</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordflow">if</span> (getAlignmentType() &amp; <a class="code" href="defines_8h.html#a69d5409d6e7370d6bd3b4f931702e936adf8e3bb19d1b4de18399b64a58a39590">SequenceTypes::AA</a>) {</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        debug.<a class="code" href="class____internal_report_1_1____report_system.html#acd358cbc59625c6e2f47e0b5f825400d">report</a>(ErrorCode::CDScontainsProteinSequences);</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    }</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keywordtype">bool</span> warning = <span class="keyword">false</span>;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordtype">long</span> found;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="comment">// New code: We now care about the presence of wildcards/indeterminations</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="comment">// characters such as &#39;X&#39; or &#39;B&#39; into protein sequences as well as about the</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="comment">// presence of Selenocysteines (&#39;U&#39;) or Pyrrolysines (&#39;O&#39;). It only works, by</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="comment">// now, with the universal genetic code </span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="keywordtype">int</span> *protSeqsLengths, numbProtSeqs, current_prot;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="keywordtype">string</span> *protSeqsNames, *protSequences;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="keywordtype">char</span> aminoAcid;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    numbProtSeqs = proteinAlig-&gt;<a class="code" href="classnew_alignment.html#acfd820148c267a3d698a39758ecf190d">getNumSpecies</a>();</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    protSeqsNames = <span class="keyword">new</span> <span class="keywordtype">string</span>[numbProtSeqs];</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    protSequences = <span class="keyword">new</span> <span class="keywordtype">string</span>[numbProtSeqs];</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    protSeqsLengths = <span class="keyword">new</span> <span class="keywordtype">int</span>[numbProtSeqs];</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    proteinAlig-&gt;<a class="code" href="classnew_alignment.html#a0db3e76f82a71c7a2fe5b9279f8fa310">getSequences</a>(protSeqsNames, protSequences, protSeqsLengths);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="comment">/* Check read sequences are real DNA/RNA */</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; sequenNumber; i++) {</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <span class="comment">// Get protein sequence to compare against any potential stop codon in the</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        <span class="comment">// coding sequence. If there is not protein sequence for current coding</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <span class="comment">// sequence, skip its analysis</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <span class="keywordflow">for</span> (current_prot = 0; current_prot &lt; numbProtSeqs; current_prot++)</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;            <span class="keywordflow">if</span> (protSeqsNames[current_prot] == seqsName[i])</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        <span class="keywordflow">if</span> (current_prot == numbProtSeqs)</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        <span class="keywordflow">if</span> (sequences[i].find(<span class="charliteral">&#39;-&#39;</span>) != string::npos) {</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            <span class="keywordflow">if</span> (!warning)</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                cerr &lt;&lt; endl;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            debug.<a class="code" href="class____internal_report_1_1____report_system.html#acd358cbc59625c6e2f47e0b5f825400d">report</a>(ErrorCode::SequenceContainsGap, <span class="keyword">new</span> std::string[1]{seqsName[i]});</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        }</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        <span class="keywordflow">if</span> ((sequences[i].length() % 3) != 0) {</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;            <span class="keywordflow">if</span> (!warning)</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                cerr &lt;&lt; endl;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            warning = <span class="keyword">true</span>;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            debug.<a class="code" href="class____internal_report_1_1____report_system.html#acd358cbc59625c6e2f47e0b5f825400d">report</a>(ErrorCode::SequenceNotMultipleOfThree, <span class="keyword">new</span> std::string[2]{seqsName[i], std::to_string(sequences[i].length())});</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        }</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <span class="comment">// Ignore stop codons from the CDS if set by the user</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <span class="keywordflow">if</span> (ignStopCodon)</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <span class="comment">// Detect universal stop codons in the CDS. Then, compare those stop codons</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        <span class="comment">// against the protein sequence to see whether they are real stop codons or</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        <span class="comment">// are representing rare amino-acids such as Selenocysteines or Pyrrolysines</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <span class="comment">// It also allows stop-codons when there are wildcards/indet characters in</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        <span class="comment">// the protein sequence. CDS sequences could be splitted using stop codons</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <span class="comment">// from the sequence itself</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <span class="comment">// Initialize first appearence of a given stop codon to -1.</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <span class="comment">// That means that it has not been found yet</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        found = -1;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <span class="keywordflow">do</span> {</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;            found = sequences[i].find(<span class="stringliteral">&quot;TGA&quot;</span>, found + 1);</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            <span class="comment">// If a stop codon has been found and its position is multiple of 3.</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;            <span class="comment">// Analize it</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            <span class="keywordflow">if</span> ((found != string::npos) &amp;&amp; (((<span class="keywordtype">int</span>) found % 3) == 0)) {</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                aminoAcid = (char) toupper(protSequences[current_prot][(<span class="keywordtype">int</span>) found / 3]);</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                <span class="comment">// It may be a Selenocysteine (&#39;TGA&#39;) which should be represented as &#39;U&#39;</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                <span class="comment">// or wildcard/indet characters such as &#39;X&#39; or &#39;B&#39;</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                <span class="comment">// If a rare amino-acids such as &#39;U&#39;/&#39;O&#39; or a wildcard/indet character</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                <span class="comment">// such as &#39;B&#39;/&#39;X&#39; is present, skip current stop codon</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                <span class="keywordflow">if</span> ((aminoAcid == <span class="charliteral">&#39;U&#39;</span>) || (aminoAcid == <span class="charliteral">&#39;O&#39;</span>) || (aminoAcid == <span class="charliteral">&#39;X&#39;</span>) || \</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                        (aminoAcid == <span class="charliteral">&#39;B&#39;</span>))</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                    <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                    <span class="comment">// If split_by_stop_codon flag is activated then cut input CDS sequence</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                    <span class="comment">// up to first appearance of a stop codon</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (splitByStopCodon) {</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                    warning = <span class="keyword">true</span>;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                    debug.<a class="code" href="class____internal_report_1_1____report_system.html#acd358cbc59625c6e2f47e0b5f825400d">report</a>(InfoCode::CuttingSequence, <span class="keyword">new</span> std::string[5]{seqsName[i], <span class="stringliteral">&quot;TGA&quot;</span>, std::to_string(aminoAcid), std::to_string(found + 1), std::to_string(sequences[i].length())});</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                    sequences[i].resize(found);</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                }</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                    <span class="comment">// Otherwise, warn about it and return an error</span></div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                <span class="keywordflow">else</span> {</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                    debug.<a class="code" href="class____internal_report_1_1____report_system.html#acd358cbc59625c6e2f47e0b5f825400d">report</a>(ErrorCode::SequenceHasStopCodon, <span class="keyword">new</span> std::string[5]{seqsName[i], <span class="stringliteral">&quot;TGA&quot;</span>, std::to_string(aminoAcid), std::to_string(found + 1), std::to_string(sequences[i].length())});</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                }</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            }</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            <span class="comment">// Iterate over the CDS until not stop codon is found</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        } <span class="keywordflow">while</span> (found != string::npos);</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        <span class="comment">// Initialize first appearence of a given stop codon to -1.</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        <span class="comment">// That means that it has not been found yet</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        found = -1;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        <span class="keywordflow">do</span> {</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            found = sequences[i].find(<span class="stringliteral">&quot;TAA&quot;</span>, found + 1);</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            <span class="comment">// If a stop codon has been found and its position is multiple of 3.</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            <span class="comment">// Analize it</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            <span class="keywordflow">if</span> ((found != string::npos) &amp;&amp; (((<span class="keywordtype">int</span>) found % 3) == 0)) {</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                aminoAcid = (char) toupper(protSequences[current_prot][(<span class="keywordtype">int</span>) found / 3]);</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                <span class="comment">// Check if there is any wildcard/indet characters such as &#39;X&#39; or &#39;B&#39;</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                <span class="comment">// If a rare amino-acids such as &#39;U&#39;/&#39;O&#39; or a wildcard/indet character</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                <span class="comment">// such as &#39;B&#39;/&#39;X&#39; is present, skip current stop codon</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                <span class="keywordflow">if</span> ((aminoAcid == <span class="charliteral">&#39;U&#39;</span>) || (aminoAcid == <span class="charliteral">&#39;O&#39;</span>) || (aminoAcid == <span class="charliteral">&#39;X&#39;</span>) || \</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                        (aminoAcid == <span class="charliteral">&#39;B&#39;</span>))</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                    <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                    <span class="comment">// If split_by_stop_codon flag is activated then cut input CDS sequence</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                    <span class="comment">// up to first appearance of a stop codon</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (splitByStopCodon) {</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                    warning = <span class="keyword">true</span>;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                    debug.<a class="code" href="class____internal_report_1_1____report_system.html#acd358cbc59625c6e2f47e0b5f825400d">report</a>(InfoCode::CuttingSequence, <span class="keyword">new</span> std::string[5]{seqsName[i], <span class="stringliteral">&quot;TAA&quot;</span>, std::to_string(aminoAcid), std::to_string(found + 1), std::to_string(sequences[i].length())});</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                    sequences[i].resize(found);</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                }</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                    <span class="comment">// Otherwise, warn about it and return an error</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                <span class="keywordflow">else</span> {</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                    debug.<a class="code" href="class____internal_report_1_1____report_system.html#acd358cbc59625c6e2f47e0b5f825400d">report</a>(ErrorCode::SequenceHasStopCodon, <span class="keyword">new</span> std::string[5]{seqsName[i], <span class="stringliteral">&quot;TAA&quot;</span>, std::to_string(aminoAcid), std::to_string(found + 1), std::to_string(sequences[i].length())});</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                }</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            }</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            <span class="comment">// Iterate over the CDS until not stop codon is found</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        } <span class="keywordflow">while</span> (found != string::npos);</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        <span class="comment">// Initialize first appearence of a given stop codon to -1.</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <span class="comment">// That means that it has not been found yet</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        found = -1;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        <span class="keywordflow">do</span> {</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            found = sequences[i].find(<span class="stringliteral">&quot;TAG&quot;</span>, found + 1);</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            <span class="comment">// If a stop codon has been found and its position is multiple of 3.</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;            <span class="comment">// Analize it</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;            <span class="keywordflow">if</span> ((found != string::npos) &amp;&amp; (((<span class="keywordtype">int</span>) found % 3) == 0)) {</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                aminoAcid = (char) toupper(protSequences[current_prot][(<span class="keywordtype">int</span>) found / 3]);</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                <span class="comment">// It may be a Pyrrolysine (&#39;TAG&#39;) which should be represented as &#39;O&#39;</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                <span class="comment">// or wildcard/indet characters such as &#39;X&#39; or &#39;B&#39;</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                <span class="comment">// If a rare amino-acids such as &#39;U&#39;/&#39;O&#39; or a wildcard/indet character</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                <span class="comment">// such as &#39;B&#39;/&#39;X&#39; is present, skip current stop codon</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                <span class="keywordflow">if</span> ((aminoAcid == <span class="charliteral">&#39;U&#39;</span>) || (aminoAcid == <span class="charliteral">&#39;O&#39;</span>) || (aminoAcid == <span class="charliteral">&#39;X&#39;</span>) || \</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                        (aminoAcid == <span class="charliteral">&#39;B&#39;</span>))</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                    <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                    <span class="comment">// If split_by_stop_codon flag is activated then cut input CDS sequence</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                    <span class="comment">// up to first appearance of a stop codon</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (splitByStopCodon) {</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                    warning = <span class="keyword">true</span>;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                    debug.<a class="code" href="class____internal_report_1_1____report_system.html#acd358cbc59625c6e2f47e0b5f825400d">report</a>(InfoCode::CuttingSequence, <span class="keyword">new</span> std::string[5]{seqsName[i], <span class="stringliteral">&quot;TAG&quot;</span>, std::to_string(aminoAcid), std::to_string(found + 1), std::to_string(sequences[i].length())});</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                    sequences[i].resize(found);</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                }</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                    <span class="comment">// Otherwise, warn about it and return an error</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                <span class="keywordflow">else</span> {</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                    debug.<a class="code" href="class____internal_report_1_1____report_system.html#acd358cbc59625c6e2f47e0b5f825400d">report</a>(ErrorCode::SequenceHasStopCodon, <span class="keyword">new</span> std::string[5]{seqsName[i], <span class="stringliteral">&quot;TAG&quot;</span>, std::to_string(aminoAcid), std::to_string(found + 1), std::to_string(sequences[i].length())});</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                }</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;            }</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;            <span class="comment">// Iterate over the CDS until not stop codon is found</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        } <span class="keywordflow">while</span> (found != string::npos);</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    }</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <span class="comment">// If everything was return an OK to informat about it.</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;}</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;</div><div class="line"><a name="l00701"></a><span class="lineno"><a class="line" href="classnew_alignment.html#ae8501233fe4f4ef6bfe30c99c744c7c2">  701</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classnew_alignment.html#ae8501233fe4f4ef6bfe30c99c744c7c2">newAlignment::checkCorrespondence</a>(<span class="keywordtype">string</span> *names, <span class="keywordtype">int</span> *lengths, <span class="keywordtype">int</span> totalInputSeqs, <span class="keywordtype">int</span> multiple = 1) {</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="comment">// Create a timerLevel that will report times upon its destruction</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="comment">//  which means the end of the current scope.</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    StartTiming(<span class="stringliteral">&quot;bool newAlignment::checkCorrespondence(string *names, int *lengths, int totalInputSeqs, int multiple = 1)&quot;</span>);</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="keywordtype">int</span> i, j, seqLength, indet;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="keywordtype">bool</span> warnings = <span class="keyword">false</span>;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="keywordtype">string</span> tmp;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="comment">// For each sequence in the current protein newAlignment, look for its coding</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="comment">// DNA sequence checking that they have the same size.</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; sequenNumber; i++) {</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        <span class="comment">// Get protein sequence length removing any posible gap. Get as well last</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <span class="comment">// residue from current sequence </span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        tmp = <a class="code" href="classutils.html#a1dce160519187ef2c6e14beb93a2050d">utils::removeCharacter</a>(<span class="charliteral">&#39;-&#39;</span>, sequences[i]);</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        seqLength = tmp.length() * multiple;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        indet = ((int) tmp.length() - <a class="code" href="classutils.html#ab04f5770187b0a8c36c3c8ca55f1e67f">utils::min</a>((<span class="keywordtype">int</span>) tmp.find_last_not_of(<span class="charliteral">&#39;X&#39;</span>), \</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                 (int) tmp.find_last_not_of(<span class="charliteral">&#39;x&#39;</span>))) - 1;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <span class="comment">// Go through all available CDS looking for the one with the same ID</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; totalInputSeqs; j++) {</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;            <span class="comment">// Once both ID matchs, compare its lengths</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;            <span class="keywordflow">if</span> (seqsName[i] == names[j]) {</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                <span class="comment">// If both sequences have the same length, stop the search </span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                <span class="keywordflow">if</span> (seqLength == lengths[j])</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                    <span class="comment">// If nucleotide sequence is larger than protein sequence, warn about</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                    <span class="comment">// it and continue the verification procefile. It will used the &#39;Nth&#39;</span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                    <span class="comment">// first nucleotides for the conversion</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (seqLength &lt; lengths[j]) {</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                    <span class="keywordflow">if</span> (!warnings)</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                        cerr &lt;&lt; endl;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                    warnings = <span class="keyword">true</span>;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                    debug.<a class="code" href="class____internal_report_1_1____report_system.html#acd358cbc59625c6e2f47e0b5f825400d">report</a>(WarningCode::SequenceWillBeCutted, <span class="keyword">new</span> std::string[3]{seqsName[i], std::to_string(seqLength), std::to_string(lengths[j])});</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                }</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                    <span class="comment">// It has been detected some indeterminations at the end of the protein</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                    <span class="comment">// sequence. That ifileue could be cause by some incomplete codons in the</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                    <span class="comment">// nucleotide sequences. This issue is solved adding as much &#39;N&#39; symbols</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                    <span class="comment">// as it is needed to preserve the backtranslated newAlignment</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((indet &gt; 0) &amp;&amp; (indet &gt; (seqLength - lengths[j]) / 3)) {</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                    <span class="keywordflow">if</span> (!warnings)</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                        cerr &lt;&lt; endl;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                    warnings = <span class="keyword">true</span>;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                    debug.<a class="code" href="class____internal_report_1_1____report_system.html#acd358cbc59625c6e2f47e0b5f825400d">report</a>(WarningCode::IncludingIndeterminationSymbols, <span class="keyword">new</span> std::string[1]{seqsName[i]});</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                }</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                    <span class="comment">// If nucleotide sequence is shorter than protein sequence, return an</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                    <span class="comment">// error since it is not feasible to cut the input protein aligment to</span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                    <span class="comment">// fit it into CDNA sequences size</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                <span class="keywordflow">else</span> {</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                    <span class="keywordflow">if</span> (!warnings)</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                        cerr &lt;&lt; endl;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                    warnings = <span class="keyword">true</span>;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                    debug.<a class="code" href="class____internal_report_1_1____report_system.html#acd358cbc59625c6e2f47e0b5f825400d">report</a>(WarningCode::LessNucleotidesThanExpected, <span class="keyword">new</span> std::string[3]{seqsName[i], std::to_string(lengths[j]), std::to_string(seqLength)});</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                }</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            }</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        }</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        <span class="comment">// Warn about a mismatch a sequences name level</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        <span class="keywordflow">if</span> (j == totalInputSeqs) {</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            debug.<a class="code" href="class____internal_report_1_1____report_system.html#acd358cbc59625c6e2f47e0b5f825400d">report</a>(ErrorCode::SequenceNotPresentInCDS, <span class="keyword">new</span> std::string[1]{seqsName[i]});</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        }</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    }</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="comment">// If everything is OK, return an appropiate flag</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;}</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;</div><div class="line"><a name="l00779"></a><span class="lineno"><a class="line" href="classnew_alignment.html#acbeb320f0f70222f81a906ccfc33a016">  779</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classnew_alignment.html#acbeb320f0f70222f81a906ccfc33a016">newAlignment::fillMatrices</a>(<span class="keywordtype">bool</span> aligned) {</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <span class="comment">// Create a timerLevel that will report times upon its destruction</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="comment">//  which means the end of the current scope.</span></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    StartTiming(<span class="stringliteral">&quot;bool newAlignment::fillMatrices(bool aligned) &quot;</span>);</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <span class="comment">// Function to determine if a set of sequences, that can be aligned or not,</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <span class="comment">// have been correctly load and are free of errors.</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="keywordtype">int</span> i, j;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <span class="comment">// Initialize some variables</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="comment">// Check whether there are any unknow/no allowed character in the sequences</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; sequenNumber; i++)</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; sequences[i].length(); j++)</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            <span class="keywordflow">if</span> ((!isalpha(sequences[i][j])) &amp;&amp; (!ispunct(sequences[i][j]))) {</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                debug.<a class="code" href="class____internal_report_1_1____report_system.html#acd358cbc59625c6e2f47e0b5f825400d">report</a>(ErrorCode::UnknownCharacter, <span class="keyword">new</span> std::string[2]{seqsName[i], std::to_string(sequences[i][j])});</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;            }</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="comment">// Check whether all sequences have same size or not</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="keywordflow">for</span> (i = 1; i &lt; sequenNumber; i++) {</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        <span class="keywordflow">if</span> (sequences[i].length() != sequences[i - 1].length())</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    }</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <span class="comment">// Set an appropriate flag for indicating if sequences are aligned or not</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    isAligned = i == sequenNumber;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="comment">// Warm about those cases where sequences should be aligned</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="comment">// and there are not</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="keywordflow">if</span> (aligned and !isAligned) {</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        debug.<a class="code" href="class____internal_report_1_1____report_system.html#acd358cbc59625c6e2f47e0b5f825400d">report</a>(ErrorCode::NotAligned, <span class="keyword">new</span> std::string[1]{filename});</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    }</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <span class="comment">// Full-fill some information about input alignment</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <span class="keywordflow">if</span> (residNumber == 0)</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        residNumber = sequences[0].length();</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="comment">// Check whether aligned sequences have the length fixed for the input alig</span></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <span class="keywordflow">for</span> (i = 0; (i &lt; sequenNumber) and (aligned); i++) {</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        <span class="keywordflow">if</span> (sequences[i].length() != residNumber) {</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;            debug.<a class="code" href="class____internal_report_1_1____report_system.html#acd358cbc59625c6e2f47e0b5f825400d">report</a>(ErrorCode::SequencesNotSameSize,</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                         <span class="keyword">new</span> std::string[3]{seqsName[i], std::to_string(sequences[i].length()), std::to_string(residNumber)});</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        }</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    }</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="comment">// If the sequences are aligned, initialize some additional variables.</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="comment">// These variables will be useful for posterior analysis</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <span class="keywordflow">if</span> ((aligned) || (isAligned)) {</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        <span class="comment">// Assign its position to each column. That will be used to determine which</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        <span class="comment">// columns should be kept in output alignment after applying any method</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        <span class="comment">// and which columns should not</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        saveResidues = <span class="keyword">new</span> <span class="keywordtype">int</span>[residNumber];</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; residNumber; i++)</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            saveResidues[i] = i;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        <span class="comment">// Assign its position to each sequence. Similar to the columns numbering</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        <span class="comment">// possible, assign to each sequence its position is useful to know which</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        <span class="comment">// sequences will be in the output alignment</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        saveSequences = <span class="keyword">new</span> <span class="keywordtype">int</span>[sequenNumber];</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; sequenNumber; i++)</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            saveSequences[i] = i;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    }</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="comment">// Return an flag indicating that everything is fine</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;}</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;</div><div class="line"><a name="l00848"></a><span class="lineno"><a class="line" href="classnew_alignment.html#a3b75055480c60265ea57ca557213fe06">  848</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classnew_alignment.html#a3b75055480c60265ea57ca557213fe06">newAlignment::printAlignmentInfo</a>(ostream &amp;file) {</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <span class="comment">// Create a timerLevel that will report times upon its destruction</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="comment">//  which means the end of the current scope.</span></div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    StartTiming(<span class="stringliteral">&quot;void newAlignment::printAlignmentInfo(ostream &amp;file) &quot;</span>);</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="comment">// Print information about sequences number, average sequence length, maximum</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="comment">// and minimum sequences length, etc</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="keywordtype">int</span> i, j, valid_res, max, min, max_pos, min_pos, total_res;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <span class="comment">// Storage which sequences are the longest and shortest ones</span></div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    max = 0;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    max_pos = 0;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    min_pos = 0;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    min = sequences[0].length();</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="keywordflow">for</span> (i = 0, total_res = 0; i &lt; sequenNumber; i++) {</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        <span class="comment">// Discard gaps from current sequence and then compute real length</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        <span class="keywordflow">for</span> (j = 0, valid_res = 0; j &lt; sequences[i].length(); j++)</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;            valid_res += (sequences[i][j] != <span class="charliteral">&#39;-&#39;</span> ? 1 : 0);</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        <span class="comment">// Compute the total residues in the alignment to calculate avg. sequence</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        <span class="comment">// length</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        total_res += valid_res;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        <span class="comment">// Get values for the longest sequence</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        max_pos = (max &gt; valid_res) ? max_pos : i;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        max = (max &gt; valid_res) ? max : valid_res;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        <span class="comment">// Similarly, get values for the shortest sequence</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        min_pos = (min &lt; valid_res) ? min_pos : i;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        min = (min &lt; valid_res) ? min : valid_res;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    }</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    file &lt;&lt; <span class="stringliteral">&quot;## Total sequences\t&quot;</span> &lt;&lt; sequenNumber &lt;&lt; endl;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <span class="keywordflow">if</span> (isFileAligned())</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        file &lt;&lt; <span class="stringliteral">&quot;## Alignment length\t&quot;</span> &lt;&lt; residNumber &lt;&lt; endl;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    file &lt;&lt; <span class="stringliteral">&quot;## Avg. sequence length\t&quot;</span> &lt;&lt; (float) total_res / sequenNumber &lt;&lt; endl</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;## Longest seq. name\t&#39;&quot;</span> &lt;&lt; seqsName[max_pos] &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span> &lt;&lt; endl</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;## Longest seq. length\t&quot;</span> &lt;&lt; max &lt;&lt; endl</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;## Shortest seq. name\t&#39;&quot;</span> &lt;&lt; seqsName[min_pos] &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span> &lt;&lt; endl</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;## Shortest seq. length\t&quot;</span> &lt;&lt; min &lt;&lt; endl;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;}</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;</div><div class="line"><a name="l00892"></a><span class="lineno"><a class="line" href="classnew_alignment.html#a1180033903a517103612ae59fd024b2f">  892</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classnew_alignment.html#a1180033903a517103612ae59fd024b2f">newAlignment::printSeqIdentity</a>() {</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="comment">// Create a timerLevel that will report times upon its destruction</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="comment">//  which means the end of the current scope.</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    StartTiming(<span class="stringliteral">&quot;void newAlignment::printSeqIdentity(void) &quot;</span>);</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="keywordtype">int</span> i, j, k, pos, maxLongName;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="keywordtype">float</span> mx, avg, maxAvgSeq = 0, maxSeq = 0, avgSeq = 0, **maxs;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <span class="comment">// Ask for the sequence identities assesment</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="keywordflow">if</span> (identities == <span class="keyword">nullptr</span>)</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        Cleaning-&gt;calculateSeqIdentity();</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="comment">// For each sequence, we look for its most similar one</span></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    maxs = <span class="keyword">new</span> <span class="keywordtype">float</span> *[originalSequenNumber];</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; originalSequenNumber; i++) {</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        maxs[i] = <span class="keyword">new</span> <span class="keywordtype">float</span>[2];</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        <span class="comment">// Get the most similar sequence to the current one in term of identity</span></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        <span class="keywordflow">for</span> (k = 0, mx = 0, avg = 0, pos = i; k &lt; originalSequenNumber; k++) {</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;            <span class="keywordflow">if</span> (i != k) {</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                avg += identities[i][k];</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                <span class="keywordflow">if</span> (mx &lt; identities[i][k]) {</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                    mx = identities[i][k];</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                    pos = k;</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                }</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;            }</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        }</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        <span class="comment">// Update global average variables</span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        avgSeq += avg / (originalSequenNumber - 1);</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        maxAvgSeq += mx;</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        <span class="comment">// Save the maximum average identity value for each sequence</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        maxs[i][0] = mx;</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        maxs[i][1] = pos;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    }</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <span class="comment">// Compute general averages </span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    avgSeq = avgSeq / originalSequenNumber;</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    maxAvgSeq = maxAvgSeq / originalSequenNumber;</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="comment">// Compute longest sequences name</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="keywordflow">for</span> (i = 0, maxLongName = 0; i &lt; originalSequenNumber; i++)</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        maxLongName = <a class="code" href="classutils.html#a40640e1942f00797e9fe8284e8fbdb14">utils::max</a>(maxLongName, seqsName[i].size());</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="comment">// Once the method has computed all of different values, it prints it</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    cout.precision(4);</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    cout &lt;&lt; fixed;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <span class="keywordflow">for</span> (i = 0, maxSeq = 0; i &lt; originalSequenNumber; i++)</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        <span class="keywordflow">if</span> (maxs[i][0] &gt; maxSeq)</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;            maxSeq = maxs[i][0];</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;## MaxIdentity\t&quot;</span> &lt;&lt; maxSeq;</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;#&gt; MaxIdentity\tGet the maximum identity value for any pair &quot;</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;of sequences in the alignment&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;## AverageIdentity\t&quot;</span> &lt;&lt; avgSeq;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;#&gt; AverageIdentity\tAverage identity between all sequences&quot;</span>;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    cout &lt;&lt; endl &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;## Identity sequences matrix&quot;</span>;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; sequenNumber; i++) {</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        cout &lt;&lt; endl &lt;&lt; setw(maxLongName + 2) &lt;&lt; left &lt;&lt; seqsName[i] &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; i; j++)</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;            cout &lt;&lt; setiosflags(ios::left) &lt;&lt; setw(10) &lt;&lt; identities[i][j] &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        cout &lt;&lt; setiosflags(ios::left) &lt;&lt; setw(10) &lt;&lt; 1.00 &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        <span class="keywordflow">for</span> (j = i + 1; j &lt; sequenNumber; j++)</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;            cout &lt;&lt; setiosflags(ios::left) &lt;&lt; setw(10) &lt;&lt; identities[i][j] &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    }</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    cout &lt;&lt; endl;</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;## AverageMostSimilarIdentity\t&quot;</span> &lt;&lt; maxAvgSeq;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;#&gt; AverageMostSimilarIdentity\t Average identity between &quot;</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;most similar pair-wise sequences&quot;</span>;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    cout &lt;&lt; endl &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;## Identity for most similar pair-wise sequences &quot;</span></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;matrix&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; sequenNumber; i++)</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        cout &lt;&lt; setw(maxLongName + 2) &lt;&lt; left &lt;&lt; seqsName[i]</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; setiosflags(ios::left) &lt;&lt; setw(5)</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;             &lt;&lt; maxs[i][0] &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; seqsName[(int) maxs[i][1]] &lt;&lt; endl;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    cout &lt;&lt; endl;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; sequenNumber; i++) {</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        <span class="keyword">delete</span> maxs[i];</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    }</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <span class="keyword">delete</span>[] maxs;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;}</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;</div><div class="line"><a name="l00981"></a><span class="lineno"><a class="line" href="classnew_alignment.html#a8fa808afb7d7813adbd5acdd2b0effef">  981</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classnew_alignment.html#a8fa808afb7d7813adbd5acdd2b0effef">newAlignment::printSeqOverlap</a>() {</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <span class="comment">// Create a timerLevel that will report times upon its destruction</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <span class="comment">//  which means the end of the current scope.</span></div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    StartTiming(<span class="stringliteral">&quot;void newAlignment::printSeqOverlap() &quot;</span>);</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <span class="keywordtype">int</span> i, j, k, pos, maxLongName;</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="keywordtype">float</span> mx, avg, maxAvgSeq = 0, maxSeq = 0, avgSeq = 0, **maxs;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="comment">// Ask for the sequence identities assessment</span></div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="keywordflow">if</span> (overlaps == <span class="keyword">nullptr</span>)</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        calculateSeqOverlap();</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <span class="comment">// For each sequence, we look for its most similar one </span></div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    maxs = <span class="keyword">new</span> <span class="keywordtype">float</span> *[sequenNumber];</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; sequenNumber; i++) {</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        maxs[i] = <span class="keyword">new</span> <span class="keywordtype">float</span>[2];</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        <span class="comment">// Get the most similar sequence to the current one in term of overlap</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        <span class="keywordflow">for</span> (k = 0, mx = 0, avg = 0, pos = i; k &lt; sequenNumber; k++) {</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;            <span class="keywordflow">if</span> (i != k) {</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                avg += overlaps[i][k];</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                <span class="keywordflow">if</span> (mx &lt; overlaps[i][k]) {</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                    mx = overlaps[i][k];</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                    pos = k;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                }</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;            }</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        }</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        <span class="comment">// Update global average variables</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        avgSeq += avg / (sequenNumber - 1);</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        maxAvgSeq += mx;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        <span class="comment">// Save the maximum average overlap value for each sequence</span></div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        maxs[i][0] = mx;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;        maxs[i][1] = pos;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    }</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <span class="comment">// Compute general averages</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    avgSeq = avgSeq / sequenNumber;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="comment">//    maxAvgSeq = maxAvgSeq / sequenNumber;</span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    <span class="comment">// Compute longest sequences name </span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <span class="keywordflow">for</span> (i = 0, maxLongName = 0; i &lt; sequenNumber; i++)</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;        maxLongName = <a class="code" href="classutils.html#a40640e1942f00797e9fe8284e8fbdb14">utils::max</a>(maxLongName, seqsName[i].size());</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <span class="comment">// Once the method has computed all of different values, it prints it</span></div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    cout.precision(4);</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    cout &lt;&lt; fixed;</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    <span class="keywordflow">for</span> (i = 0, maxSeq = 0; i &lt; sequenNumber; i++)</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        <span class="keywordflow">if</span> (maxs[i][0] &gt; maxSeq)</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;            maxSeq = maxs[i][0];</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;## MaxOverlap\t&quot;</span> &lt;&lt; maxSeq;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;#&gt; MaxOverlap\tGet the maximum overlap value for any pair &quot;</span></div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;of sequences in the alignment&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;## AverageOverlap\t&quot;</span> &lt;&lt; avgSeq;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;#&gt; AverageOverlap\tAverage overlap between all sequences&quot;</span>;</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    cout &lt;&lt; endl &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;## Overlap sequences matrix&quot;</span>;</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; sequenNumber; i++) {</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        cout &lt;&lt; endl &lt;&lt; setw(maxLongName + 2) &lt;&lt; left &lt;&lt; seqsName[i] &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; sequenNumber; j++)</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;            cout &lt;&lt; setiosflags(ios::left) &lt;&lt; setw(10) &lt;&lt; overlaps[i][j] &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    }</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    cout &lt;&lt; endl;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; sequenNumber; i++) {</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        <span class="keyword">delete</span> maxs[i];</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    }</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    <span class="keyword">delete</span>[] maxs;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;}</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;</div><div class="line"><a name="l01054"></a><span class="lineno"><a class="line" href="classnew_alignment.html#ad916722e4ee892ee9f5cf85f0bdb80aa"> 1054</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classnew_alignment.html#ad916722e4ee892ee9f5cf85f0bdb80aa">newAlignment::calculateColIdentity</a>(<span class="keywordtype">float</span> *ColumnIdentities) {</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    <span class="comment">// Create a timerLevel that will report times upon its destruction</span></div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    <span class="comment">//  which means the end of the current scope.</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    StartTiming(<span class="stringliteral">&quot;void newAlignment::calculateColIdentity(float *ColumnIdentities) &quot;</span>);</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <span class="keywordtype">int</span> i, j, counter, pos, max, columnLen;</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    <span class="keywordtype">char</span> letter, indet, gapSymbol;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <span class="keywordtype">string</span> column;</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    <span class="comment">// Initialize some data for make computation more precise</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    indet = getAlignmentType() == <a class="code" href="defines_8h.html#a69d5409d6e7370d6bd3b4f931702e936adf8e3bb19d1b4de18399b64a58a39590">SequenceTypes::AA</a> ? <span class="charliteral">&#39;X&#39;</span> : <span class="charliteral">&#39;N&#39;</span>;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    gapSymbol = <span class="charliteral">&#39;-&#39;</span>;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="comment">// Compute identity score for the most frequent residue, it can be as well</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    <span class="comment">// gaps and indeterminations, for each column </span></div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <span class="keywordflow">for</span> (i = 0, max = 0; i &lt; residNumber; i++, max = 0, column.clear()) {</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        <span class="comment">// Get residues from each column in capital letters</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; sequenNumber; j++)</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;            <span class="comment">// Discard gaps and indeterminations from calculations</span></div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;            <span class="keywordflow">if</span> ((toupper(sequences[j][i]) != indet) &amp;&amp; (sequences[j][i] != gapSymbol))</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                column += toupper(sequences[j][i]);</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        columnLen = column.size();</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;        <span class="comment">// Count letter frequency. It only matter the frequency. Use some shorcuts</span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;        <span class="comment">// to speed-up the process</span></div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;        <span class="keywordflow">while</span> (!column.empty()) {</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;            letter = column[0];</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;            counter = 0;</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;            pos = 0;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;            <span class="keywordflow">do</span> {</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                counter += 1;</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                column.erase(pos, 1);</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                pos = column.find(letter, pos);</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;            } <span class="keywordflow">while</span> (pos != (<span class="keywordtype">int</span>) string::npos);</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;            <span class="comment">// Keep only the most frequent residue</span></div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;            <span class="keywordflow">if</span> (counter &gt; max)</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                max = counter;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;            <span class="comment">// If column size is smaller than the current max, stop the count</span></div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;            <span class="keywordflow">if</span> ((<span class="keywordtype">int</span>) column.size() &lt; max)</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        }</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;        <span class="comment">// Store column identity values</span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        <span class="keywordflow">if</span> (columnLen != 0)</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;            ColumnIdentities[i] = float(max) / columnLen;</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    }</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;}</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;</div><div class="line"><a name="l01105"></a><span class="lineno"><a class="line" href="classnew_alignment.html#a98c9b5bd9a859600ae8a317d368c85b3"> 1105</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classnew_alignment.html#a98c9b5bd9a859600ae8a317d368c85b3">newAlignment::printColumnsIdentity_DescriptiveStats</a>(<span class="keywordtype">void</span>) {</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="comment">// Create a timerLevel that will report times upon its destruction</span></div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    <span class="comment">//  which means the end of the current scope.</span></div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    StartTiming(<span class="stringliteral">&quot;void newAlignment::printColumnsIdentity_DescriptiveStats(void) &quot;</span>);</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    <span class="keywordtype">float</span> *colIdentities, avg, <a class="code" href="namespacestd.html">std</a>, max, min;</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <span class="keywordtype">int</span> i, positions;</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <span class="comment">// Allocate local memory for the computation</span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    colIdentities = <span class="keyword">new</span> <span class="keywordtype">float</span>[residNumber];</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <a class="code" href="classutils.html#aac322cd1761fddedec8a5792e358eb32">utils::initlVect</a>(colIdentities, residNumber, -1);</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    calculateColIdentity(colIdentities);</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <span class="keywordflow">for</span> (i = 0, max = 0, min = 1, avg = 0, positions = 0; i &lt; residNumber; i++) {</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;        <span class="keywordflow">if</span> (colIdentities[i] != -1) {</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;            <span class="comment">// Compute on-the-fly max and min scores. Store accumulative score</span></div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;            avg += colIdentities[i];</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;            max = (colIdentities[i] &gt; max) ? colIdentities[i] : max;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;            min = (colIdentities[i] &lt; min) ? colIdentities[i] : min;</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;            <span class="comment">// Count how many columns have a value score</span></div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;            positions += 1;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        }</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    }</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    <span class="comment">// Compute average identity column score</span></div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    avg /= positions;</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    <span class="comment">// Compute standard deviation</span></div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <span class="keywordflow">for</span> (i = 0, std = 0; i &lt; residNumber; i++)</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        <span class="keywordflow">if</span> (colIdentities[i] != -1)</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;            std += pow((colIdentities[i] - avg), 2);</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    std = sqrt(std / positions);</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <span class="comment">// Print general descriptive stats</span></div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;#maxColIdentity\t&quot;</span> &lt;&lt; max &lt;&lt; endl;</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;#minColIdentity\t&quot;</span> &lt;&lt; min &lt;&lt; endl;</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;#avgColIdentity\t&quot;</span> &lt;&lt; avg &lt;&lt; endl;</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;#stdColIdentity\t&quot;</span> &lt;&lt; std &lt;&lt; endl;</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;}</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;</div><div class="line"><a name="l01145"></a><span class="lineno"><a class="line" href="classnew_alignment.html#a2607115c839209324dca54d70fc8708d"> 1145</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classnew_alignment.html#a2607115c839209324dca54d70fc8708d">newAlignment::alignmentSummaryHTML</a>(<a class="code" href="classnew_alignment.html">newAlignment</a> &amp;_trimmedAlignment, <span class="keywordtype">char</span> *destFile) {</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    <span class="comment">// Create a timerLevel that will report times upon its destruction</span></div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    <span class="comment">//  which means the end of the current scope.</span></div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    StartTiming(<span class="stringliteral">&quot;bool newAlignment::alignmentSummaryHTML(newAlignment &amp;_trimmedAlignment, char *destFile, float *consValues) &quot;</span>);</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    <span class="comment">// Generate an HTML file with a visual summary about which sequences/columns</span></div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="comment">// have been selected and which have not</span></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    <span class="keywordtype">int</span> i, j, k, kj, upper, minHTML, maxLongName, *gapsValues;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    <span class="keywordtype">string</span> tmpColumn;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    ofstream file;</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="keywordtype">char</span> type;</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <span class="comment">// Allocate some local memory</span></div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    tmpColumn.reserve(originalSequenNumber);</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <span class="comment">// Check whether sequences in the alignment are aligned or not.</span></div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    <span class="comment">// Warn about it if there are not aligned.</span></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    <span class="keywordflow">if</span> (!isAligned) {</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;        debug.<a class="code" href="class____internal_report_1_1____report_system.html#acd358cbc59625c6e2f47e0b5f825400d">report</a>(ErrorCode::NotAligned, <span class="keyword">new</span> std::string[1]{filename});</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    }</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    <span class="comment">// Open output file and check that file pointer is valid </span></div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    file.open(destFile);</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    <span class="keywordflow">if</span> (!file)</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <span class="comment">// Compute maximum sequences name length.</span></div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    maxLongName = 0;</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; originalSequenNumber; i++)</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;        maxLongName = <a class="code" href="classutils.html#a40640e1942f00797e9fe8284e8fbdb14">utils::max</a>(maxLongName, seqsName[i].size());</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="comment">// Compute HTML blank spaces</span></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    minHTML = <a class="code" href="classutils.html#a40640e1942f00797e9fe8284e8fbdb14">utils::max</a>(25, maxLongName + 10);</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="comment">// Recover some stats about different scores from current alignment</span></div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    gapsValues = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <span class="keywordflow">if</span> (_trimmedAlignment.<a class="code" href="classnew_alignment.html#a6324267e64b68bb85d993cf602d008eb">Statistics</a>-&gt;gaps != <span class="keyword">nullptr</span>)</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;        gapsValues = _trimmedAlignment.<a class="code" href="classnew_alignment.html#a6324267e64b68bb85d993cf602d008eb">Statistics</a>-&gt;gaps-&gt;getGapsWindow();</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <span class="keywordtype">float</span> *simValues = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    <span class="keywordflow">if</span> (_trimmedAlignment.<a class="code" href="classnew_alignment.html#a6324267e64b68bb85d993cf602d008eb">Statistics</a>-&gt;conservation != <span class="keyword">nullptr</span>)</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;        simValues = _trimmedAlignment.<a class="code" href="classnew_alignment.html#a6324267e64b68bb85d993cf602d008eb">Statistics</a>-&gt;conservation-&gt;<a class="code" href="classstatistics_conservation.html#a0e674b4b4b91773fb1c32a532797f328">getMdkWindowedVector</a>();</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <span class="keywordtype">float</span> *consValues = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <span class="keywordflow">if</span> (_trimmedAlignment.<a class="code" href="classnew_alignment.html#a6324267e64b68bb85d993cf602d008eb">Statistics</a>-&gt;consistency != <span class="keyword">nullptr</span>)</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;        consValues = _trimmedAlignment.<a class="code" href="classnew_alignment.html#a6324267e64b68bb85d993cf602d008eb">Statistics</a>-&gt;consistency-&gt;getValues();</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="comment">// Print HTML header into output file</span></div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    file &lt;&lt; <span class="stringliteral">&quot;&lt;!DOCTYPE html&gt;&quot;</span> &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;&lt;html&gt;&lt;head&gt;&quot;</span> &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;    &lt;meta &quot;</span></div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;http-equiv=\&quot;Content-Type\&quot; content=\&quot;text/html;charset=ISO-8859-1\&quot; /&gt;&quot;</span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;         &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;    &lt;title&gt;trimAl v1.4 Summary&lt;/title&gt;&quot;</span> &lt;&lt; endl</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;    &lt;style type=\&quot;text/css\&quot; media=\&quot;all\&quot;&gt;&quot;</span> &lt;&lt; endl</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;    #b  { background-color: #3366ff; }\n&quot;</span></div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;    #r  { background-color: #cc0000; }\n&quot;</span></div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;    #g  { background-color: #33cc00; }\n&quot;</span></div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;    #p  { background-color: #ff6666; }\n&quot;</span></div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;    #m  { background-color: #cc33cc; }\n&quot;</span></div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;    #o  { background-color: #ff9900; }\n&quot;</span></div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;    #c  { background-color: #46C7C7; }\n&quot;</span></div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;    #y  { background-color: #FFFF00; }\n&quot;</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;    .sel  { background-color: #B9B9B9; }\n&quot;</span></div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;    .nsel { background-color: #E9E9E9; }\n&quot;</span></div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;         <span class="comment">// Sets of colors for high-lighting scores intervals</span></div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;    .c1   { background-color: #FFFBF2; }\n&quot;</span></div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;    .c2   { background-color: #FFF8CC; }\n&quot;</span></div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;    .c3   { background-color: #FAF0BE; }\n&quot;</span></div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;    .c4   { background-color: #F0EAD6; }\n&quot;</span></div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;    .c5   { background-color: #F3E5AB; }\n&quot;</span></div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;    .c6   { background-color: #F4C430; }\n&quot;</span></div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;    .c7   { background-color: #C2B280; color: white; }\n&quot;</span></div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;    .c8   { background-color: #DAA520; color: white; }\n&quot;</span></div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;    .c9   { background-color: #B8860B; color: white; }\n&quot;</span></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;    .c10  { background-color: #918151; color: white; }\n&quot;</span></div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;    .c11  { background-color: #967117; color: white; }\n&quot;</span></div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;    .c12  { background-color: #6E5411; color: white; }\n&quot;</span></div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;         <span class="comment">// Other HTML elements</span></div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;    &lt;/style&gt;\n  &lt;/head&gt;\n\n&quot;</span> &lt;&lt; <span class="stringliteral">&quot;  &lt;body&gt;\n&quot;</span> &lt;&lt; <span class="stringliteral">&quot;  &lt;pre&gt;&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <span class="comment">// Show information about how many sequences/residues have been selected</span></div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    file &lt;&lt; <span class="stringliteral">&quot;    &lt;span class=sel&gt;Selected Sequences: &quot;</span> &lt;&lt; setw(5) &lt;&lt; right &lt;&lt; _trimmedAlignment.<a class="code" href="classnew_alignment.html#a4a6b47de8bef3e783f30548dfa48d84c">sequenNumber</a></div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; /Selected Residues: &quot;</span> &lt;&lt; setw(7) &lt;&lt; right &lt;&lt; _trimmedAlignment.<a class="code" href="classnew_alignment.html#aff4e7761ec80bea74cdf28c0269b27db">residNumber</a> &lt;&lt; <span class="stringliteral">&quot;&lt;/span&gt;&quot;</span></div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;         &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;    &lt;span class=nsel&gt;Deleted Sequences:  &quot;</span> &lt;&lt; setw(5) &lt;&lt; right</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;         &lt;&lt; sequenNumber - _trimmedAlignment.<a class="code" href="classnew_alignment.html#a4a6b47de8bef3e783f30548dfa48d84c">sequenNumber</a> &lt;&lt; <span class="stringliteral">&quot; /Deleted Residues:  &quot;</span> &lt;&lt; setw(7) &lt;&lt; right</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;         &lt;&lt; residNumber - _trimmedAlignment.<a class="code" href="classnew_alignment.html#aff4e7761ec80bea74cdf28c0269b27db">residNumber</a> &lt;&lt; <span class="stringliteral">&quot;&lt;/span&gt;&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    <span class="comment">// Print headers for different scores derived from input alignment/s </span></div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="keywordflow">if</span> (gapsValues != <span class="keyword">nullptr</span>)</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;        file &lt;&lt; endl &lt;&lt; setw(minHTML) &lt;&lt; left &lt;&lt; <span class="stringliteral">&quot;    Gaps Scores:        &quot;</span></div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c1&gt;  =0=  &lt;/span&gt;&lt;span  class=c2&gt; &lt;.001 &lt;/span&gt;&quot;</span></div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c3&gt; &lt;.050 &lt;/span&gt;&lt;span  class=c4&gt; &lt;.100 &lt;/span&gt;&quot;</span></div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c5&gt; &lt;.150 &lt;/span&gt;&lt;span  class=c6&gt; &lt;.200 &lt;/span&gt;&quot;</span></div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c7&gt; &lt;.250 &lt;/span&gt;&lt;span  class=c8&gt; &lt;.350 &lt;/span&gt;&quot;</span></div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c9&gt; &lt;.500 &lt;/span&gt;&lt;span class=c10&gt; &lt;.750 &lt;/span&gt;&quot;</span></div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;&lt;span class=c11&gt; &lt;1.00 &lt;/span&gt;&lt;span class=c12&gt;  =1=  &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <span class="keywordflow">if</span> (simValues != <span class="keyword">nullptr</span>)</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;        file &lt;&lt; endl &lt;&lt; setw(minHTML) &lt;&lt; left &lt;&lt; <span class="stringliteral">&quot;    Similarity Scores:  &quot;</span></div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c1&gt;  =0=  &lt;/span&gt;&lt;span  class=c2&gt; &lt;1e-6 &lt;/span&gt;&quot;</span></div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c3&gt; &lt;1e-5 &lt;/span&gt;&lt;span  class=c4&gt; &lt;1e-4 &lt;/span&gt;&quot;</span></div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c5&gt; &lt;.001 &lt;/span&gt;&lt;span  class=c6&gt; &lt;.010 &lt;/span&gt;&quot;</span></div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c7&gt; &lt;.100 &lt;/span&gt;&lt;span  class=c8&gt; &lt;.250 &lt;/span&gt;&quot;</span></div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c9&gt; &lt;.500 &lt;/span&gt;&lt;span class=c10&gt; &lt;.750 &lt;/span&gt;&quot;</span></div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;&lt;span class=c11&gt; &lt;1.00 &lt;/span&gt;&lt;span class=c12&gt;  =1=  &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    <span class="keywordflow">if</span> (consValues != <span class="keyword">nullptr</span>)</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        file &lt;&lt; endl &lt;&lt; setw(minHTML) &lt;&lt; left &lt;&lt; <span class="stringliteral">&quot;    Consistency Scores: &quot;</span></div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c1&gt;  =0=  &lt;/span&gt;&lt;span  class=c2&gt; &lt;.001 &lt;/span&gt;&quot;</span></div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c3&gt; &lt;.050 &lt;/span&gt;&lt;span  class=c4&gt; &lt;.100 &lt;/span&gt;&quot;</span></div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c5&gt; &lt;.150 &lt;/span&gt;&lt;span  class=c6&gt; &lt;.200 &lt;/span&gt;&quot;</span></div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c7&gt; &lt;.250 &lt;/span&gt;&lt;span  class=c8&gt; &lt;.350 &lt;/span&gt;&quot;</span></div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c9&gt; &lt;.500 &lt;/span&gt;&lt;span class=c10&gt; &lt;.750 &lt;/span&gt;&quot;</span></div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;&lt;span class=c11&gt; &lt;1.00 &lt;/span&gt;&lt;span class=c12&gt;  =1=  &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    <span class="keywordflow">if</span> ((gapsValues != <span class="keyword">nullptr</span>) or (simValues == <span class="keyword">nullptr</span>) or (consValues == <span class="keyword">nullptr</span>))</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        file &lt;&lt; endl;</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    <span class="comment">// Print Sequences in block of BLOCK_SIZE </span></div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    <span class="keywordflow">for</span> (j = 0, upper = HTMLBLOCKS; j &lt; originalResidNumber; j += HTMLBLOCKS, upper += \</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;            HTMLBLOCKS) {</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;        <span class="comment">// Print main columns number</span></div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        file &lt;&lt; endl &lt;&lt; setw(minHTML + 10) &lt;&lt; right &lt;&lt; (j + 10);</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;        <span class="keywordflow">for</span> (i = j + 20; ((i &lt;= originalResidNumber) &amp;&amp; (i &lt;= upper)); i += 10)</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;            file &lt;&lt; setw(10) &lt;&lt; right &lt;&lt; (i);</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;        <span class="comment">// Print special characters to delimit sequences blocks</span></div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;        file &lt;&lt; endl &lt;&lt; setw(minHTML + 1) &lt;&lt; right;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        <span class="keywordflow">for</span> (i = j + 1; ((i &lt;= originalResidNumber) &amp;&amp; (i &lt;= upper)); i++)</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;            file &lt;&lt; (!(i % 10) ? <span class="stringliteral">&quot;+&quot;</span> : <span class="stringliteral">&quot;=&quot;</span>);</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;        file &lt;&lt; endl;</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;        <span class="comment">// Print sequences name</span></div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; originalSequenNumber; i++) {</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;            file &lt;&lt; <span class="stringliteral">&quot;    &lt;span class=&quot;</span> &lt;&lt; ((_trimmedAlignment.<a class="code" href="classnew_alignment.html#a76d057ddcebc7c88dd7f9e3ff0ce95bf">saveSequences</a>[i] != -1) ? <span class="stringliteral">&quot;sel&gt;&quot;</span> : <span class="stringliteral">&quot;nsel&gt;&quot;</span>) &lt;&lt; seqsName[i]</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;&lt;/span&gt;&quot;</span> &lt;&lt; setw(minHTML - 4 - seqsName[i].size()) &lt;&lt; right &lt;&lt; <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;            <span class="comment">// Print residues corresponding to current sequences block</span></div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;            <span class="keywordflow">for</span> (k = j; ((k &lt; originalResidNumber) &amp;&amp; (k &lt; upper)); k++) {</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                <span class="keywordflow">for</span> (kj = 0, tmpColumn.clear(); kj &lt; originalSequenNumber; kj++)</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                    tmpColumn += sequences[kj][k];</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                <span class="comment">// Determine residue color based on residues across the alig column</span></div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;                type = <a class="code" href="classutils.html#ad1594a7c6cd34bba8e878fe09837e5d8">utils::determineColor</a>(sequences[i][k], tmpColumn);</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;                <span class="keywordflow">if</span> (type == <span class="charliteral">&#39;w&#39;</span>)</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;                    file &lt;&lt; sequences[i][k];</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span id=&quot;</span> &lt;&lt; type &lt;&lt; <span class="stringliteral">&quot;&gt;&quot;</span> &lt;&lt; sequences[i][k] &lt;&lt; <span class="stringliteral">&quot;&lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;            }</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;            file &lt;&lt; endl;</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;        }</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;        file &lt;&lt; endl &lt;&lt; setw(minHTML) &lt;&lt; left &lt;&lt; <span class="stringliteral">&quot;    Selected Cols:      &quot;</span>;</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;        <span class="keywordflow">for</span> (k = j; ((k &lt; originalResidNumber) &amp;&amp; (k &lt; (j + HTMLBLOCKS))); k++)</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;            file &lt;&lt; <span class="stringliteral">&quot;&lt;span class=&quot;</span> &lt;&lt; (_trimmedAlignment.<a class="code" href="classnew_alignment.html#a5239bd4e742631b58efc7f09dd67f165">saveResidues</a>[k] != -1 ? <span class="stringliteral">&quot;sel&quot;</span> : <span class="stringliteral">&quot;nsel&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;        file &lt;&lt; endl;</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;        <span class="comment">// If there is not any score to print, skip this part of the function</span></div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;        <span class="keywordflow">if</span> ((gapsValues == <span class="keyword">nullptr</span>) and (simValues == <span class="keyword">nullptr</span>) and (consValues == <span class="keyword">nullptr</span>))</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;        <span class="comment">// Print score colors according to certain predefined thresholds</span></div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;        <span class="keywordflow">if</span> (gapsValues != <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;            file &lt;&lt; endl &lt;&lt; setw(minHTML) &lt;&lt; left &lt;&lt; <span class="stringliteral">&quot;    Gaps Scores:        &quot;</span>;</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;            <span class="keywordflow">for</span> (k = j; ((k &lt; originalResidNumber) &amp;&amp; (k &lt; (j + HTMLBLOCKS))); k++)</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;                <span class="keywordflow">if</span> (gapsValues[k] == 0)</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span class=c12&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (gapsValues[k] == originalSequenNumber)</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span class=c1&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (1 - (<span class="keywordtype">float</span>(gapsValues[k]) / originalSequenNumber) &gt;= .750)</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span class=c11&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (1 - (<span class="keywordtype">float</span>(gapsValues[k]) / originalSequenNumber) &gt;= .500)</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span class=c10&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (1 - (<span class="keywordtype">float</span>(gapsValues[k]) / originalSequenNumber) &gt;= .350)</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c9&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (1 - (<span class="keywordtype">float</span>(gapsValues[k]) / originalSequenNumber) &gt;= .250)</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c8&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (1 - (<span class="keywordtype">float</span>(gapsValues[k]) / originalSequenNumber) &gt;= .200)</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c7&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (1 - (<span class="keywordtype">float</span>(gapsValues[k]) / originalSequenNumber) &gt;= .150)</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c6&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (1 - (<span class="keywordtype">float</span>(gapsValues[k]) / originalSequenNumber) &gt;= .100)</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c5&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (1 - (<span class="keywordtype">float</span>(gapsValues[k]) / originalSequenNumber) &gt;= .050)</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c4&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (1 - (<span class="keywordtype">float</span>(gapsValues[k]) / originalSequenNumber) &gt;= .001)</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c3&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c2&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;        }</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;        <span class="keywordflow">if</span> (simValues != <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;            file &lt;&lt; endl &lt;&lt; setw(minHTML) &lt;&lt; left &lt;&lt; <span class="stringliteral">&quot;    Similarity Scores:  &quot;</span>;</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;            <span class="keywordflow">for</span> (k = j; ((k &lt; originalResidNumber) &amp;&amp; (k &lt; (j + HTMLBLOCKS))); k++)</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                <span class="keywordflow">if</span> (simValues[k] == 1)</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span class=c12&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (simValues[k] == 0)</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span class=c1&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (simValues[k] &gt;= .750)</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span class=c11&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (simValues[k] &gt;= .500)</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span class=c10&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (simValues[k] &gt;= .250)</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c9&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (simValues[k] &gt;= .100)</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c8&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (simValues[k] &gt;= .010)</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c7&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (simValues[k] &gt;= .001)</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c6&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (simValues[k] &gt;= 1e-4)</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c5&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (simValues[k] &gt;= 1e-5)</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c4&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (simValues[k] &gt;= 1e-6)</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c3&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c2&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;        }</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;        <span class="keywordflow">if</span> (consValues != <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;            file &lt;&lt; endl &lt;&lt; setw(minHTML) &lt;&lt; left &lt;&lt; <span class="stringliteral">&quot;    Consistency Scores: &quot;</span>;</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;            <span class="keywordflow">for</span> (k = j; ((k &lt; originalResidNumber) &amp;&amp; (k &lt; (j + HTMLBLOCKS))); k++)</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                <span class="keywordflow">if</span> (consValues[k] == 1)</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span class=c12&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (consValues[k] == 0)</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span class=c1&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (consValues[k] &gt;= .750)</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span class=c11&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (consValues[k] &gt;= .500)</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span class=c10&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (consValues[k] &gt;= .350)</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c9&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (consValues[k] &gt;= .250)</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c8&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (consValues[k] &gt;= .200)</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c7&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (consValues[k] &gt;= .150)</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c6&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (consValues[k] &gt;= .100)</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c5&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (consValues[k] &gt;= .050)</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c4&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (consValues[k] &gt;= .001)</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c3&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span  class=c2&gt; &lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;        }</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;        file &lt;&lt; endl;</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    }</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    <span class="comment">// Print HTML footer into output file</span></div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    file &lt;&lt; <span class="stringliteral">&quot;    &lt;/pre&gt;&quot;</span> &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;  &lt;/body&gt;&quot;</span> &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;&lt;/html&gt;&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <span class="comment">// Close output file and deallocate local memory</span></div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    file.close();</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;}</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;</div><div class="line"><a name="l01409"></a><span class="lineno"><a class="line" href="classnew_alignment.html#a4c739b8951d20fbe59251041c1131bd3"> 1409</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classnew_alignment.html#a4c739b8951d20fbe59251041c1131bd3">newAlignment::alignmentSummarySVG</a>(<a class="code" href="classnew_alignment.html">newAlignment</a> &amp;_trimmedAlignment, <span class="keywordtype">char</span> *destFile, <span class="keywordtype">int</span> blocks) {</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    <span class="comment">// Create a timerLevel that will report times upon its destruction</span></div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    <span class="comment">//  which means the end of the current scope.</span></div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    StartTiming(<span class="stringliteral">&quot;bool newAlignment::alignmentSummarySVG(newAlignment &amp;_trimmedAlignment, char *destFile, float *consValues, int blocks) &quot;</span>);</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    <span class="keywordtype">int</span> i, j, k, counter = 0;</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    <span class="comment">// BEGIN Init variables</span></div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    <span class="keywordtype">int</span> *gapsValues = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    <span class="keywordflow">if</span> (Statistics-&gt;gaps != <span class="keyword">nullptr</span>)</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;        gapsValues = Statistics-&gt;gaps-&gt;getGapsWindow();</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    <span class="keywordtype">float</span> *simValues = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    <span class="keywordflow">if</span> (Statistics-&gt;conservation != <span class="keyword">nullptr</span>)</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;        simValues = Statistics-&gt;conservation-&gt;getMdkWindowedVector();</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <span class="keywordtype">float</span> *consValues = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    <span class="keywordflow">if</span> (Statistics-&gt;consistency != <span class="keyword">nullptr</span>)</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;        consValues = Statistics-&gt;consistency-&gt;getValues();</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    <span class="comment">// Check if alignment is aligned;</span></div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    <span class="keywordflow">if</span> (!isAligned) {</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;        debug.<a class="code" href="class____internal_report_1_1____report_system.html#acd358cbc59625c6e2f47e0b5f825400d">report</a>(ErrorCode::NotAligned, <span class="keyword">new</span> std::string[1]{filename});</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    }</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    <span class="comment">// Calculate the blockSize;</span></div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    blocks = 120;</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    <span class="keywordtype">int</span> fontSize = 15;</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    <span class="comment">// Allocate some local memory</span></div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    <span class="keywordtype">char</span> *tmpColumn = <span class="keyword">new</span> <span class="keywordtype">char</span>[originalSequenNumber + 1];</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    <span class="comment">// Open the file;</span></div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    ofstream file;</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    file.open(destFile);</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    <span class="keywordflow">if</span> (!file)</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <span class="comment">// Compute HTML blank spaces</span></div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    j = 0;</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; sequenNumber; i++)</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;        j = <a class="code" href="classutils.html#a40640e1942f00797e9fe8284e8fbdb14">utils::max</a>(j, seqsName[i].size());</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    <span class="keywordtype">int</span> sequencesNamesLength = <a class="code" href="classutils.html#a40640e1942f00797e9fe8284e8fbdb14">utils::max</a>(25, j);</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    <span class="comment">// Init Colors</span></div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    std::map&lt;char, string&gt; mappedColors = std::map&lt;char, string&gt; {</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;            {<span class="charliteral">&#39;o&#39;</span>, <span class="stringliteral">&quot;orange&quot;</span>},</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;            {<span class="charliteral">&#39;y&#39;</span>, <span class="stringliteral">&quot;yellow&quot;</span>},</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;            {<span class="charliteral">&#39;b&#39;</span>, <span class="stringliteral">&quot;royalblue&quot;</span>},</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;            {<span class="charliteral">&#39;w&#39;</span>, <span class="stringliteral">&quot;lightgrey&quot;</span>},</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;            {<span class="charliteral">&#39;p&#39;</span>, <span class="stringliteral">&quot;darkviolet&quot;</span>},</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;            {<span class="charliteral">&#39;r&#39;</span>, <span class="stringliteral">&quot;red&quot;</span>},</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;            {<span class="charliteral">&#39;g&#39;</span>, <span class="stringliteral">&quot;lime&quot;</span>},</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;            {<span class="charliteral">&#39;m&#39;</span>, <span class="stringliteral">&quot;magenta&quot;</span>},</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;            {<span class="charliteral">&#39;c&#39;</span>, <span class="stringliteral">&quot;aqua&quot;</span>}</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    };</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    std::map&lt;char, string&gt; mappedColorsMeaning = std::map&lt;char, string&gt; {</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;            {<span class="charliteral">&#39;o&#39;</span>, <span class="stringliteral">&quot;Glycines&quot;</span>},</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;            {<span class="charliteral">&#39;y&#39;</span>, <span class="stringliteral">&quot;Prolines&quot;</span>},</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;            {<span class="charliteral">&#39;b&#39;</span>, <span class="stringliteral">&quot;Hidrophobic&quot;</span>},</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;            {<span class="charliteral">&#39;w&#39;</span>, <span class="stringliteral">&quot;Unconserved&quot;</span>},</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;            {<span class="charliteral">&#39;p&#39;</span>, <span class="stringliteral">&quot;Prolines&quot;</span>},</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;            {<span class="charliteral">&#39;r&#39;</span>, <span class="stringliteral">&quot;Positive Charge&quot;</span>},</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;            {<span class="charliteral">&#39;g&#39;</span>, <span class="stringliteral">&quot;Polar&quot;</span>},</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;            {<span class="charliteral">&#39;m&#39;</span>, <span class="stringliteral">&quot;Negative Charge&quot;</span>},</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;            {<span class="charliteral">&#39;c&#39;</span>, <span class="stringliteral">&quot;Aromatic&quot;</span>}</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    };</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    <span class="comment">// END</span></div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    <span class="comment">// BEGIN Init SVG</span></div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <span class="keywordtype">float</span> leftMargin = 5, nameBlocksMargin = 15,</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;            rightMargin = 5, topMargin = 5,</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;            bottomMargin = 10, interBlocksMargin = 20;</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    <span class="keywordtype">float</span> height = ((originalSequenNumber + 3 + (gapsValues != <span class="keyword">nullptr</span> || simValues != <span class="keyword">nullptr</span> ? 7 : 0) <span class="comment">/* Col numbering occupies 3 rows. Stats 5 */</span>)</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;                    * fontSize + interBlocksMargin)                 <span class="comment">// Height of a block + interblock</span></div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;                   * std::ceil((<span class="keywordtype">float</span>) originalResidNumber / blocks)  <span class="comment">// Number of blocks</span></div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;                   - interBlocksMargin <span class="comment">// Number of interblocks is number of blocks  - 1</span></div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;                   + fontSize * 16</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;                   + topMargin</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;                   + bottomMargin;</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="keywordtype">float</span> width = sequencesNamesLength * fontSize</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;                  + blocks * fontSize * 0.75F</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;                  + leftMargin</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                  + nameBlocksMargin</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;                  + rightMargin;</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    <span class="keywordtype">float</span> currentHeight = topMargin + fontSize;</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    <span class="comment">// Start the svg output</span></div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    file &lt;&lt; <span class="stringliteral">&quot;&lt;svg xmlns=\&quot;http://www.w3.org/2000/svg\&quot; \</span></div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;<span class="stringliteral">            xmlns:xlink=\&quot;http://www.w3.org/1999/xlink\&quot; \</span></div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;<span class="stringliteral">            version=\&quot;1.1\&quot; \</span></div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;<span class="stringliteral">            height=\&quot;&quot;</span> &lt;&lt; height &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;<span class="stringliteral">            width=\&quot;&quot;</span> &lt;&lt; width &lt;&lt; <span class="stringliteral">&quot;px\&quot;&gt;&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    <span class="comment">// END</span></div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    <span class="comment">// BEGIN Functions</span></div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;    file &lt;&lt; <span class="stringliteral">&quot;&lt;script type=\&quot;text/ecmascript\&quot;&gt; \n\</span></div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="stringliteral">                &lt;![CDATA[ \n\</span></div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="stringliteral">                function onMouseOverLabel(evt) { \n\</span></div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="stringliteral">                    var Line = document.childNodes[0].getElementById(evt.target.id.replace(\&quot;Label\&quot;, \&quot;Line\&quot;)); \n\</span></div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;<span class="stringliteral">                    Line.setAttribute(\&quot;style\&quot;, \&quot;fill:none;stroke:black;stroke-width:3\&quot;); \n\</span></div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;<span class="stringliteral">                    evt.target.setAttribute(\&quot;font-size\&quot;, 17); \n\</span></div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;<span class="stringliteral">                } \n\</span></div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;<span class="stringliteral">                function onMouseOutLabel(evt) { \n\</span></div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;<span class="stringliteral">                    var Line = document.childNodes[0].getElementById(evt.target.id.replace(\&quot;Label\&quot;, \&quot;Line\&quot;)); \n\</span></div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;<span class="stringliteral">                    Line.setAttribute(\&quot;style\&quot;, \&quot;fill:none;stroke:black;stroke-width:1\&quot;); \n\</span></div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;<span class="stringliteral">                    evt.target.setAttribute(\&quot;font-size\&quot;, 15); \n\</span></div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;<span class="stringliteral">                } \n\</span></div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;<span class="stringliteral">                function onMouseOverLine(evt) { \n\</span></div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;<span class="stringliteral">                    var Label = document.childNodes[0].getElementById(evt.target.id.replace(\&quot;Line\&quot;, \&quot;Label\&quot;)); \n\</span></div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;<span class="stringliteral">                    evt.target.setAttribute(\&quot;style\&quot;, \&quot;fill:none;stroke:black;stroke-width:3\&quot;); \n\</span></div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;<span class="stringliteral">                    Label.setAttribute(\&quot;font-size\&quot;, 17); \n\</span></div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;<span class="stringliteral">                } \n\</span></div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;<span class="stringliteral">                function onMouseOutLine(evt) { \n\</span></div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;<span class="stringliteral">                    var Label = document.childNodes[0].getElementById(evt.target.id.replace(\&quot;Line\&quot;, \&quot;Label\&quot;)); \n\</span></div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;<span class="stringliteral">                    evt.target.setAttribute(\&quot;style\&quot;, \&quot;fill:none;stroke:black;stroke-width:1\&quot;); \n\</span></div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;<span class="stringliteral">                    Label.setAttribute(\&quot;font-size\&quot;, 15); \n\</span></div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;<span class="stringliteral">                } \n\</span></div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;<span class="stringliteral">                ]]&gt; \n &lt;/script&gt;&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    <span class="comment">// END</span></div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    <span class="comment">// BEGIN Patterns</span></div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    <span class="comment">// Selected Block</span></div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    file &lt;&lt; <span class="stringliteral">&quot;&lt;pattern id=\&quot;selected\&quot; patternUnits=\&quot;userSpaceOnUse\&quot; width=\&quot;10\&quot; height=\&quot;10\&quot;&gt; &quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    file &lt;&lt; <span class="stringliteral">&quot;&lt;rect width=\&quot;10\&quot; height=\&quot;10\&quot; fill=\&quot;green\&quot; opacity=\&quot;0.5\&quot;/&gt;&quot;</span>;</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    file &lt;&lt; <span class="stringliteral">&quot;&lt;path d=\&quot;M-1,1 l2,-2 M0,10 l10,-10 M9,11 l2,-2\&quot; stroke=\&quot;white\&quot; stroke-width=\&quot;1\&quot;/&gt;&quot;</span>;</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    file &lt;&lt; <span class="stringliteral">&quot;&lt;/pattern&gt; &quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    <span class="comment">// Deleted Block</span></div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    file &lt;&lt; <span class="stringliteral">&quot;&lt;pattern id=\&quot;rejected\&quot; patternUnits=\&quot;userSpaceOnUse\&quot; width=\&quot;10\&quot; height=\&quot;10\&quot;&gt; &quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    file &lt;&lt; <span class="stringliteral">&quot;&lt;rect width=\&quot;10\&quot; height=\&quot;10\&quot; fill=\&quot;red\&quot; opacity=\&quot;0.5\&quot;/&gt;&quot;</span>;</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;    file &lt;&lt; <span class="stringliteral">&quot;&lt;path d=\&quot;M2,-2 l-1,1 M10,-10 l0,10 M2,-2 l9,11\&quot; stroke=\&quot;white\&quot; stroke-width=\&quot;1\&quot;/&gt;&quot;</span>;</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;    file &lt;&lt; <span class="stringliteral">&quot;&lt;/pattern&gt; &quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    <span class="comment">// END</span></div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    <span class="comment">// BEGIN Header</span></div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;    strtok(&amp;filename[0], <span class="stringliteral">&quot; &quot;</span>);</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;    std::string fname = strtok(<span class="keyword">nullptr</span>, <span class="stringliteral">&quot; &quot;</span>);</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;    file &lt;&lt; <span class="stringliteral">&quot;&lt;rect \</span></div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;<span class="stringliteral">                style=\&quot;fill:none;stroke:lightgrey\&quot; \</span></div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;<span class="stringliteral">                height=\&quot;&quot;</span> &lt;&lt; fontSize * 6.5F &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;<span class="stringliteral">                width=\&quot;&quot;</span> &lt;&lt; fontSize * std::max(30.5F, fname.length() * 0.75F + 1.F) &lt;&lt; <span class="stringliteral">&quot;px\&quot; \</span></div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;<span class="stringliteral">                x =\&quot;&quot;</span> &lt;&lt; leftMargin + nameBlocksMargin - fontSize * 0.5F &lt;&lt; <span class="stringliteral">&quot;px\&quot;\</span></div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;<span class="stringliteral">                y =\&quot;&quot;</span> &lt;&lt; currentHeight - fontSize * 0.5F &lt;&lt; <span class="stringliteral">&quot;\&quot;/&gt;&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;    file &lt;&lt; <span class="stringliteral">&quot;&lt;text \</span></div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;<span class="stringliteral">                font-family = \&quot;monospace\&quot; \</span></div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;<span class="stringliteral">                font-size=\&quot;&quot;</span> &lt;&lt; fontSize &lt;&lt; <span class="stringliteral">&quot;px\&quot; \</span></div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;<span class="stringliteral">                dy=\&quot;.35em\&quot; \</span></div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;<span class="stringliteral">                x =\&quot;&quot;</span> &lt;&lt; leftMargin + nameBlocksMargin &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<span class="stringliteral">                y=\&quot;&quot;</span> &lt;&lt; (currentHeight + fontSize / 2) &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;<span class="stringliteral">                kerning=\&quot;0\&quot; \</span></div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;<span class="stringliteral">                text-anchor=\&quot;start\&quot; \</span></div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;<span class="stringliteral">                lengthAdjust=\&quot;spacingAndGlyphs\&quot;\</span></div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;<span class="stringliteral">                textLength=\&quot;&quot;</span> &lt;&lt; fname.size() * 0.75F * fontSize &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;<span class="stringliteral">                style=\&quot;font-weight:100\&quot; \</span></div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;<span class="stringliteral">                xml:space=\&quot;preserve\&quot; &gt;&quot;</span></div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;         &lt;&lt; fname</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;&lt;/text&gt;&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    currentHeight += fontSize * 2;</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    fname = <span class="stringliteral">&quot;Selected Sequences \t&quot;</span> + std::to_string(_trimmedAlignment.<a class="code" href="classnew_alignment.html#a4a6b47de8bef3e783f30548dfa48d84c">sequenNumber</a>) + <span class="stringliteral">&quot; / &quot;</span> + std::to_string(originalSequenNumber);</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    file &lt;&lt; <span class="stringliteral">&quot;&lt;text \</span></div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;<span class="stringliteral">                font-family = \&quot;monospace\&quot; \</span></div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;<span class="stringliteral">                font-size=\&quot;&quot;</span> &lt;&lt; fontSize &lt;&lt; <span class="stringliteral">&quot;px\&quot; \</span></div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;<span class="stringliteral">                dy=\&quot;.35em\&quot; \</span></div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;<span class="stringliteral">                x =\&quot;&quot;</span> &lt;&lt; leftMargin + nameBlocksMargin &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;<span class="stringliteral">                y=\&quot;&quot;</span> &lt;&lt; (currentHeight + fontSize / 2) &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;<span class="stringliteral">                kerning=\&quot;0\&quot; \</span></div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;<span class="stringliteral">                text-anchor=\&quot;start\&quot; \</span></div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;<span class="stringliteral">                lengthAdjust=\&quot;spacingAndGlyphs\&quot;\</span></div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;<span class="stringliteral">                textLength=\&quot;&quot;</span> &lt;&lt; std::min((<span class="keywordtype">float</span>) fname.size() * 0.65F, (float) sequencesNamesLength) * fontSize &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;<span class="stringliteral">                style=\&quot;font-weight:100\&quot; \</span></div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;<span class="stringliteral">                xml:space=\&quot;preserve\&quot; &gt;&quot;</span></div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;         &lt;&lt; fname</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;&lt;/text&gt;&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    currentHeight += fontSize * 2;</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    fname = <span class="stringliteral">&quot;Selected Residues \t\t&quot;</span> + std::to_string(_trimmedAlignment.<a class="code" href="classnew_alignment.html#aff4e7761ec80bea74cdf28c0269b27db">residNumber</a>) + <span class="stringliteral">&quot; / &quot;</span> + std::to_string(originalResidNumber);</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    file &lt;&lt; <span class="stringliteral">&quot;&lt;text \</span></div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;<span class="stringliteral">                font-family = \&quot;monospace\&quot; \</span></div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;<span class="stringliteral">                font-size=\&quot;&quot;</span> &lt;&lt; fontSize &lt;&lt; <span class="stringliteral">&quot;px\&quot; \</span></div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;<span class="stringliteral">                dy=\&quot;.35em\&quot; \</span></div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;<span class="stringliteral">                x =\&quot;&quot;</span> &lt;&lt; leftMargin + nameBlocksMargin &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;<span class="stringliteral">                y=\&quot;&quot;</span> &lt;&lt; (currentHeight + fontSize / 2) &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;<span class="stringliteral">                kerning=\&quot;0\&quot; \</span></div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;<span class="stringliteral">                text-anchor=\&quot;start\&quot; \</span></div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;<span class="stringliteral">                lengthAdjust=\&quot;spacingAndGlyphs\&quot;\</span></div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;<span class="stringliteral">                textLength=\&quot;&quot;</span> &lt;&lt; std::min((<span class="keywordtype">float</span>) fname.size() * 0.65F, (float) sequencesNamesLength) * fontSize &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;<span class="stringliteral">                style=\&quot;font-weight:100\&quot; \</span></div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;<span class="stringliteral">                xml:space=\&quot;preserve\&quot; &gt;&quot;</span></div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;         &lt;&lt; fname</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;&lt;/text&gt;&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    currentHeight += fontSize * 3;</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    <span class="comment">// END</span></div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    <span class="comment">// BEGIN Legend</span></div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    file &lt;&lt; <span class="stringliteral">&quot;&lt;rect \</span></div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;<span class="stringliteral">                style=\&quot;fill:none;stroke:lightgrey\&quot; \</span></div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;<span class="stringliteral">                height=\&quot;&quot;</span> &lt;&lt; fontSize * 6.5F &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;<span class="stringliteral">                width=\&quot;&quot;</span> &lt;&lt; fontSize * 30.5 &lt;&lt; <span class="stringliteral">&quot;px\&quot; \</span></div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;<span class="stringliteral">                x =\&quot;&quot;</span> &lt;&lt; leftMargin + nameBlocksMargin - fontSize * 0.5F &lt;&lt; <span class="stringliteral">&quot;px\&quot;\</span></div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;<span class="stringliteral">                y =\&quot;&quot;</span> &lt;&lt; currentHeight - fontSize * 0.5F &lt;&lt; <span class="stringliteral">&quot;\&quot;/&gt;&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    std::map&lt;char, string&gt;::iterator it = mappedColors.begin();</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++) {</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; 3; j++, it++) {</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;            file &lt;&lt; <span class="stringliteral">&quot;&lt;rect \</span></div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;<span class="stringliteral">                    style=\&quot;fill:&quot;</span> &lt;&lt; it-&gt;second &lt;&lt; <span class="stringliteral">&quot;;stroke:black;stroke-width:1px\&quot; \</span></div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;<span class="stringliteral">                    height=\&quot;&quot;</span> &lt;&lt; fontSize &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;<span class="stringliteral">                    width=\&quot;&quot;</span> &lt;&lt; fontSize &lt;&lt; <span class="stringliteral">&quot;px\&quot; \</span></div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;<span class="stringliteral">                    x =\&quot;&quot;</span> &lt;&lt; leftMargin + nameBlocksMargin * (j + 1) + (9 * fontSize * j) &lt;&lt; <span class="stringliteral">&quot;px\&quot;\</span></div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;<span class="stringliteral">                    y =\&quot;&quot;</span> &lt;&lt; currentHeight + fontSize * i * 1.2F &lt;&lt; <span class="stringliteral">&quot;\&quot;/&gt;&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;            file &lt;&lt; <span class="stringliteral">&quot;&lt;text \</span></div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;<span class="stringliteral">                font-family = \&quot;monospace\&quot; \</span></div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;<span class="stringliteral">                font-size=\&quot;&quot;</span> &lt;&lt; fontSize * 0.75F &lt;&lt; <span class="stringliteral">&quot;px\&quot; \</span></div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;<span class="stringliteral">                dy=\&quot;.35em\&quot; \</span></div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;<span class="stringliteral">                x =\&quot;&quot;</span> &lt;&lt; leftMargin + nameBlocksMargin * (j + 3) + (9 * fontSize * j) &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;<span class="stringliteral">                y =\&quot;&quot;</span> &lt;&lt; currentHeight + fontSize * i * 1.2F + fontSize * 0.5F &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;<span class="stringliteral">                kerning=\&quot;0\&quot; \</span></div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;<span class="stringliteral">                text-anchor=\&quot;start\&quot; \</span></div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;<span class="stringliteral">                lengthAdjust=\&quot;spacingAndGlyphs\&quot;\</span></div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;<span class="stringliteral">                textLength=\&quot;&quot;</span> &lt;&lt; mappedColorsMeaning[it-&gt;first].size() * 0.5F * fontSize &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;<span class="stringliteral">                style=\&quot;font-weight:100\&quot; \</span></div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;<span class="stringliteral">                xml:space=\&quot;preserve\&quot; &gt;&quot;</span></div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;                 &lt;&lt; mappedColorsMeaning[it-&gt;first]</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;&lt;/text&gt;&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;        }</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;        currentHeight += fontSize;</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    }</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    currentHeight += fontSize * 4;</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    <span class="comment">// END</span></div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    <span class="comment">// Foreach block</span></div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    <span class="keywordflow">for</span> (j = 0; j &lt; originalResidNumber; j += blocks) {</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;        <span class="comment">// BEGIN Columns Numbering Numbers</span></div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;        file &lt;&lt; <span class="stringliteral">&quot;&lt;text \</span></div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;<span class="stringliteral">                font-family = \&quot;monospace\&quot; \</span></div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;<span class="stringliteral">                font-size=\&quot;&quot;</span> &lt;&lt; fontSize &lt;&lt; <span class="stringliteral">&quot;px\&quot; \</span></div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;<span class="stringliteral">                dy=\&quot;.35em\&quot; \</span></div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;<span class="stringliteral">                x =\&quot;&quot;</span> &lt;&lt; leftMargin + nameBlocksMargin + sequencesNamesLength * fontSize &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;<span class="stringliteral">                y=\&quot;&quot;</span> &lt;&lt; (currentHeight + fontSize / 2) &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;<span class="stringliteral">                kerning=\&quot;0\&quot; \</span></div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;<span class="stringliteral">                text-anchor=\&quot;start\&quot; \</span></div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;<span class="stringliteral">                lengthAdjust=\&quot;spacingAndGlyphs\&quot;\</span></div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;<span class="stringliteral">                textLength=\&quot;&quot;</span> &lt;&lt; std::min((<span class="keywordtype">int</span>) blocks, originalResidNumber - j) * fontSize * 0.75F &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;<span class="stringliteral">                style=\&quot;font-weight:100\&quot; \</span></div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;<span class="stringliteral">                xml:space=\&quot;preserve\&quot; &gt;&quot;</span>;</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;        <span class="keywordflow">for</span> (k = j; k &lt; originalResidNumber &amp;&amp; (k - j) &lt; blocks; k += 10) {</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;            file &lt;&lt; std::left &lt;&lt; std::setw(10) &lt;&lt; std::setfill(<span class="charliteral">&#39; &#39;</span>) &lt;&lt; k;</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;        }</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;        file &lt;&lt; <span class="stringliteral">&quot;&lt;/text&gt;&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;        currentHeight += fontSize;</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;        <span class="comment">// END</span></div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;        <span class="comment">// BEGIN Columns Numbering Symbols</span></div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;        file &lt;&lt; <span class="stringliteral">&quot;&lt;text \</span></div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;<span class="stringliteral">                font-family = \&quot;monospace\&quot; \</span></div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;<span class="stringliteral">                font-size=\&quot;&quot;</span> &lt;&lt; fontSize &lt;&lt; <span class="stringliteral">&quot;px\&quot; \</span></div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;<span class="stringliteral">                dy=\&quot;.35em\&quot; \</span></div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;<span class="stringliteral">                x =\&quot;&quot;</span> &lt;&lt; leftMargin + nameBlocksMargin + sequencesNamesLength * fontSize &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;<span class="stringliteral">                y=\&quot;&quot;</span> &lt;&lt; (currentHeight + fontSize / 2) &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;<span class="stringliteral">                kerning=\&quot;0\&quot; \</span></div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;<span class="stringliteral">                text-anchor=\&quot;start\&quot; \</span></div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;<span class="stringliteral">                lengthAdjust=\&quot;spacingAndGlyphs\&quot;\</span></div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;<span class="stringliteral">                textLength=\&quot;&quot;</span> &lt;&lt; std::min((<span class="keywordtype">int</span>) blocks, originalResidNumber - j) * fontSize * 0.75F &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;<span class="stringliteral">                style=\&quot;font-weight:100\&quot; \</span></div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;<span class="stringliteral">                xml:space=\&quot;preserve\&quot; &gt;&quot;</span>;</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;        <span class="keywordflow">for</span> (k = j; k &lt; originalResidNumber &amp;&amp; (k - j) &lt; blocks; k += 10) {</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;            file &lt;&lt; std::left &lt;&lt; std::setw(10) &lt;&lt; std::setfill(<span class="charliteral">&#39; &#39;</span>) &lt;&lt; <span class="stringliteral">&quot;|&quot;</span>;</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;        }</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;        file &lt;&lt; <span class="stringliteral">&quot;&lt;/text&gt;&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;        file &lt;&lt; <span class="stringliteral">&quot;&lt;line x1=\&quot;&quot;</span> &lt;&lt; leftMargin + nameBlocksMargin + sequencesNamesLength * fontSize</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;\&quot; x2=\&quot;&quot;</span> &lt;&lt; leftMargin + nameBlocksMargin + sequencesNamesLength * fontSize</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;                              + std::min((<span class="keywordtype">int</span>) blocks, originalResidNumber - j) * fontSize * 0.75F</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;\&quot; y1=\&quot;&quot;</span> &lt;&lt; currentHeight + fontSize / 2</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;\&quot; y2=\&quot;&quot;</span> &lt;&lt; currentHeight + fontSize / 2</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;\&quot; style=\&quot;stroke:rgb(0,0,0);stroke-width:2\&quot;/&gt;&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;        currentHeight += fontSize;</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;        currentHeight += fontSize;</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;        <span class="comment">// END</span></div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;        <span class="comment">// BEGIN Color Matrix</span></div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;        <span class="keywordtype">char</span> lastColor, newColor;</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;        <span class="keywordtype">int</span> lastPos = 0;</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; blocks &amp;&amp; (i + j) &lt; originalResidNumber; i++) {</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;            <span class="keywordflow">for</span> (k = 0; k &lt; originalSequenNumber; k++) {</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;                tmpColumn[k] = (sequences[k][i + j]);</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;            }</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;            lastColor = <a class="code" href="classutils.html#ad1594a7c6cd34bba8e878fe09837e5d8">utils::determineColor</a>(tmpColumn[0], tmpColumn);</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;            lastPos = 0;</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;            <span class="keywordflow">for</span> (k = 1; k &lt; originalSequenNumber; k++) {</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;                newColor = <a class="code" href="classutils.html#ad1594a7c6cd34bba8e878fe09837e5d8">utils::determineColor</a>(tmpColumn[k], tmpColumn);</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;                <span class="keywordflow">if</span> (newColor != lastColor) {</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;                    <span class="keywordflow">if</span> (lastColor != <span class="charliteral">&#39;w&#39;</span>)</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;                        file &lt;&lt; <span class="stringliteral">&quot;&lt;rect &quot;</span> &lt;&lt;</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;                             <span class="stringliteral">&quot; style=\&quot;fill:&quot;</span> &lt;&lt; mappedColors[lastColor] &lt;&lt; <span class="stringliteral">&quot;\&quot; &quot;</span> &lt;&lt;</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;                             <span class="stringliteral">&quot; height=\&quot;&quot;</span> &lt;&lt; fontSize * (k - lastPos) &lt;&lt; <span class="stringliteral">&quot;\&quot; &quot;</span> &lt;&lt;</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;                             <span class="stringliteral">&quot; width=\&quot;&quot;</span> &lt;&lt; fontSize * 0.75F &lt;&lt; <span class="stringliteral">&quot;px\&quot; &quot;</span> &lt;&lt;</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;                             <span class="stringliteral">&quot; x =\&quot;&quot;</span> &lt;&lt;</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;                             leftMargin +</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;                             nameBlocksMargin +</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;                             sequencesNamesLength * fontSize +</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;                             i * 0.75F * fontSize</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;                             &lt;&lt; <span class="stringliteral">&quot;\&quot; &quot;</span> &lt;&lt;</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;                             <span class="stringliteral">&quot; y =\&quot;&quot;</span> &lt;&lt; currentHeight + fontSize * lastPos &lt;&lt; <span class="stringliteral">&quot;\&quot; /&gt;&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;                    lastColor = newColor;</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;                    lastPos = k;</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;                }</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;            }</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;            <span class="keywordflow">if</span> (lastColor != <span class="charliteral">&#39;w&#39;</span>)</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;                file &lt;&lt; <span class="stringliteral">&quot;&lt;rect &quot;</span> &lt;&lt;</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;                     <span class="stringliteral">&quot; style=\&quot;fill:&quot;</span> &lt;&lt; mappedColors[lastColor] &lt;&lt; <span class="stringliteral">&quot;\&quot; &quot;</span> &lt;&lt;</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;                     <span class="stringliteral">&quot; height=\&quot;&quot;</span> &lt;&lt; fontSize * (k - lastPos) &lt;&lt; <span class="stringliteral">&quot;\&quot; &quot;</span> &lt;&lt;</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;                     <span class="stringliteral">&quot; width=\&quot;&quot;</span> &lt;&lt; fontSize * 0.75F &lt;&lt; <span class="stringliteral">&quot;px\&quot; &quot;</span> &lt;&lt;</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;                     <span class="stringliteral">&quot; x =\&quot;&quot;</span> &lt;&lt;</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;                     leftMargin + nameBlocksMargin + (sequencesNamesLength) * fontSize + i * 0.75F * fontSize</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;\&quot; &quot;</span> &lt;&lt;</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;                     <span class="stringliteral">&quot; y =\&quot;&quot;</span> &lt;&lt; currentHeight + fontSize * lastPos &lt;&lt; <span class="stringliteral">&quot;\&quot; /&gt;&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;        }</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;        <span class="comment">// END</span></div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;        <span class="comment">// BEGIN Sequences Names and Sequences</span></div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; originalSequenNumber; i++) {</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;            <span class="comment">// Print names</span></div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;            file &lt;&lt; <span class="stringliteral">&quot;&lt;text \</span></div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;<span class="stringliteral">                font-family = \&quot;monospace\&quot; \</span></div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;<span class="stringliteral">                font-size=\&quot;&quot;</span> &lt;&lt; fontSize &lt;&lt; <span class="stringliteral">&quot;px\&quot; \</span></div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;<span class="stringliteral">                dy=\&quot;.35em\&quot; \</span></div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;<span class="stringliteral">                x =\&quot;&quot;</span> &lt;&lt; leftMargin &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;<span class="stringliteral">                y=\&quot;&quot;</span> &lt;&lt; (currentHeight + fontSize / 2) &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;<span class="stringliteral">                kerning=\&quot;0\&quot; \</span></div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;<span class="stringliteral">                text-anchor=\&quot;start\&quot; \</span></div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;<span class="stringliteral">                textLength=\&quot;&quot;</span> &lt;&lt; std::min((<span class="keywordtype">float</span>) seqsName[i].size() * 0.75F, (float) sequencesNamesLength) * fontSize &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;<span class="stringliteral">                style=\&quot;font-weight:100\&quot;&quot;</span> &lt;&lt; <span class="stringliteral">&quot;&gt;&quot;</span></div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;                 &lt;&lt; seqsName[i].substr(0, sequencesNamesLength)</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;&lt;/text&gt;&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;            <span class="comment">// Print sequences</span></div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;            file &lt;&lt; <span class="stringliteral">&quot;&lt;text \</span></div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;<span class="stringliteral">                font-family = \&quot;monospace\&quot; \</span></div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;<span class="stringliteral">                font-size=\&quot;&quot;</span> &lt;&lt; fontSize &lt;&lt; <span class="stringliteral">&quot;px\&quot; \</span></div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;<span class="stringliteral">                dy=\&quot;.35em\&quot; \</span></div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;<span class="stringliteral">                x =\&quot;&quot;</span> &lt;&lt; leftMargin + nameBlocksMargin + sequencesNamesLength * fontSize &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;<span class="stringliteral">                y=\&quot;&quot;</span> &lt;&lt; (currentHeight + fontSize / 2) &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;<span class="stringliteral">                kerning=\&quot;0\&quot; \</span></div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;<span class="stringliteral">                text-anchor=\&quot;start\&quot; \</span></div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;<span class="stringliteral">                lengthAdjust=\&quot;spacingAndGlyphs\&quot; \</span></div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;<span class="stringliteral">                textLength=\&quot;&quot;</span> &lt;&lt; std::min((<span class="keywordtype">int</span>) blocks, originalResidNumber - j) * fontSize * 0.75F &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;<span class="stringliteral">                style=\&quot;font-weight:100\&quot;&quot;</span> &lt;&lt; <span class="stringliteral">&quot;&gt;&quot;</span></div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;                 &lt;&lt; sequences[i].substr(j, blocks)</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;&lt;/text&gt;&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;            <span class="keywordflow">if</span> (_trimmedAlignment.<a class="code" href="classnew_alignment.html#a76d057ddcebc7c88dd7f9e3ff0ce95bf">saveSequences</a>[i] == -1) {</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;                file &lt;&lt; <span class="stringliteral">&quot;&lt;line x1=\&quot;&quot;</span> &lt;&lt; leftMargin + nameBlocksMargin + sequencesNamesLength * fontSize &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span> &lt;&lt;</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;                     <span class="stringliteral">&quot; x2=\&quot;&quot;</span> &lt;&lt; leftMargin + nameBlocksMargin + sequencesNamesLength * fontSize + std::min(blocks, originalResidNumber - j) * fontSize * 0.75F &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span> &lt;&lt;</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;                     <span class="stringliteral">&quot; y1=\&quot;&quot;</span> &lt;&lt; (currentHeight + fontSize / 2) &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span> &lt;&lt;</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;                     <span class="stringliteral">&quot; y2=\&quot;&quot;</span> &lt;&lt; (currentHeight + fontSize / 2) &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span> &lt;&lt;</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;                     <span class="stringliteral">&quot; style=\&quot;stroke:rgb(0,0,0);stroke-width:2\&quot;&quot;</span></div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;                             <span class="stringliteral">&quot;/&gt;&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;                file &lt;&lt; <span class="stringliteral">&quot;&lt;line x1=\&quot;&quot;</span> &lt;&lt; leftMargin &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span> &lt;&lt;</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;                     <span class="stringliteral">&quot; x2=\&quot;&quot;</span> &lt;&lt; leftMargin + std::min((<span class="keywordtype">float</span>) seqsName[i].size() * 0.75F, (<span class="keywordtype">float</span>) sequencesNamesLength) * fontSize &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span> &lt;&lt;</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;                     <span class="stringliteral">&quot; y1=\&quot;&quot;</span> &lt;&lt; (currentHeight + fontSize / 2) &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span> &lt;&lt;</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;                     <span class="stringliteral">&quot; y2=\&quot;&quot;</span> &lt;&lt; (currentHeight + fontSize / 2) &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span> &lt;&lt;</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;                     <span class="stringliteral">&quot; style=\&quot;stroke:rgb(0,0,0);stroke-width:2\&quot;&quot;</span></div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;                             <span class="stringliteral">&quot;/&gt;&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;            }</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;            currentHeight += fontSize;</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;        }</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;        <span class="comment">// END</span></div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;        <span class="comment">// BEGIN Selected / Rejected Boxes</span></div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;        currentHeight += fontSize;</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;        <span class="comment">// Big white box</span></div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;        file &lt;&lt; <span class="stringliteral">&quot;&lt;rect &quot;</span> &lt;&lt;</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;             <span class="stringliteral">&quot; style=\&quot;fill:none;stroke:black\&quot;&quot;</span> &lt;&lt;</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;             <span class="stringliteral">&quot; height=\&quot;&quot;</span> &lt;&lt; fontSize * 5 &lt;&lt; <span class="stringliteral">&quot;\&quot; &quot;</span> &lt;&lt;</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;             <span class="stringliteral">&quot; width=\&quot;&quot;</span> &lt;&lt; fontSize * 0.75F * std::min(blocks, originalResidNumber - j) &lt;&lt; <span class="stringliteral">&quot;px\&quot; &quot;</span> &lt;&lt;</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;             <span class="stringliteral">&quot; x =\&quot;&quot;</span> &lt;&lt;</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;             leftMargin + nameBlocksMargin + (sequencesNamesLength) * fontSize</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;\&quot; &quot;</span> &lt;&lt;</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;             <span class="stringliteral">&quot; y =\&quot;&quot;</span> &lt;&lt; currentHeight &lt;&lt; <span class="stringliteral">&quot;\&quot; /&gt;&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;        <span class="keywordtype">bool</span> rejected = _trimmedAlignment.<a class="code" href="classnew_alignment.html#a5239bd4e742631b58efc7f09dd67f165">saveResidues</a>[j] == -1;</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;        lastPos = j;</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;        <span class="keywordflow">for</span> (k = j + 1; k &lt; originalResidNumber &amp;&amp; (k - j) &lt; blocks; k++) {</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;            <span class="keywordflow">if</span> ((_trimmedAlignment.<a class="code" href="classnew_alignment.html#a5239bd4e742631b58efc7f09dd67f165">saveResidues</a>[k] == -1) != rejected) {</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;                file &lt;&lt; <span class="stringliteral">&quot;&lt;rect &quot;</span> &lt;&lt;</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;                     <span class="stringliteral">&quot; style=\&quot;fill:url(#&quot;</span> &lt;&lt; (rejected ? <span class="stringliteral">&quot;rejected&quot;</span> : <span class="stringliteral">&quot;selected&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;);stroke:black\&quot;&quot;</span> &lt;&lt;</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;                     <span class="stringliteral">&quot; height=\&quot;&quot;</span> &lt;&lt; fontSize * 5 &lt;&lt; <span class="stringliteral">&quot;\&quot; &quot;</span> &lt;&lt;</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;                     <span class="stringliteral">&quot; width=\&quot;&quot;</span> &lt;&lt; fontSize * 0.75F * (k - lastPos) &lt;&lt; <span class="stringliteral">&quot;px\&quot; &quot;</span> &lt;&lt;</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;                     <span class="stringliteral">&quot; opacity=\&quot;0.5\&quot;&quot;</span> &lt;&lt;</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;                     <span class="stringliteral">&quot; x =\&quot;&quot;</span> &lt;&lt;</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;                     leftMargin + nameBlocksMargin + sequencesNamesLength * fontSize + fontSize * 0.75F * (lastPos - j)</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;\&quot; &quot;</span> &lt;&lt;</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;                     <span class="stringliteral">&quot; y =\&quot;&quot;</span> &lt;&lt; currentHeight &lt;&lt; <span class="stringliteral">&quot;\&quot; /&gt;&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;                rejected = !rejected;</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;                lastPos = k;</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;            }</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;        }</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;        file &lt;&lt; <span class="stringliteral">&quot;&lt;rect &quot;</span> &lt;&lt;</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;             <span class="stringliteral">&quot; style=\&quot;fill:url(#&quot;</span> &lt;&lt; (rejected ? <span class="stringliteral">&quot;rejected&quot;</span> : <span class="stringliteral">&quot;selected&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;);stroke:black\&quot;&quot;</span> &lt;&lt;</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;             <span class="stringliteral">&quot; height=\&quot;&quot;</span> &lt;&lt; fontSize * 5 &lt;&lt; <span class="stringliteral">&quot;\&quot; &quot;</span> &lt;&lt;</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;             <span class="stringliteral">&quot; width=\&quot;&quot;</span> &lt;&lt; fontSize * 0.75F * (k - lastPos) &lt;&lt; <span class="stringliteral">&quot;px\&quot; &quot;</span> &lt;&lt;</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;             <span class="stringliteral">&quot; opacity=\&quot;0.5\&quot;&quot;</span></div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;                     <span class="stringliteral">&quot; x =\&quot;&quot;</span> &lt;&lt;</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;             leftMargin + nameBlocksMargin + sequencesNamesLength * fontSize + fontSize * 0.75F * (lastPos - j)</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;\&quot; &quot;</span> &lt;&lt;</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;             <span class="stringliteral">&quot; y =\&quot;&quot;</span> &lt;&lt; currentHeight &lt;&lt; <span class="stringliteral">&quot;\&quot; /&gt;&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;        <span class="comment">// END</span></div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;        <span class="comment">// BEGIN Stats report</span></div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;        <span class="keywordflow">if</span> (gapsValues || simValues || consValues) {</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;            file &lt;&lt; <span class="stringliteral">&quot;&lt;text \</span></div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;<span class="stringliteral">                        font-family = \&quot;monospace\&quot; \</span></div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;<span class="stringliteral">                        font-size=\&quot;&quot;</span> &lt;&lt; fontSize &lt;&lt; <span class="stringliteral">&quot;px\&quot; \</span></div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;<span class="stringliteral">                        dy=\&quot;.35em\&quot; \</span></div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;<span class="stringliteral">                        x =\&quot;&quot;</span> &lt;&lt; leftMargin + (sequencesNamesLength) * fontSize &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;<span class="stringliteral">                        y=\&quot;&quot;</span> &lt;&lt; currentHeight &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;<span class="stringliteral">                        kerning=\&quot;0\&quot; \</span></div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;<span class="stringliteral">                        text-anchor=\&quot;end\&quot; \</span></div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;<span class="stringliteral">                        lengthAdjust=\&quot;spacingAndGlyphs\&quot;\</span></div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;<span class="stringliteral">                        style=\&quot;font-weight:100\&quot; \</span></div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;<span class="stringliteral">                        xml:space=\&quot;preserve\&quot; &gt;&quot;</span></div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;1&quot;</span></div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;&lt;/text&gt;&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;            file &lt;&lt; <span class="stringliteral">&quot;&lt;text \</span></div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;<span class="stringliteral">                        font-family = \&quot;monospace\&quot; \</span></div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;<span class="stringliteral">                        font-size=\&quot;&quot;</span> &lt;&lt; fontSize &lt;&lt; <span class="stringliteral">&quot;px\&quot; \</span></div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;<span class="stringliteral">                        dy=\&quot;.35em\&quot; \</span></div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;<span class="stringliteral">                        x =\&quot;&quot;</span> &lt;&lt; leftMargin + (sequencesNamesLength) * fontSize &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;<span class="stringliteral">                        y=\&quot;&quot;</span> &lt;&lt; currentHeight + fontSize * 5 &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;<span class="stringliteral">                        kerning=\&quot;0\&quot; \</span></div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;<span class="stringliteral">                        text-anchor=\&quot;end\&quot; \</span></div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;<span class="stringliteral">                        lengthAdjust=\&quot;spacingAndGlyphs\&quot;\</span></div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;<span class="stringliteral">                        style=\&quot;font-weight:100\&quot; \</span></div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;<span class="stringliteral">                        xml:space=\&quot;preserve\&quot; &gt;&quot;</span></div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;0&quot;</span></div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;&lt;/text&gt;&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;        }</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;        <span class="keywordflow">if</span> (gapsValues) {</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;            file &lt;&lt; <span class="stringliteral">&quot;&lt;polyline \</span></div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;<span class="stringliteral">                        style=\&quot;fill:none;stroke:black;stroke-width:1\&quot; \</span></div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;<span class="stringliteral">                        stroke-dasharray=\&quot;10,4\&quot; \</span></div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;<span class="stringliteral">                        id =\&quot;GapsLine&quot;</span> &lt;&lt; counter &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;<span class="stringliteral">                        onmouseover=\&quot;onMouseOverLine(evt)\&quot; \</span></div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;<span class="stringliteral">                        onmouseout=\&quot;onMouseOutLine(evt)\&quot; \</span></div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;<span class="stringliteral">                        points=\&quot;&quot;</span>;</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;            <span class="keywordflow">for</span> (i = 0; i &lt; blocks &amp;&amp; (i + j) &lt; originalResidNumber; i++) {</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;                file &lt;&lt; leftMargin + nameBlocksMargin + (sequencesNamesLength) * fontSize + (i + 0.5F) * 0.75F * fontSize &lt;&lt; <span class="stringliteral">&quot;,&quot;</span></div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;                     &lt;&lt; currentHeight + 10 + (1.F - (gapsValues[i + j] / (float) originalSequenNumber)) * fontSize * 4 &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;            }</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;            file &lt;&lt; <span class="stringliteral">&quot;\&quot;/&gt;&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;            file &lt;&lt; <span class="stringliteral">&quot;&lt;text \</span></div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;<span class="stringliteral">                        font-family = \&quot;monospace\&quot; \</span></div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;<span class="stringliteral">                        font-size=\&quot;&quot;</span> &lt;&lt; fontSize &lt;&lt; <span class="stringliteral">&quot;px\&quot; \</span></div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;<span class="stringliteral">                        dy=\&quot;.35em\&quot; \</span></div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;<span class="stringliteral">                        x =\&quot;&quot;</span> &lt;&lt; leftMargin &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;<span class="stringliteral">                        y=\&quot;&quot;</span> &lt;&lt; (currentHeight + fontSize / 2) &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;<span class="stringliteral">                        kerning=\&quot;0\&quot; \</span></div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;<span class="stringliteral">                        text-anchor=\&quot;start\&quot; \</span></div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;<span class="stringliteral">                        id =\&quot;GapsLabel&quot;</span> &lt;&lt; counter &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;<span class="stringliteral">                        onmouseover=\&quot;onMouseOverLabel(evt)\&quot; \</span></div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;<span class="stringliteral">                        onmouseout=\&quot;onMouseOutLabel(evt)\&quot; \</span></div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;<span class="stringliteral">                        textLength=\&quot;&quot;</span> &lt;&lt; std::min(11 * 0.75F, (<span class="keywordtype">float</span>) sequencesNamesLength) * fontSize &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;<span class="stringliteral">                        style=\&quot;font-weight:bold\&quot;&quot;</span> &lt;&lt; <span class="stringliteral">&quot;&gt;&quot;</span></div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;Gaps Values&quot;</span></div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;&lt;/text&gt;&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;            file &lt;&lt; <span class="stringliteral">&quot;&lt;line x1=\&quot;&quot;</span> &lt;&lt; leftMargin</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;\&quot; x2=\&quot;&quot;</span> &lt;&lt; leftMargin + std::min(11 * 0.75F, (<span class="keywordtype">float</span>) sequencesNamesLength) * fontSize</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;\&quot; y1=\&quot;&quot;</span> &lt;&lt; currentHeight + fontSize * 1.25F</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;\&quot; y2=\&quot;&quot;</span> &lt;&lt; currentHeight + fontSize * 1.25F</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;\&quot; style=\&quot;stroke:rgb(0,0,0);stroke-width:1\&quot;&quot;</span></div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; stroke-dasharray=\&quot;10,4\&quot;&quot;</span></div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; id =\&quot;GapsSubLine&quot;</span> &lt;&lt; counter &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span></div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;/&gt;&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;        }</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;        <span class="keywordflow">if</span> (simValues) {</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;            file &lt;&lt; <span class="stringliteral">&quot;&lt;polyline \</span></div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;<span class="stringliteral">                style=\&quot;fill:none;stroke:black;stroke-width:1\&quot; \</span></div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;<span class="stringliteral">                stroke-dasharray=\&quot;5,1\&quot; \</span></div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;<span class="stringliteral">                id =\&quot;SimLine&quot;</span> &lt;&lt; counter &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;<span class="stringliteral">                onmouseover=\&quot;onMouseOverLine(evt)\&quot; \</span></div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;<span class="stringliteral">                onmouseout=\&quot;onMouseOutLine(evt)\&quot; \</span></div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;<span class="stringliteral">                points=\&quot;&quot;</span>;</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;            <span class="keywordflow">for</span> (i = 0; i &lt; blocks &amp;&amp; (i + j) &lt; originalResidNumber; i++) {</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;                file &lt;&lt; leftMargin + nameBlocksMargin + (sequencesNamesLength) * fontSize + (i + 0.5F) * 0.75F * fontSize &lt;&lt; <span class="stringliteral">&quot;,&quot;</span></div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;                     &lt;&lt; currentHeight + 10 + ((1.F - simValues[i + j]) * fontSize * 4) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;            }</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;            file &lt;&lt; <span class="stringliteral">&quot;\&quot;/&gt;&quot;</span>;</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;            file &lt;&lt; <span class="stringliteral">&quot;&lt;text \</span></div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;<span class="stringliteral">                        font-family = \&quot;monospace\&quot; \</span></div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;<span class="stringliteral">                        font-size=\&quot;&quot;</span> &lt;&lt; fontSize &lt;&lt; <span class="stringliteral">&quot;px\&quot; \</span></div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;<span class="stringliteral">                        dy=\&quot;.35em\&quot; \</span></div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;<span class="stringliteral">                        x =\&quot;&quot;</span> &lt;&lt; leftMargin &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;<span class="stringliteral">                        y=\&quot;&quot;</span> &lt;&lt; (currentHeight + 2.5F * fontSize) &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;<span class="stringliteral">                        kerning=\&quot;0\&quot; \</span></div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;<span class="stringliteral">                        text-anchor=\&quot;start\&quot; \</span></div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;<span class="stringliteral">                        id =\&quot;SimLabel&quot;</span> &lt;&lt; counter &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;<span class="stringliteral">                        onmouseover=\&quot;onMouseOverLabel(evt)\&quot; \</span></div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;<span class="stringliteral">                        onmouseout=\&quot;onMouseOutLabel(evt)\&quot; \</span></div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;<span class="stringliteral">                        textLength=\&quot;&quot;</span> &lt;&lt; std::min(10 * 0.75F, (<span class="keywordtype">float</span>) sequencesNamesLength) * fontSize &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;<span class="stringliteral">                        style=\&quot;font-weight:bold\&quot;&quot;</span> &lt;&lt; <span class="stringliteral">&quot;&gt;&quot;</span></div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;Sim Values&quot;</span></div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;&lt;/text&gt;&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;            file &lt;&lt; <span class="stringliteral">&quot;&lt;line x1=\&quot;&quot;</span> &lt;&lt; leftMargin</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;\&quot; x2=\&quot;&quot;</span> &lt;&lt; leftMargin + std::min(10 * 0.75F, (<span class="keywordtype">float</span>) sequencesNamesLength) * fontSize</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;\&quot; y1=\&quot;&quot;</span> &lt;&lt; currentHeight + fontSize * 3.25F</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;\&quot; y2=\&quot;&quot;</span> &lt;&lt; currentHeight + fontSize * 3.25F</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;\&quot; style=\&quot;stroke:rgb(0,0,0);stroke-width:1\&quot;&quot;</span></div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; stroke-dasharray=\&quot;5,1\&quot;&quot;</span></div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; id =\&quot;SimSubLine&quot;</span> &lt;&lt; counter &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span></div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;/&gt;&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;        }</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;        <span class="keywordflow">if</span> (consValues) {</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;            file &lt;&lt; <span class="stringliteral">&quot;&lt;polyline \</span></div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;<span class="stringliteral">                style=\&quot;fill:none;stroke:black;stroke-width:1\&quot; \</span></div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;<span class="stringliteral">                stroke-dasharray=\&quot;2,2\&quot; \</span></div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;<span class="stringliteral">                id =\&quot;ConsLine&quot;</span> &lt;&lt; counter &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;<span class="stringliteral">                onmouseover=\&quot;onMouseOverLine(evt)\&quot; \</span></div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;<span class="stringliteral">                onmouseout=\&quot;onMouseOutLine(evt)\&quot; \</span></div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;<span class="stringliteral">                points=\&quot;&quot;</span>;</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;            <span class="keywordflow">for</span> (i = 0; i &lt; blocks &amp;&amp; (i + j) &lt; originalResidNumber; i++) {</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;                file &lt;&lt; leftMargin + nameBlocksMargin + (sequencesNamesLength) * fontSize + (i + 0.5F) * 0.75F * fontSize &lt;&lt; <span class="stringliteral">&quot;,&quot;</span></div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;                     &lt;&lt; currentHeight + 10 + ((1.F - consValues[i + j]) * fontSize * 4) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;            }</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;            file &lt;&lt; <span class="stringliteral">&quot;\&quot;/&gt;&quot;</span>;</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;            file &lt;&lt; <span class="stringliteral">&quot;&lt;text \</span></div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;<span class="stringliteral">                        font-family = \&quot;monospace\&quot; \</span></div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;<span class="stringliteral">                        font-size=\&quot;&quot;</span> &lt;&lt; fontSize &lt;&lt; <span class="stringliteral">&quot;px\&quot; \</span></div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;<span class="stringliteral">                        dy=\&quot;.35em\&quot; \</span></div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;<span class="stringliteral">                        x =\&quot;&quot;</span> &lt;&lt; leftMargin &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;<span class="stringliteral">                        y=\&quot;&quot;</span> &lt;&lt; (currentHeight + 4.5F * fontSize) &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;<span class="stringliteral">                        kerning=\&quot;0\&quot; \</span></div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;<span class="stringliteral">                        text-anchor=\&quot;start\&quot; \</span></div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;<span class="stringliteral">                        id =\&quot;ConsLabel&quot;</span> &lt;&lt; counter &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;<span class="stringliteral">                        onmouseover=\&quot;onMouseOverLabel(evt)\&quot; \</span></div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;<span class="stringliteral">                        onmouseout=\&quot;onMouseOutLabel(evt)\&quot; \</span></div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;<span class="stringliteral">                        textLength=\&quot;&quot;</span> &lt;&lt; std::min(10 * 0.75F, (<span class="keywordtype">float</span>) sequencesNamesLength) * fontSize &lt;&lt; <span class="stringliteral">&quot;\&quot; \</span></div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;<span class="stringliteral">                        style=\&quot;font-weight:bold\&quot;&quot;</span> &lt;&lt; <span class="stringliteral">&quot;&gt;&quot;</span></div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;Cons Values&quot;</span></div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;&lt;/text&gt;&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;            file &lt;&lt; <span class="stringliteral">&quot;&lt;line x1=\&quot;&quot;</span> &lt;&lt; leftMargin</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;\&quot; x2=\&quot;&quot;</span> &lt;&lt; leftMargin + std::min(10 * 0.75F, (<span class="keywordtype">float</span>) sequencesNamesLength) * fontSize</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;\&quot; y1=\&quot;&quot;</span> &lt;&lt; currentHeight + fontSize * 5.25F</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;\&quot; y2=\&quot;&quot;</span> &lt;&lt; currentHeight + fontSize * 5.25F</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;\&quot; style=\&quot;stroke:rgb(0,0,0);stroke-width:1\&quot;&quot;</span></div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; stroke-dasharray=\&quot;2,2\&quot;&quot;</span></div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; id =\&quot;ConsSubLine&quot;</span> &lt;&lt; counter &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span></div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;/&gt;&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;        }</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;        counter++;</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;        currentHeight += 6 * fontSize;</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;        <span class="comment">// END</span></div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;        currentHeight += interBlocksMargin;</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;    }</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;    file &lt;&lt; <span class="stringliteral">&quot;&lt;/svg&gt;&quot;</span>;</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;    <span class="keyword">delete</span>[] tmpColumn;</div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;}</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;</div><div class="line"><a name="l02044"></a><span class="lineno"><a class="line" href="classnew_alignment.html#a26d10a23f8f71f95657a05e88a9a8fff"> 2044</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classnew_alignment.html#a26d10a23f8f71f95657a05e88a9a8fff">newAlignment::alignmentColourHTML</a>(ostream &amp;file) {</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;    <span class="comment">// Create a timerLevel that will report times upon its destruction</span></div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;    <span class="comment">//  which means the end of the current scope.</span></div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;    StartTiming(<span class="stringliteral">&quot;bool newAlignment::alignmentColourHTML(ostream &amp;file) &quot;</span>);</div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;</div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    <span class="keywordtype">int</span> i, j, kj, upper, k = 0, maxLongName = 0;</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;    <span class="keywordtype">string</span> tmpColumn;</div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;    <span class="keywordtype">char</span> type;</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;</div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;    <span class="comment">// Allocate some local memory</span></div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;    tmpColumn.reserve(sequenNumber);</div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;</div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;    <span class="comment">// Check whether sequences in the alignment are aligned or not.</span></div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;    <span class="comment">// Warn about it if there are not aligned. </span></div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;    <span class="keywordflow">if</span> (!isAligned) {</div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;        debug.<a class="code" href="class____internal_report_1_1____report_system.html#acd358cbc59625c6e2f47e0b5f825400d">report</a>(ErrorCode::NotAligned, <span class="keyword">new</span> std::string[1]{filename});</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;    }</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;    <span class="comment">// Compute maximum sequences name length</span></div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;    maxLongName = 0;</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; sequenNumber; i++)</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;        maxLongName = <a class="code" href="classutils.html#a40640e1942f00797e9fe8284e8fbdb14">utils::max</a>(maxLongName, seqsName[i].size());</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;</div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;    <span class="comment">// Print HTML header into output file</span></div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;    file &lt;&lt; <span class="stringliteral">&quot;&lt;!DOCTYPE html&gt;&quot;</span> &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;&lt;html&gt;&lt;head&gt;&quot;</span> &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;    &lt;meta &quot;</span></div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;http-equiv=\&quot;Content-Type\&quot; content=\&quot;text/html;charset=ISO-8859-1\&quot; /&gt;&quot;</span></div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;         &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;    &lt;title&gt;readAl v1.4&lt;/title&gt;&quot;</span> &lt;&lt; endl</div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;    &lt;style type=\&quot;text/cfile\&quot;&gt;&quot;</span> &lt;&lt; endl</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;    #b  { background-color: #3366ff; }\n&quot;</span></div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;    #r  { background-color: #cc0000; }\n&quot;</span></div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;    #g  { background-color: #33cc00; }\n&quot;</span></div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;    #p  { background-color: #ff6666; }\n&quot;</span></div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;    #m  { background-color: #cc33cc; }\n&quot;</span></div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;    #o  { background-color: #ff9900; }\n&quot;</span></div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;    #c  { background-color: #46C7C7; }\n&quot;</span></div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;    #y  { background-color: #FFFF00; }\n&quot;</span></div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;    &lt;/style&gt;\n  &lt;/head&gt;\n\n&quot;</span> &lt;&lt; <span class="stringliteral">&quot;  &lt;body&gt;\n  &lt;pre&gt;&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;</div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;    <span class="comment">// Print sequences colored according to CLUSTAL scheme based on</span></div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;    <span class="comment">// physical-chemical properties</span></div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;    <span class="keywordflow">for</span> (j = 0, upper = HTMLBLOCKS; j &lt; residNumber; j += HTMLBLOCKS, upper += \</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;            HTMLBLOCKS) {</div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;        file &lt;&lt; endl;</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;        <span class="comment">// Print main columns number</span></div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;        file &lt;&lt; setw(maxLongName + 19) &lt;&lt; right &lt;&lt; (j + 10);</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;        <span class="keywordflow">for</span> (i = j + 20; ((i &lt;= residNumber) &amp;&amp; (i &lt;= upper)); i += 10)</div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;            file &lt;&lt; setw(10) &lt;&lt; right &lt;&lt; i;</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;        <span class="comment">// Print special characters to delimit sequences blocks</span></div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;        file &lt;&lt; endl &lt;&lt; setw(maxLongName + 10);</div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;        <span class="keywordflow">for</span> (i = j + 1; ((i &lt;= residNumber) &amp;&amp; (i &lt;= upper)); i++)</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;            file &lt;&lt; (!(i % 10) ? <span class="stringliteral">&quot;+&quot;</span> : <span class="stringliteral">&quot;=&quot;</span>);</div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;        <span class="comment">//Print sequences themselves </span></div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; sequenNumber; i++) {</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;</div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;            <span class="comment">// Print sequences name</span></div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;            file &lt;&lt; endl &lt;&lt; setw(maxLongName + 9) &lt;&lt; left &lt;&lt; seqsName[i];</div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;            <span class="comment">// Print residues corresponding to current sequences block</span></div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;            <span class="keywordflow">for</span> (k = j; ((k &lt; residNumber) &amp;&amp; (k &lt; upper)); k++) {</div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;                <span class="keywordflow">for</span> (kj = 0, tmpColumn.clear(); kj &lt; sequenNumber; kj++)</div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;                    tmpColumn += sequences[kj][k];</div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;                <span class="comment">// Determine residue color based on residues acrofile the alig column</span></div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;                type = <a class="code" href="classutils.html#ad1594a7c6cd34bba8e878fe09837e5d8">utils::determineColor</a>(sequences[i][k], tmpColumn);</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;                <span class="keywordflow">if</span> (type == <span class="charliteral">&#39;w&#39;</span>)</div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;                    file &lt;&lt; sequences[i][k];</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;                    file &lt;&lt; <span class="stringliteral">&quot;&lt;span id=&quot;</span> &lt;&lt; type &lt;&lt; <span class="stringliteral">&quot;&gt;&quot;</span> &lt;&lt; sequences[i][k] &lt;&lt; <span class="stringliteral">&quot;&lt;/span&gt;&quot;</span>;</div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;            }</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;        }</div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;        file &lt;&lt; endl;</div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;    }</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;</div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;    <span class="comment">// Print HTML footer into output file</span></div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;    file &lt;&lt; <span class="stringliteral">&quot;    &lt;/pre&gt;&quot;</span> &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;  &lt;/body&gt;&quot;</span> &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;&lt;/html&gt;&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;</div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;}</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;</div><div class="line"><a name="l02127"></a><span class="lineno"><a class="line" href="classnew_alignment.html#a52710ff330519de8a4e41b27e7e55958"> 2127</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classnew_alignment.html#a52710ff330519de8a4e41b27e7e55958">newAlignment::updateSequencesAndResiduesNums</a>(<span class="keywordtype">bool</span> countSequences, <span class="keywordtype">bool</span> countResidues) {</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;    <span class="comment">// Create a timerLevel that will report times upon its destruction</span></div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;    <span class="comment">//  which means the end of the current scope.</span></div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;    StartTiming(<span class="stringliteral">&quot;void newAlignment::updateSequencesAndResiduesNums(bool countSequences, bool countResidues) &quot;</span>);</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;    <span class="keywordtype">int</span> i;</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;    <span class="keywordflow">if</span> (countSequences) {</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;        <span class="keywordflow">for</span> (sequenNumber = 0, i = 0; i &lt; originalSequenNumber; i++) {</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;            <span class="keywordflow">if</span> (saveSequences[i] != -1) sequenNumber++;</div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;        }</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;    }</div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;</div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;    <span class="keywordflow">if</span> (countResidues) {</div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;        <span class="keywordflow">for</span> (residNumber = 0, i = 0; i &lt; originalResidNumber; i++) {</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;            <span class="keywordflow">if</span> (saveResidues[i] != -1) residNumber++;</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;        }</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;    }</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;}</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;</div><div class="ttc" id="classnew_alignment_html_ae157ddd55e9f41d809fb664116619802"><div class="ttname"><a href="classnew_alignment.html#ae157ddd55e9f41d809fb664116619802">newAlignment::calculateSeqOverlap</a></div><div class="ttdeci">void calculateSeqOverlap()</div><div class="ttdoc">Calculates overlap between sequences. </div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8cpp_source.html#l00382">newAlignment.cpp:382</a></div></div>
<div class="ttc" id="classnew_alignment_html_a5239bd4e742631b58efc7f09dd67f165"><div class="ttname"><a href="classnew_alignment.html#a5239bd4e742631b58efc7f09dd67f165">newAlignment::saveResidues</a></div><div class="ttdeci">int * saveResidues</div><div class="ttdoc">Vector containing which residues will be kept/removed. -1 Indicates a &amp;#39;removed/toRemove&amp;#39;. Otherwise residue/column will be kept. </div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8h_source.html#l00096">newAlignment.h:96</a></div></div>
<div class="ttc" id="classutils_html_ab04f5770187b0a8c36c3c8ca55f1e67f"><div class="ttname"><a href="classutils.html#ab04f5770187b0a8c36c3c8ca55f1e67f">utils::min</a></div><div class="ttdeci">static int min(int x, int y)</div><div class="ttdoc">Minimum of two numbers method. </div><div class="ttdef"><b>Definition:</b> <a href="utils_8cpp_source.html#l00101">utils.cpp:101</a></div></div>
<div class="ttc" id="classnew_alignment_html_a98c9b5bd9a859600ae8a317d368c85b3"><div class="ttname"><a href="classnew_alignment.html#a98c9b5bd9a859600ae8a317d368c85b3">newAlignment::printColumnsIdentity_DescriptiveStats</a></div><div class="ttdeci">void printColumnsIdentity_DescriptiveStats()</div><div class="ttdoc">Method to print Identity stats: Min, Max, Avg and Std. </div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8cpp_source.html#l01105">newAlignment.cpp:1105</a></div></div>
<div class="ttc" id="classnew_alignment_html_a6cdace1a82bc124173c80c978e42ac79"><div class="ttname"><a href="classnew_alignment.html#a6cdace1a82bc124173c80c978e42ac79">newAlignment::originalSequenNumber</a></div><div class="ttdeci">int originalSequenNumber</div><div class="ttdoc">Number of sequences the alignment had when it was loaded. </div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8h_source.html#l00069">newAlignment.h:69</a></div></div>
<div class="ttc" id="classnew_alignment_html_ac3d5c9670904bba45707746640aac382"><div class="ttname"><a href="classnew_alignment.html#ac3d5c9670904bba45707746640aac382">newAlignment::getSequenceNameOrder</a></div><div class="ttdeci">bool getSequenceNameOrder(string *names, int *orderVector)</div><div class="ttdoc">Method to map two sets of sequences, own and external. The method accepts a vector of names...</div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8cpp_source.html#l00449">newAlignment.cpp:449</a></div></div>
<div class="ttc" id="classutils_html_a1f1dcbfa7276e54acec72bdbae1b1255"><div class="ttname"><a href="classutils.html#a1f1dcbfa7276e54acec72bdbae1b1255">utils::checkAlignmentType</a></div><div class="ttdeci">static int checkAlignmentType(int seqNumber, int residNumber, string *sequences)</div><div class="ttdoc">Checks an alignment type. </div><div class="ttdef"><b>Definition:</b> <a href="utils_8cpp_source.html#l00506">utils.cpp:506</a></div></div>
<div class="ttc" id="classnew_alignment_html_ad50ba126247276cd0bf89119e439c483"><div class="ttname"><a href="classnew_alignment.html#ad50ba126247276cd0bf89119e439c483">newAlignment::prepareCodingSequence</a></div><div class="ttdeci">bool prepareCodingSequence(bool splitByStopCodon, bool ignoreStopCodon, newAlignment *proteinAlignment)</div><div class="ttdoc">Method to check if the CDS file is correct. Based on nature of residues: DNA/RNA (Most of the residue...</div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8cpp_source.html#l00525">newAlignment.cpp:525</a></div></div>
<div class="ttc" id="classnew_alignment_html_a29f7f52115fd4ecf13120e54c71b1a1a"><div class="ttname"><a href="classnew_alignment.html#a29f7f52115fd4ecf13120e54c71b1a1a">newAlignment::setKeepSequencesFlag</a></div><div class="ttdeci">void setKeepSequencesFlag(bool newFlagValue)</div><div class="ttdoc">Keep Sequences setter. </div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8cpp_source.html#l00280">newAlignment.cpp:280</a></div></div>
<div class="ttc" id="classnew_alignment_html_acfd820148c267a3d698a39758ecf190d"><div class="ttname"><a href="classnew_alignment.html#acfd820148c267a3d698a39758ecf190d">newAlignment::getNumSpecies</a></div><div class="ttdeci">int getNumSpecies()</div><div class="ttdoc">Number of sequences getter. </div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8cpp_source.html#l00251">newAlignment.cpp:251</a></div></div>
<div class="ttc" id="classnew_alignment_html_a2417feb815493866d0137ae5f5cd1028"><div class="ttname"><a href="classnew_alignment.html#a2417feb815493866d0137ae5f5cd1028">newAlignment::Cleaning</a></div><div class="ttdeci">Cleaner * Cleaning</div><div class="ttdoc">Trimming submodule. It contains methods and variables related to trimming. </div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8h_source.html#l00059">newAlignment.h:59</a></div></div>
<div class="ttc" id="classnew_alignment_html_acbeb320f0f70222f81a906ccfc33a016"><div class="ttname"><a href="classnew_alignment.html#acbeb320f0f70222f81a906ccfc33a016">newAlignment::fillMatrices</a></div><div class="ttdeci">bool fillMatrices(bool aligned)</div><div class="ttdoc">Method to initialize matrices and check if the sequences have been correctly loaded and are free of e...</div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8cpp_source.html#l00779">newAlignment.cpp:779</a></div></div>
<div class="ttc" id="classnew_alignment_html_a670d5ef1ced9ed6041c3f6afdbd2cc02"><div class="ttname"><a href="classnew_alignment.html#a670d5ef1ced9ed6041c3f6afdbd2cc02">newAlignment::getAlignmentType</a></div><div class="ttdeci">int getAlignmentType()</div><div class="ttdoc">Alignment type getter.   See SequenceTypes.</div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8cpp_source.html#l00473">newAlignment.cpp:473</a></div></div>
<div class="ttc" id="classnew_alignment_html_a6c9904f7a01e200bd167f3cf736af4d6"><div class="ttname"><a href="classnew_alignment.html#a6c9904f7a01e200bd167f3cf736af4d6">newAlignment::filename</a></div><div class="ttdeci">string filename</div><div class="ttdoc">Filename where this alignment was loaded from. </div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8h_source.html#l00085">newAlignment.h:85</a></div></div>
<div class="ttc" id="classnew_alignment_html_a4a6b47de8bef3e783f30548dfa48d84c"><div class="ttname"><a href="classnew_alignment.html#a4a6b47de8bef3e783f30548dfa48d84c">newAlignment::sequenNumber</a></div><div class="ttdeci">int sequenNumber</div><div class="ttdoc">Number of sequences present on the alignment. </div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8h_source.html#l00071">newAlignment.h:71</a></div></div>
<div class="ttc" id="classstatistics_conservation_html_a0e674b4b4b91773fb1c32a532797f328"><div class="ttname"><a href="classstatistics_conservation.html#a0e674b4b4b91773fb1c32a532797f328">statisticsConservation::getMdkWindowedVector</a></div><div class="ttdeci">float * getMdkWindowedVector()</div><div class="ttdoc">This methods returns a pointer to conservationWindow&amp;#39;s vector. </div><div class="ttdef"><b>Definition:</b> <a href="statistics_conservation_8cpp_source.html#l00314">statisticsConservation.cpp:314</a></div></div>
<div class="ttc" id="class_cleaner_html"><div class="ttname"><a href="class_cleaner.html">Cleaner</a></div><div class="ttdoc">Submodule contained by newAlignment . </div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8h_source.html#l00024">Cleaner.h:24</a></div></div>
<div class="ttc" id="classutils_html_ad1594a7c6cd34bba8e878fe09837e5d8"><div class="ttname"><a href="classutils.html#ad1594a7c6cd34bba8e878fe09837e5d8">utils::determineColor</a></div><div class="ttdeci">static char determineColor(char res, string column)</div><div class="ttdoc">Checks the color that has to be used on the output report. </div><div class="ttdef"><b>Definition:</b> <a href="utils_8cpp_source.html#l00623">utils.cpp:623</a></div></div>
<div class="ttc" id="classnew_alignment_html_ada2fb94cccdf0760c22dab39d278680c"><div class="ttname"><a href="classnew_alignment.html#ada2fb94cccdf0760c22dab39d278680c">newAlignment::dataType</a></div><div class="ttdeci">int dataType</div><div class="ttdoc">Flag variable that represents the type of the alignment. </div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8h_source.html#l00054">newAlignment.h:54</a></div></div>
<div class="ttc" id="classnew_alignment_html_a8fa808afb7d7813adbd5acdd2b0effef"><div class="ttname"><a href="classnew_alignment.html#a8fa808afb7d7813adbd5acdd2b0effef">newAlignment::printSeqOverlap</a></div><div class="ttdeci">void printSeqOverlap()</div><div class="ttdoc">Prints the overlap between sequences. </div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8cpp_source.html#l00981">newAlignment.cpp:981</a></div></div>
<div class="ttc" id="classutils_html_a40640e1942f00797e9fe8284e8fbdb14"><div class="ttname"><a href="classutils.html#a40640e1942f00797e9fe8284e8fbdb14">utils::max</a></div><div class="ttdeci">static int max(int x, int y)</div><div class="ttdoc">Maximum of two numbers method. </div><div class="ttdef"><b>Definition:</b> <a href="utils_8cpp_source.html#l00083">utils.cpp:83</a></div></div>
<div class="ttc" id="classnew_alignment_html_a02ca374daf15b6af5fdf88c75454323a"><div class="ttname"><a href="classnew_alignment.html#a02ca374daf15b6af5fdf88c75454323a">newAlignment::~newAlignment</a></div><div class="ttdeci">~newAlignment()</div><div class="ttdoc">Destructor. </div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8cpp_source.html#l00138">newAlignment.cpp:138</a></div></div>
<div class="ttc" id="namespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdoc">STL namespace. </div></div>
<div class="ttc" id="classnew_alignment_html_a94afba152da4b05735f429781cd3da57"><div class="ttname"><a href="classnew_alignment.html#a94afba152da4b05735f429781cd3da57">newAlignment::SeqRef</a></div><div class="ttdeci">int * SeqRef</div><div class="ttdoc">Pointer to keep a count of how many alignments depend on the same shared-sequences.  Increased on each trim step, and automatically reduced on each alignment destroy.  If it arrives to 0, the last alignment being destroyed will also take care of releasing memory for shared information. </div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8h_source.html#l00067">newAlignment.h:67</a></div></div>
<div class="ttc" id="classutils_html_a1dce160519187ef2c6e14beb93a2050d"><div class="ttname"><a href="classutils.html#a1dce160519187ef2c6e14beb93a2050d">utils::removeCharacter</a></div><div class="ttdeci">static string removeCharacter(char c, string line)</div><div class="ttdoc">Removes a determined char from the string. </div><div class="ttdef"><b>Definition:</b> <a href="utils_8cpp_source.html#l00493">utils.cpp:493</a></div></div>
<div class="ttc" id="class____internal_report_1_1____report_system_html_acd358cbc59625c6e2f47e0b5f825400d"><div class="ttname"><a href="class____internal_report_1_1____report_system.html#acd358cbc59625c6e2f47e0b5f825400d">__internalReport::__reportSystem::report</a></div><div class="ttdeci">void report(ErrorCode message, std::string *vars=nullptr)</div><div class="ttdoc">Method to report an Error.  It will be displayed if Level  is equal or higher to VerboseLevel::ERROR...</div><div class="ttdef"><b>Definition:</b> <a href="reportsystem_8cpp_source.html#l00375">reportsystem.cpp:375</a></div></div>
<div class="ttc" id="classnew_alignment_html"><div class="ttname"><a href="classnew_alignment.html">newAlignment</a></div><div class="ttdoc">Class containing an alignment  This class stores the alignment sequences with it&amp;#39;s names...</div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8h_source.html#l00052">newAlignment.h:52</a></div></div>
<div class="ttc" id="classnew_alignment_html_a4250245146147c153df58a3334d7fb9d"><div class="ttname"><a href="classnew_alignment.html#a4250245146147c153df58a3334d7fb9d">newAlignment::originalResidNumber</a></div><div class="ttdeci">int originalResidNumber</div><div class="ttdoc">Number of residues the alignment had when it was loaded. </div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8h_source.html#l00073">newAlignment.h:73</a></div></div>
<div class="ttc" id="classnew_alignment_html_ae8501233fe4f4ef6bfe30c99c744c7c2"><div class="ttname"><a href="classnew_alignment.html#ae8501233fe4f4ef6bfe30c99c744c7c2">newAlignment::checkCorrespondence</a></div><div class="ttdeci">bool checkCorrespondence(string *names, int *lenghts, int totalInputSequences, int multiple)</div><div class="ttdoc">Function to check CDS file. . </div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8cpp_source.html#l00701">newAlignment.cpp:701</a></div></div>
<div class="ttc" id="classnew_alignment_html_ad4e91d14819ffa8e6e57ae7c23d35327"><div class="ttname"><a href="classnew_alignment.html#ad4e91d14819ffa8e6e57ae7c23d35327">newAlignment::seqsInfo</a></div><div class="ttdeci">string * seqsInfo</div><div class="ttdoc">Vector containing extra information about each sequence. </div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8h_source.html#l00083">newAlignment.h:83</a></div></div>
<div class="ttc" id="classnew_alignment_html_ace3be92e3229fc241557597090977ba5"><div class="ttname"><a href="classnew_alignment.html#ace3be92e3229fc241557597090977ba5">newAlignment::getCorrespResidues</a></div><div class="ttdeci">int * getCorrespResidues()</div><div class="ttdoc">Method that returns the correspondence between old and new alignment residues.   See newAlignment::sa...</div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8cpp_source.html#l00482">newAlignment.cpp:482</a></div></div>
<div class="ttc" id="classnew_alignment_html_adaeafc911344fc10069f40d9fc41303f"><div class="ttname"><a href="classnew_alignment.html#adaeafc911344fc10069f40d9fc41303f">newAlignment::calculateRelaxedSeqIdentity</a></div><div class="ttdeci">void calculateRelaxedSeqIdentity()</div><div class="ttdoc">Lightweight version of newAlignment::calculateSeqIdentity for use in huge alignments. </div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8cpp_source.html#l00346">newAlignment.cpp:346</a></div></div>
<div class="ttc" id="classnew_alignment_html_a42894635dca6466308d9e21cec14d365"><div class="ttname"><a href="classnew_alignment.html#a42894635dca6466308d9e21cec14d365">newAlignment::setBlockSize</a></div><div class="ttdeci">void setBlockSize(int blockSize)</div><div class="ttdoc">blockSize BlockSize Setter. </div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8cpp_source.html#l00273">newAlignment.cpp:273</a></div></div>
<div class="ttc" id="class_statistics_manager_html"><div class="ttname"><a href="class_statistics_manager.html">StatisticsManager</a></div><div class="ttdoc">Class to handle the interaction with statistics and statistics objects. </div><div class="ttdef"><b>Definition:</b> <a href="_statistics_manager_8h_source.html#l00015">StatisticsManager.h:15</a></div></div>
<div class="ttc" id="classnew_alignment_html_a0c3cd77c8a6b118efb84b577bb4ab1ce"><div class="ttname"><a href="classnew_alignment.html#a0c3cd77c8a6b118efb84b577bb4ab1ce">newAlignment::getCorrespSequences</a></div><div class="ttdeci">int * getCorrespSequences()</div><div class="ttdoc">Method that returns the correspondence between old and new alignment sequences.   See newAlignment::s...</div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8cpp_source.html#l00489">newAlignment.cpp:489</a></div></div>
<div class="ttc" id="classnew_alignment_html_a66015efb0c5b9cd596d02d3c736cffe3"><div class="ttname"><a href="classnew_alignment.html#a66015efb0c5b9cd596d02d3c736cffe3">newAlignment::setKeepSeqsHeaderFlag</a></div><div class="ttdeci">void setKeepSeqsHeaderFlag(bool newFlagValue)</div><div class="ttdoc">Keep Header setter. </div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8cpp_source.html#l00287">newAlignment.cpp:287</a></div></div>
<div class="ttc" id="classnew_alignment_html_a781fd0f2ae6a9bda2802ffd28372bfaa"><div class="ttname"><a href="classnew_alignment.html#a781fd0f2ae6a9bda2802ffd28372bfaa">newAlignment::getTranslationCDS</a></div><div class="ttdeci">newAlignment * getTranslationCDS(newAlignment *proteinAlignment)</div><div class="ttdoc">Method to back translate a protein alignment using the sequences present on the current alignment...</div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8cpp_source.html#l00190">newAlignment.cpp:190</a></div></div>
<div class="ttc" id="classnew_alignment_html_a07b1cb8e0045677f6684ff37352af1b1"><div class="ttname"><a href="classnew_alignment.html#a07b1cb8e0045677f6684ff37352af1b1">newAlignment::newAlignment</a></div><div class="ttdeci">newAlignment()</div><div class="ttdoc">Constructor. </div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8cpp_source.html#l00055">newAlignment.cpp:55</a></div></div>
<div class="ttc" id="classnew_alignment_html_a26d10a23f8f71f95657a05e88a9a8fff"><div class="ttname"><a href="classnew_alignment.html#a26d10a23f8f71f95657a05e88a9a8fff">newAlignment::alignmentColourHTML</a></div><div class="ttdeci">bool alignmentColourHTML(ostream &amp;file)</div><div class="ttdoc">Method that saves a clustal-color based visualization of the alignment. It doesn&amp;#39;t report any trimmin...</div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8cpp_source.html#l02044">newAlignment.cpp:2044</a></div></div>
<div class="ttc" id="classnew_alignment_html_a4c739b8951d20fbe59251041c1131bd3"><div class="ttname"><a href="classnew_alignment.html#a4c739b8951d20fbe59251041c1131bd3">newAlignment::alignmentSummarySVG</a></div><div class="ttdeci">bool alignmentSummarySVG(newAlignment &amp;_trimmedAlignment, char *destFile, int blocks)</div><div class="ttdoc">Method to report the trimming results in SVG. Outputs a SVG file that shows visually what has been do...</div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8cpp_source.html#l01409">newAlignment.cpp:1409</a></div></div>
<div class="ttc" id="classnew_alignment_html_aa4bf60277ddf15e935a15b22becd6ad9"><div class="ttname"><a href="classnew_alignment.html#aa4bf60277ddf15e935a15b22becd6ad9">newAlignment::seqsName</a></div><div class="ttdeci">string * seqsName</div><div class="ttdoc">String vector containing the sequences names. </div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8h_source.html#l00081">newAlignment.h:81</a></div></div>
<div class="ttc" id="classnew_alignment_html_a1180033903a517103612ae59fd024b2f"><div class="ttname"><a href="classnew_alignment.html#a1180033903a517103612ae59fd024b2f">newAlignment::printSeqIdentity</a></div><div class="ttdeci">void printSeqIdentity()</div><div class="ttdoc">Method to print different identity values computed from the alignment. In this method we assess the i...</div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8cpp_source.html#l00892">newAlignment.cpp:892</a></div></div>
<div class="ttc" id="classnew_alignment_html_a34b1ee01d1030ce737034b35f3631e8a"><div class="ttname"><a href="classnew_alignment.html#a34b1ee01d1030ce737034b35f3631e8a">newAlignment::aligInfo</a></div><div class="ttdeci">string aligInfo</div><div class="ttdoc">String containing information of the alignment as a whole. </div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8h_source.html#l00087">newAlignment.h:87</a></div></div>
<div class="ttc" id="classnew_alignment_html_aff4e7761ec80bea74cdf28c0269b27db"><div class="ttname"><a href="classnew_alignment.html#aff4e7761ec80bea74cdf28c0269b27db">newAlignment::residNumber</a></div><div class="ttdeci">int residNumber</div><div class="ttdoc">Number of residues present on the alignment if it is aligned. </div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8h_source.html#l00075">newAlignment.h:75</a></div></div>
<div class="ttc" id="classnew_alignment_html_ad08d05c08eb66665defed4a16ab08e91"><div class="ttname"><a href="classnew_alignment.html#ad08d05c08eb66665defed4a16ab08e91">newAlignment::getNumAminos</a></div><div class="ttdeci">int getNumAminos()</div><div class="ttdoc">Residues number getter. It counts gaps as residue. </div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8cpp_source.html#l00258">newAlignment.cpp:258</a></div></div>
<div class="ttc" id="classnew_alignment_html_aa9178bd574db2b6171c0bb09133bdb94"><div class="ttname"><a href="classnew_alignment.html#aa9178bd574db2b6171c0bb09133bdb94">newAlignment::calculateSeqIdentity</a></div><div class="ttdeci">void calculateSeqIdentity()</div><div class="ttdoc">Calculates identity between sequences. </div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8cpp_source.html#l00302">newAlignment.cpp:302</a></div></div>
<div class="ttc" id="classnew_alignment_html_a23f06ad268f0e720bf3d5699a4cb7225"><div class="ttname"><a href="classnew_alignment.html#a23f06ad268f0e720bf3d5699a4cb7225">newAlignment::sequences</a></div><div class="ttdeci">string * sequences</div><div class="ttdoc">Vector containing the sequences. </div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8h_source.html#l00079">newAlignment.h:79</a></div></div>
<div class="ttc" id="classnew_alignment_html_a4761e21288fc15f3b86cf80dd4c6c91b"><div class="ttname"><a href="classnew_alignment.html#a4761e21288fc15f3b86cf80dd4c6c91b">newAlignment::getBlockSize</a></div><div class="ttdeci">int getBlockSize()</div><div class="ttdoc">BlockSize getter. </div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8cpp_source.html#l00295">newAlignment.cpp:295</a></div></div>
<div class="ttc" id="classnew_alignment_html_a52710ff330519de8a4e41b27e7e55958"><div class="ttname"><a href="classnew_alignment.html#a52710ff330519de8a4e41b27e7e55958">newAlignment::updateSequencesAndResiduesNums</a></div><div class="ttdeci">void updateSequencesAndResiduesNums(bool countSequences=true, bool countResidues=true)</div><div class="ttdoc">Updates the sequence number and residue number based on saveResidues and saveSequences. </div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8cpp_source.html#l02127">newAlignment.cpp:2127</a></div></div>
<div class="ttc" id="classnew_alignment_html_a2607115c839209324dca54d70fc8708d"><div class="ttname"><a href="classnew_alignment.html#a2607115c839209324dca54d70fc8708d">newAlignment::alignmentSummaryHTML</a></div><div class="ttdeci">bool alignmentSummaryHTML(newAlignment &amp;_trimmedAlignment, char *destFile)</div><div class="ttdoc">Method to report the trimming results in HTML. Outputs an HTML file that shows visually what has been...</div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8cpp_source.html#l01145">newAlignment.cpp:1145</a></div></div>
<div class="ttc" id="classnew_alignment_html_a8dd7e7438161fcaca8c8f35e63c5079e"><div class="ttname"><a href="classnew_alignment.html#a8dd7e7438161fcaca8c8f35e63c5079e">newAlignment::setWindowsSize</a></div><div class="ttdeci">void setWindowsSize(int ghWindow, int shWindow)</div><div class="ttdoc">Windows setter. </div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8cpp_source.html#l00265">newAlignment.cpp:265</a></div></div>
<div class="ttc" id="classnew_alignment_html_a76d057ddcebc7c88dd7f9e3ff0ce95bf"><div class="ttname"><a href="classnew_alignment.html#a76d057ddcebc7c88dd7f9e3ff0ce95bf">newAlignment::saveSequences</a></div><div class="ttdeci">int * saveSequences</div><div class="ttdoc">Vector containing which sequences will be kept/removed. -1 Indicates a &amp;#39;removed/toRemove&amp;#39;. Otherwise sequence will be kept. </div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8h_source.html#l00097">newAlignment.h:97</a></div></div>
<div class="ttc" id="classutils_html_aac322cd1761fddedec8a5792e358eb32"><div class="ttname"><a href="classutils.html#aac322cd1761fddedec8a5792e358eb32">utils::initlVect</a></div><div class="ttdeci">static void initlVect(int *vector, int tam, int valor)</div><div class="ttdoc">Vector initialization. </div><div class="ttdef"><b>Definition:</b> <a href="utils_8cpp_source.html#l00043">utils.cpp:43</a></div></div>
<div class="ttc" id="classnew_alignment_html_a3de39c62c08a265178f1fa7df76c3ab7"><div class="ttname"><a href="classnew_alignment.html#a3de39c62c08a265178f1fa7df76c3ab7">newAlignment::fillNewDataStructure</a></div><div class="ttdeci">void fillNewDataStructure(string *newMatrix, string *newNames)</div><div class="ttdoc">Method that copies information of the alignment to the pointers given. </div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8cpp_source.html#l00503">newAlignment.cpp:503</a></div></div>
<div class="ttc" id="defines_8h_html_a69d5409d6e7370d6bd3b4f931702e936adf8e3bb19d1b4de18399b64a58a39590"><div class="ttname"><a href="defines_8h.html#a69d5409d6e7370d6bd3b4f931702e936adf8e3bb19d1b4de18399b64a58a39590">AA</a></div><div class="ttdoc">AA Tag = 8. </div><div class="ttdef"><b>Definition:</b> <a href="defines_8h_source.html#l00086">defines.h:86</a></div></div>
<div class="ttc" id="classnew_alignment_html_ad916722e4ee892ee9f5cf85f0bdb80aa"><div class="ttname"><a href="classnew_alignment.html#ad916722e4ee892ee9f5cf85f0bdb80aa">newAlignment::calculateColIdentity</a></div><div class="ttdeci">void calculateColIdentity(float *columnIdentity)</div><div class="ttdoc">Method that calculates the columns identity value. This is, the frequency of the most present element...</div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8cpp_source.html#l01054">newAlignment.cpp:1054</a></div></div>
<div class="ttc" id="classnew_alignment_html_ab6b16a670e278cd5e283573665fa450f"><div class="ttname"><a href="classnew_alignment.html#ab6b16a670e278cd5e283573665fa450f">newAlignment::isAligned</a></div><div class="ttdeci">bool isAligned</div><div class="ttdoc">Flag that indicates if all sequences on the alignment have the same length (Including gaps)...</div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8h_source.html#l00077">newAlignment.h:77</a></div></div>
<div class="ttc" id="classnew_alignment_html_a0db3e76f82a71c7a2fe5b9279f8fa310"><div class="ttname"><a href="classnew_alignment.html#a0db3e76f82a71c7a2fe5b9279f8fa310">newAlignment::getSequences</a></div><div class="ttdeci">void getSequences(string *names)</div><div class="ttdoc">Getter for the sequences names. </div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8cpp_source.html#l00420">newAlignment.cpp:420</a></div></div>
<div class="ttc" id="classnew_alignment_html_a3b75055480c60265ea57ca557213fe06"><div class="ttname"><a href="classnew_alignment.html#a3b75055480c60265ea57ca557213fe06">newAlignment::printAlignmentInfo</a></div><div class="ttdeci">void printAlignmentInfo(ostream &amp;output)</div><div class="ttdoc">Print information about sequences number, average sequence length, maximum and minimum sequences leng...</div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8cpp_source.html#l00848">newAlignment.cpp:848</a></div></div>
<div class="ttc" id="classnew_alignment_html_ab865e218a05742c00d604f4a71ce9e10"><div class="ttname"><a href="classnew_alignment.html#ab865e218a05742c00d604f4a71ce9e10">newAlignment::isFileAligned</a></div><div class="ttdeci">bool isFileAligned()</div><div class="ttdoc">isAligned getter. </div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8cpp_source.html#l00496">newAlignment.cpp:496</a></div></div>
<div class="ttc" id="classnew_alignment_html_a6324267e64b68bb85d993cf602d008eb"><div class="ttname"><a href="classnew_alignment.html#a6324267e64b68bb85d993cf602d008eb">newAlignment::Statistics</a></div><div class="ttdeci">StatisticsManager * Statistics</div><div class="ttdoc">Statistics submodule. It contains methods and variables related to Statistics calculation and reporti...</div><div class="ttdef"><b>Definition:</b> <a href="new_alignment_8h_source.html#l00061">newAlignment.h:61</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><b>newAlignment.cpp</b></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
