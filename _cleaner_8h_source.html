<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="generator" content="Doxygen 1.8.13"/>
    <title>trimAl: /home/vfernandez/git/trimAl/include/Cleaner.h Source File</title>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
    <link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link href="CustomExtra.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript">
        function myFunction(ID) {
            const divs = document.getElementsByName(ID);
            for (let x of divs) {
                if (x.style.display === "none") {
                    x.style.display = "block";
                } else {
                    x.style.display = "none";
                }
            }
        } 
    </script>
</head>
<body>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
        <div id="titlearea">
            <table cellspacing="0" cellpadding="0" width=100%>
                <tbody>
                    <tr style="height: 12px;">
                        <td id="projectlogo"><img alt="Logo" src="Logo.png"/></td>
                    </tr>
                </tbody>
            </table>
            <div class="header">
                <br>
            </div>
        </div>
        <!-- end header part -->
    <!-- Generated by Doxygen 1.8.13 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_cleaner_8h_source.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Cleaner.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_cleaner_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// Created by bioinfo on 2/06/17.</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#</span><span class="preprocessor">ifndef</span> <span class="preprocessor">TRIMAL_CLEANER_H</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#</span><span class="preprocessor">define</span> <span class="preprocessor">TRIMAL_CLEANER_H</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&lt;</span><span class="preprocessor">functional</span><span class="preprocessor">&gt;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&lt;</span><span class="preprocessor">algorithm</span><span class="preprocessor">&gt;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#</span><span class="preprocessor">include</span> <span class="preprocessor">&lt;</span><span class="preprocessor">queue</span><span class="preprocessor">&gt;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// Forward declaration</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="keyword">class</span> <a class="code" href="class_alignment.html">Alignment</a>;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; <span class="comment">/**</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> \brief Submodule contained by \link Alignment Alignment \endlink.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> \par &quot;Complementary parameter&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">  Cleaning methods may contain a boolean flag argument called&lt;b&gt; &#39;complementary&#39; &lt;/b&gt;.\n</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">  If set to&lt;i&gt; true&lt;/i&gt;, the function will return a new alignment that contains</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">  the sequences and residues that method would&lt;i&gt; reject&lt;/i&gt;.\n</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">  Otherwise it returns the cleaned version of</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">  the original alignment this object belongs to.</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">  \n\n</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">  The use of this flag - complementary - is &lt;b&gt;not recommended.&lt;/b&gt;\n</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">  Complementarity is now performed when ALL methods have been applied.</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00027"></a><span class="lineno"><a class="line" href="class_cleaner.html">   27</a></span>&#160;<span class="keyword">class</span> <a class="code" href="class_cleaner.html">Cleaner</a> {</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="comment">/**</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">     \brief Flag for trimming only on the terminal positions.</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="class_cleaner.html#afb01eec0519abc849aee82743827b9c4">   34</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_cleaner.html#afb01eec0519abc849aee82743827b9c4">terminalGapOnly</a>;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;     <span class="comment">/**</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">     \brief Flag for keeping sequences even when they are composed only by gaps.</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="class_cleaner.html#a8ce7358a90df6a6be326b5a88de8b909">   38</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_cleaner.html#a8ce7358a90df6a6be326b5a88de8b909">keepSequences</a>;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;     <span class="comment">/**</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">      \brief Block size to use on the cleaning methods.</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">      */</span></div><div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="class_cleaner.html#a62ae61b54482fab8050fe34ef6b0b0a4">   42</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_cleaner.html#a62ae61b54482fab8050fe34ef6b0b0a4">blockSize</a>;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;     <span class="comment">/**</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">     \brief left boundary of the alignment</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="class_cleaner.html#ab1895110ae0546aa961c4f79a1f0f5ba">   46</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_cleaner.html#ab1895110ae0546aa961c4f79a1f0f5ba">left_boundary</a>;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;     <span class="comment">/**</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">      \brief right boundary of the alignment</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">      */</span></div><div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="class_cleaner.html#a33143efd1ca0b5ef5b9569bcc39b2505">   50</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_cleaner.html#a33143efd1ca0b5ef5b9569bcc39b2505">right_boundary</a>;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;     <span class="comment">/**</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">     \brief Method that selects the best</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">      cleaning method based on statistics of the alignment.</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_cleaner.html#a6e219be8cd47b2d084e4563c2c66a947">selectMethod</a>();</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;     <span class="comment">/**</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">     \brief Method to clean an alignment. \n</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">     It removes sequences that&lt;b&gt; overpass or equals &lt;/b&gt;a certain threshold. \n</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">     The function detects if it would clean too many sequences, </span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">      and relaxes the threshold until we have enough sequences </span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">      to achieve the given percentage desired to keep. \n</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">     To achieve this, the method starts in the middle of the sequence and, </span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">      alternating sides, adds column one by one.\n</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">     \param cut</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">      Cut value to use.</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">      If a column has a value lower or equal to the cut value, it is removed.</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">     \param baseLine</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">      Percent of sequences to keep</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">     \param gInCol</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">      Vector that contains the values that will be tested for each column.</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">     \param complementary</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">      Whether or not to return the complementary version of the trimmed alignment.</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">     \return Pointer to the cleaned alignment.</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <a class="code" href="class_alignment.html">Alignment</a> *<a class="code" href="class_cleaner.html#a13ae2074afb38708bc5cee9489d8ab6f">cleanByCutValueOverpass</a>(<span class="keywordtype">double</span> cut, <span class="keywordtype">float</span> baseLine,</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                                          <span class="keyword">const</span> <span class="keywordtype">int</span> *gInCol, <span class="keywordtype">bool</span> complementary);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;     <span class="comment">/**</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">     \brief Method to clean an alignment. \n</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">     It removes sequences that&lt;b&gt; fall behind &lt;/b&gt;a certain threshold. \n</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">     The function detects if it would clean too many sequences,</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">      and relaxes the threshold until we have enough sequences</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">      to achieve the given percentage desired to keep. \n</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">     To achieve this, the method starts in the middle of the sequence and,</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">      alternating sides, adds column one by one.</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">     \param cut</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">      Gap cut value to use.</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">     \param baseLine</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">      Percent of sequences to keep</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">     \param ValueVect</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">      Vector that contains the gaps present on each column.</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">     \param complementary</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">      Whether or not to return the complementary version of the trimmed alignment.</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">     \return Pointer to the cleaned alignment.</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="class_alignment.html">Alignment</a> *<a class="code" href="class_cleaner.html#a0e1e26d09055de52208ac74adf93b760">cleanByCutValueFallBehind</a>(<span class="keywordtype">float</span> cut, <span class="keywordtype">float</span> baseLine,</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">float</span> *ValueVect,</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                                            <span class="keywordtype">bool</span> complementary);</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;     <span class="comment">/**</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">    \brief Method to clean an alignment. \n</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">    It removes sequences that&lt;b&gt; overpass or equals &lt;/b&gt; the gap threshold</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">      but &lt;b&gt; fall behind &lt;/b&gt; the similarity threshold. \n</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">    The function detects if it would clean too many sequences,</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">      and relaxes both thresholds until we have enough sequences</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">      to achieve the given percentage desired to keep. \n</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">    To achieve this, the method starts in the middle of the sequence and,</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">      alternating sides, adds column one by one.</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">    \param cutGaps</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">      Gap cut value to use.</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">    \param baseLine</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">      Percent of sequences to keep</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">    \param gInCol</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">      Vector that contains the gaps present on each column.</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">    \param MDK_Win</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">      Vector that contains similarity value for each column.</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">    \param cutCons</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">      Minimum similarity value to keep a column in the alignment.</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">    \param complementary</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">      Whether or not to return the complementary version of the trimmed alignment.</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">    \return Pointer to the cleaned alignment.</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="class_alignment.html">Alignment</a> *<a class="code" href="class_cleaner.html#a5afcae6b995a229b59785e4690b25a0f">cleanByCutValueOverpassOrEquals</a>(</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            <span class="keywordtype">double</span> cutGaps, <span class="keyword">const</span> <span class="keywordtype">int</span> *gInCol, <span class="keywordtype">float</span> baseLine,</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            <span class="keywordtype">float</span> cutCons, <span class="keyword">const</span> <span class="keywordtype">float</span> *MDK_Win, <span class="keywordtype">bool</span> complementary);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;     <span class="comment">/**</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">     \brief Method to clean an alignment. It carries out strict and strictplus.\n</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">     It removes sequences that&lt;b&gt; overpass &lt;/b&gt;the gap threshold but</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">      &lt;b&gt; fall behind &lt;/b&gt;the similarity threshold. \n</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">     The function recovers those columns that, by themselves would be rejected,</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">      but it&#39;s neighbours (3 of 4) don&#39;t.\n</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">     Column blocks that don&#39;t have a minimum size set by the method itself,</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">      will be removed too.</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">     \param gapCut</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">      Gap cut value to use.</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">     \param gInCol</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">      Vector that contains the gaps present on each column.</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">     \param simCut</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">      Minimum similarity value to keep a column.</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">     \param MDK_W</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">      Vector that contains the similarity of each column.</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">     \param complementary</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">      Whether or not to return the complementary version of the trimmed alignment.</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">     \param variable</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">      Whether to use a variable block length.</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">      If false, block will be size 5.</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">      Else, it will use 1% of the alignment length, with a minimum of 3 and maximum of 12.</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">      This value will be overwritten if blockSize (of this object) is bigger than 0.</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">     \return Pointer to the cleaned alignment.</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <a class="code" href="class_alignment.html">Alignment</a> *<a class="code" href="class_cleaner.html#afcc9a3a0759ebdaaa6fa07c0d1702a99">cleanStrict</a>(<span class="keywordtype">int</span> gapCut, <span class="keyword">const</span> <span class="keywordtype">int</span> *gInCol, <span class="keywordtype">float</span> simCut,</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">float</span> *MDK_W, <span class="keywordtype">bool</span> complementary, <span class="keywordtype">bool</span> variable);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;     <span class="comment">/**</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">      \brief Method to trim an alignment based on a minimum sequence overlap threshold.\n</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">       The method selects a combination of parameters</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">       to maximize the final number of columns in the new alignment.\n</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">      \param minimumOverlap</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">       Min overlap to keep a sequence.</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">      \param overlapSeq</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">       Vector containing the overlap for each column.</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">      \param complementary</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">       Whether or not to return the complementary version of the trimmed alignment.</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">      \return Pointer to the cleaned alignment.</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="class_alignment.html">Alignment</a> *<a class="code" href="class_cleaner.html#abe5d03c820a6bee7935b719b9fc7be60">cleanOverlapSeq</a>(<span class="keywordtype">float</span> minimumOverlap, <span class="keywordtype">float</span> *overlapSeq,</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                                  <span class="keywordtype">bool</span> complementary);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;     <span class="comment">/**</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">      \brief Method to trim an alignment based on the gap distribution values.</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">       Column blocks that don&#39;t have a minimum size set by the method itself,</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">       will be removed too.</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">      \param baseLine</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">       Minimum percentage of columns to conserve in the new alignment.</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">      \param gapsPct</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">       Maximum percentage of gaps per column.</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">      \param complementary</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">       Whether or not to return the complementary version of the trimmed alignment.</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">      \return Pointer to the cleaned alignment.</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <a class="code" href="class_alignment.html">Alignment</a> *<a class="code" href="class_cleaner.html#af7c9e1a177424168fa4214aca9ebd8e2">cleanGaps</a>(<span class="keywordtype">float</span> baseLine, <span class="keywordtype">float</span> gapsPct,</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                            <span class="keywordtype">bool</span> complementary);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;     <span class="comment">/**</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">      \brief Method to trim an alignment based on the similarity distribution values.</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">      \param baseLine</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">       Minimum percentage of columns to conserve in the new alignment.</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">      \param conservationPct</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">       Minimum value of similarity per column to keep the column.</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">      \param complementary</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">       Whether or not to return the complementary version of the trimmed alignment.</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">      \return Pointer to the cleaned alignment.</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <a class="code" href="class_alignment.html">Alignment</a> *<a class="code" href="class_cleaner.html#a9cdbd6ebf78a284dd065b31319795b0c">cleanConservation</a>(<span class="keywordtype">float</span> baseLine, <span class="keywordtype">float</span> conservationPct,</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                                    <span class="keywordtype">bool</span> complementary);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;     <span class="comment">/**</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">      \brief Method to trim an alignment based on the</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">       similarity and gaps distribution values.\n</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">      \param baseLine</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">       Minimum percentage of columns to conserve in the new alignment.</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">      \param GapsPct</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">       Maximum percentage of gaps per column.</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">      \param conservationPct</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">       Minimum value of similarity per column to keep the column.</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">      \param complementary</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">       Whether or not to return the complementary version of the trimmed alignment.</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">      \par &quot;Take in mind&quot;</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">       If baseLine is too strict, the other two will be relaxed</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">       to obtain the minimum percentage desired.</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">      \return Pointer to the cleaned alignment.</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="class_alignment.html">Alignment</a> *<a class="code" href="class_cleaner.html#a4718e31c0183b5a98751d77479faacf0">clean</a>(<span class="keywordtype">float</span> baseLine, <span class="keywordtype">float</span> GapsPct,</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                        <span class="keywordtype">float</span> conservationPct, <span class="keywordtype">bool</span> complementary);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;     <span class="comment">/**</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">      \brief Method to trim an alignment based on consistency values </span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">       obtained from a dataset of alignments.\n</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">       The function computes the optimal parameter combination values</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">       to trim an alignment based on the consistency value </span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">       from the comparison among a dataset of alignments with the same sequences.</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">      \param cutpoint </span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">       Hint of Gap cut point.</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">       May be used if it&#39;s lower than the minimum percentage threshold.</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">      \param baseLine </span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">       Minimum percentage of columns to conserve in the new alignment.</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">      \param vectValues</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">       Vector with alignment consistency values</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">      \param complementary</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">       Whether or not to return the complementary version of the trimmed alignment.</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">      \return Pointer to the cleaned alignment.</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <a class="code" href="class_alignment.html">Alignment</a> *<a class="code" href="class_cleaner.html#a385f785ecf54bd5e0b07e61325483973">cleanCompareFile</a>(<span class="keywordtype">float</span> cutpoint, <span class="keywordtype">float</span> baseLine, <span class="keywordtype">float</span> *vectValues, <span class="keywordtype">bool</span> complementary);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;     <span class="comment">/**</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">      \brief Method to compute the overlap values.\n</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">        See Alignment::overlaps</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">      \param overlap</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">       Overlap threshold.</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">      \param[out] spuriousVector</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">       Pointer to the spuriousVector to fill.</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">      \return   &lt;b&gt; True &lt;/b&gt; if the calculation went ok.\n</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">                &lt;b&gt; False &lt;/b&gt; otherwise.\n</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">      This should happen only if you pass a null pointer instead of a spuriousVector.</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_cleaner.html#ab2db8eacfbe545c68fc287c43309e439">calculateSpuriousVector</a>(<span class="keywordtype">float</span> overlap, <span class="keywordtype">float</span> *spuriousVector);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;     <span class="comment">/**</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">      \brief Method to remove sequences missaligned</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">       with the rest of sequences in the alignment.\n</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">       For each residue in the sequence, it tests it&#39;s similarity.</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">       If the similarity of that residue is higher than overlapColumn value,</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">       it counts as a hit for the sequence.\n</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">      After calculating the number of hits for the sequence,</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">      it removes the sequence if it has a proportion hits/residues</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">      lower tan minimumOverlap.</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">      \param overlapColumn</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">      Minimum similarity value that a residue needs to be considered a hit.</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">      \param minimumOverlap</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">      Minimum proportion of hits that a sequence needs to be kept in the new alignment.</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">      \param complementary</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">      Whether or not to return the complementary version of the trimmed alignment.</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">      \return Pointer to the cleaned alignment.</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">      \</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">      */</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <a class="code" href="class_alignment.html">Alignment</a> *<a class="code" href="class_cleaner.html#a5ceceb5b637a6d4e6a13c3b5d8d76c1d">cleanSpuriousSeq</a>(<span class="keywordtype">float</span> overlapColumn, <span class="keywordtype">float</span> minimumOverlap, <span class="keywordtype">bool</span> complementary);</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;     <span class="comment">/**</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">      \brief Method that carries the gappyout approach.\n</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">      This methods calculates the slope in gaps distribution</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">       on the original alignment.\n</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">      Then, it compares groups of three consecutive residues,</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">       searching for the group with the most abrupt change in slope.\n</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">      When found, the first residue is taken as the cutpoint for the sequences.</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">      \param complementary</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">       Whether or not to return the complementary version of the trimmed alignment.</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">      */</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <a class="code" href="class_alignment.html">Alignment</a> *<a class="code" href="class_cleaner.html#aa57106470d2104a925b9396b8a9f33b3">clean2ndSlope</a>(<span class="keywordtype">bool</span> complementary);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;     <span class="comment">/**</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">     \brief Method to clean an alignment. It carries out strict and strictplus.\n</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">     The method:</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">       - Computes gaps values and gap cut point of the alignment.</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">       - Computes similarity values and similarity cut point of the alignment.</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">       - Calls the cleanStrict method with these values and returns its output.</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">     \param complementary</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">      Whether or not to return the complementary version of the trimmed alignment.</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">     \param variable Whether to use a variable block length.</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">     If false, block will be size 5.</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">     Else, it will use 1% of the alignment length, with a minimum of 3 and maximum of 12.</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">     This value will be overwritten if blockSize (of this object) is bigger than 0.</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">     \return Pointer to the cleaned alignment returned by cleanStrict</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">      using the parameters calculated in this function.</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <a class="code" href="class_alignment.html">Alignment</a> *<a class="code" href="class_cleaner.html#a6727a235afa29f08a50716f28fa5c8fc">cleanCombMethods</a>(<span class="keywordtype">bool</span> complementary, <span class="keywordtype">bool</span> variable);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;     <span class="comment">/**</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">      \brief Method to remove columns composed only by gaps\n</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">      This method is specially useful when we remove missaligned sequences</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">       from a given alignment.</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">      \param complementary</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">       Whether or not to return the complementary version of the trimmed alignment.</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">       \n Although this method contains a complementary flag,</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">       setting this up would return an alignment full of gaps-only columns.</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">      */</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <a class="code" href="class_alignment.html">Alignment</a> *<a class="code" href="class_cleaner.html#a3af7bde2142886d6d723c95694b7b9ba">cleanNoAllGaps</a>(<span class="keywordtype">bool</span> complementary);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;     <span class="comment">/**</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">      \brief Method to remove columns, expressed as ranges.</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">      \param columns</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">       Vector containing the columns to remove.</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">      \param init</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">       Where does the vector start. Set to 1 if the vector contains its size as first element.</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">      \param size</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">       Size of the columns vector.</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">      \param complementary</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">       Whether or not to return the complementary version of the trimmed alignment.</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">      */</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <a class="code" href="class_alignment.html">Alignment</a> *<a class="code" href="class_cleaner.html#ac8e92eb8ae8a5caf021801e56cdb9faf">removeColumns</a>(<span class="keywordtype">int</span> *columns, <span class="keywordtype">int</span> init, <span class="keywordtype">int</span> size, <span class="keywordtype">bool</span> complementary);</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;     <span class="comment">/**</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">      \brief Method to remove sequences, expressed as ranges.</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">      \param seqs</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">       Vector containing the sequences to remove.</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">      \param init</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">       Where does the vector start.</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">       Set to 1 if the vector contains its size as first element.</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">      \param size</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">       Size of the columns vector.</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">      \param complementary</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">       Whether or not to return the complementary version of the trimmed alignment.</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">      */</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <a class="code" href="class_alignment.html">Alignment</a> *<a class="code" href="class_cleaner.html#a932af26c56652410dc2a30c553376c0b">removeSequences</a>(<span class="keywordtype">int</span> *seqs, <span class="keywordtype">int</span> init, <span class="keywordtype">int</span> size, <span class="keywordtype">bool</span> complementary);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;     <span class="comment">/**</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">      \brief Method to select the most representative sequence (the longest one)</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">       for each cluster from the input alignment to generate a new alignment.</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">      \param identityThreshold</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">      Threshold used to assign sequences to clusters.\n</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">       If identity between representative sequence of the cluster and</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">       sequence to assign is superior to this threshold and</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">       no other cluster has a better identity with its representative,</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">       it will be assigned to that cluster.</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">      */</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <a class="code" href="class_alignment.html">Alignment</a> *<a class="code" href="class_cleaner.html#a4fd1d8eb883d1a7b271d6d4e1b1df71b">getClustering</a>(<span class="keywordtype">float</span> identityThreshold);</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;     <span class="comment">/**</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">      \brief Method that calculates the optimal cut point for a given clusters number.\n</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">       The idea is to obtain a cutpoint that can be used to obtain</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">       as sequences as clusterNumber</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">      \param clusterNumber</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">       Number of representative sequences to obtain.</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">      \return CutPoint to obtain clusterNumber sequences.</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">      */</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="class_cleaner.html#a60955e2ae3faa3ccf84780a52fb1a08a">getCutPointClusters</a>(<span class="keywordtype">int</span> clusterNumber);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;     <span class="comment">/**</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">      \brief Method to remove blocks of columns with no rejected residue</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">        smaller than a given size.</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">      \param blockSize Minimum size to remove a block from the alignment</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">      \param original Alignment to apply the removal.</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">       Minimum size a block has to be to be kept.</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">      */</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_cleaner.html#a5620f6a511bc0ac844c71b2de3ae1fdb">removeSmallerBlocks</a>(<span class="keywordtype">int</span> blockSize, <a class="code" href="class_alignment.html">Alignment</a> &amp;original);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;     <span class="comment">/**</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">      \brief Method to detect right and left borders.</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">       Borders are the first column found with no gaps.\n</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">      Everything between the borders are kept in the trimmed alignments.</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">      \return   &lt;b&gt;True&lt;/b&gt; if everything went ok.</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">      \n        &lt;b&gt; False &lt;/b&gt;if it was not possible to calculate the gap stats.</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">      */</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_cleaner.html#ab7f5b746b97697181f4cd06063cbb49a">removeOnlyTerminal</a>();</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;     <span class="comment">/**</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">     \brief Method that identifies and removes columns and sequences composed only by gaps.</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_cleaner.html#ada8ad076dd037f00ae3f4fd17762641f">removeAllGapsSeqsAndCols</a>(<span class="keywordtype">bool</span> seqs = <span class="keyword">true</span>, <span class="keywordtype">bool</span> cols = <span class="keyword">true</span>);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;     <span class="comment">/**</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">      \brief Setter method to Terminal Only Flag.</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">      \param terminalOnly_</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">       New vlue of the Terminal Only Flag.</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">      */</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_cleaner.html#a1f4cdd8e06a4c461534a694ffa4ec1a2">setTrimTerminalGapsFlag</a>(<span class="keywordtype">bool</span> terminalOnly_);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;     <span class="comment">/**</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">     \warning Not In Use</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">     \brief Boundaries setter</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">     \param[in] boundaries</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">      New boundaries values.</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_cleaner.html#a60e7c96314e666c4ab8cade7c10341a3">setBoundaries</a>(<span class="keywordtype">int</span> *boundaries);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;     <span class="comment">/**</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">      \brief Method to calculate identities between the sequences from the alignment.\n</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">      See Alignment::identities</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">      */</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_cleaner.html#a65d829578be97c192561a129435b3c58">calculateSeqIdentity</a>();</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;     <span class="comment">/**</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">      \warning Not In Use</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">      \brief Method that makes a raw approximation of sequence identity computation.\n</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">      \note Designed for reducing comparisons for huge alignments.</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">      */</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_cleaner.html#a5a4ba3fd7351c908cbb44d5381b5320e">calculateRelaxedSeqIdentity</a>();</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;     <span class="comment">/**</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">        \brief Method to assign sequences to clusters.\n</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">        Clusters are calculated following this flow:</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">          - Select the longest sequence and</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">                use it as representative of the first cluster.\n</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">          - Using the previously computed identity values,</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">                check if second longest sequence should be part of</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">                cluster of first sequence.</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">            This is computed using the identity value</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">                in comparison with a threshold.\n</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">          - If the second sequence should be part of the existing cluster, we add it.</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">            Otherwise we create a new cluster and</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">            use this sequence as representative for this new cluster.\n</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">          - Continue with the rest of sequences,</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">                comparing them with the representatives of existing clusters.</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">            If a sequence can pertain to more than one cluster,</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">                we choose the one that maximizes the identity value</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">                with the representative sequence.</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">        \param maximumIdent</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">         Identity threshold used to decide if a sequence should be part of</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">         a cluster or create a new one.</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">        \return Vector that contains the clustering info.\n</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">        The first item in the vector contains it&#39;s size.</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">        */</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keywordtype">int</span> *<a class="code" href="class_cleaner.html#a631cf3e2e55c00a995f0f4a51bfe7a2d">calculateRepresentativeSeq</a>(<span class="keywordtype">float</span> maximumIdent);</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;     <span class="comment">/**</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">      \brief Method for computing the complementary alignment.\n</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">       Complementary alignment is an alignment containing all</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">       sequences and columns that the original alignment would reject.\n</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">      It inverses the saveResidues / saveSequences tags.</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">      \param residues Whether to reverse resiudes tags.</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">      \param sequences Whether to reverse sequences tags.</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">      */</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_cleaner.html#a24bd28e4191afc9471adff329bee1466">computeComplementaryAlig</a>(<span class="keywordtype">bool</span> residues, <span class="keywordtype">bool</span> sequences);</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div><div class="line"><a name="l00450"></a><span class="lineno"><a class="line" href="class_cleaner.html#a3932cc3ef9a1bb046b8229b968c7b23d">  450</a></span>&#160;    <span class="keyword">friend</span> <span class="keyword">class</span> <a class="code" href="class_alignment.html">Alignment</a>;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;     <span class="comment">/**</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">      \brief Pointer to the alignment that contains this object</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">      */</span></div><div class="line"><a name="l00455"></a><span class="lineno"><a class="line" href="class_cleaner.html#aee04f0a0d0662ed8ecb93766051414b9">  455</a></span>&#160;    <a class="code" href="class_alignment.html">Alignment</a> *<a class="code" href="class_cleaner.html#aee04f0a0d0662ed8ecb93766051414b9">alig</a>;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;     <span class="comment">/**</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">      \brief Class Constructor - Called by \link Alignment \endlink</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">      */</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;     <span class="keyword">explicit</span> <a class="code" href="class_cleaner.html#a3d3f55edb6c9e43890b68c8fcb50a22a">Cleaner</a>(<a class="code" href="class_alignment.html">Alignment</a> *parent);</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;     <span class="comment">/**</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">     \brief Copy Constructor - Called by \link Alignment \endlink</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <a class="code" href="class_cleaner.html#afe42cb635ddd6bd968ae57e378deaac8">Cleaner</a>(<a class="code" href="class_alignment.html">Alignment</a> *parent, <a class="code" href="class_cleaner.html">Cleaner</a> *mold);</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;};</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="preprocessor">#</span><span class="preprocessor">endif</span> <span class="comment">//TRIMAL_CLEANER_H</span></div><div class="ttc" id="class_cleaner_html_a6727a235afa29f08a50716f28fa5c8fc"><div class="ttname"><a href="class_cleaner.html#a6727a235afa29f08a50716f28fa5c8fc">Cleaner::cleanCombMethods</a></div><div class="ttdeci">Alignment * cleanCombMethods(bool complementary, bool variable)</div><div class="ttdoc">Method to clean an alignment. It carries out strict and strictplus. The method: </div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8cpp_source.html#l00952">Cleaner.cpp:952</a></div></div>
<div class="ttc" id="class_cleaner_html_a5a4ba3fd7351c908cbb44d5381b5320e"><div class="ttname"><a href="class_cleaner.html#a5a4ba3fd7351c908cbb44d5381b5320e">Cleaner::calculateRelaxedSeqIdentity</a></div><div class="ttdeci">void calculateRelaxedSeqIdentity()</div><div class="ttdoc">Method that makes a raw approximation of sequence identity computation. . </div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8cpp_source.html#l01470">Cleaner.cpp:1470</a></div></div>
<div class="ttc" id="class_cleaner_html_a62ae61b54482fab8050fe34ef6b0b0a4"><div class="ttname"><a href="class_cleaner.html#a62ae61b54482fab8050fe34ef6b0b0a4">Cleaner::blockSize</a></div><div class="ttdeci">int blockSize</div><div class="ttdoc">Block size to use on the cleaning methods. </div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8h_source.html#l00042">Cleaner.h:42</a></div></div>
<div class="ttc" id="class_cleaner_html_a4718e31c0183b5a98751d77479faacf0"><div class="ttname"><a href="class_cleaner.html#a4718e31c0183b5a98751d77479faacf0">Cleaner::clean</a></div><div class="ttdeci">Alignment * clean(float baseLine, float GapsPct, float conservationPct, bool complementary)</div><div class="ttdoc">Method to trim an alignment based on the similarity and gaps distribution values. ...</div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8cpp_source.html#l00756">Cleaner.cpp:756</a></div></div>
<div class="ttc" id="class_cleaner_html_ab1895110ae0546aa961c4f79a1f0f5ba"><div class="ttname"><a href="class_cleaner.html#ab1895110ae0546aa961c4f79a1f0f5ba">Cleaner::left_boundary</a></div><div class="ttdeci">int left_boundary</div><div class="ttdoc">left boundary of the alignment </div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8h_source.html#l00046">Cleaner.h:46</a></div></div>
<div class="ttc" id="class_cleaner_html_a5620f6a511bc0ac844c71b2de3ae1fdb"><div class="ttname"><a href="class_cleaner.html#a5620f6a511bc0ac844c71b2de3ae1fdb">Cleaner::removeSmallerBlocks</a></div><div class="ttdeci">void removeSmallerBlocks(int blockSize, Alignment &amp;original)</div><div class="ttdoc">Method to remove blocks of columns with no rejected residue smaller than a given size. </div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8cpp_source.html#l01298">Cleaner.cpp:1298</a></div></div>
<div class="ttc" id="class_cleaner_html_a631cf3e2e55c00a995f0f4a51bfe7a2d"><div class="ttname"><a href="class_cleaner.html#a631cf3e2e55c00a995f0f4a51bfe7a2d">Cleaner::calculateRepresentativeSeq</a></div><div class="ttdeci">int * calculateRepresentativeSeq(float maximumIdent)</div><div class="ttdoc">Method to assign sequences to clusters. Clusters are calculated following this flow: ...</div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8cpp_source.html#l01512">Cleaner.cpp:1512</a></div></div>
<div class="ttc" id="class_cleaner_html_a4fd1d8eb883d1a7b271d6d4e1b1df71b"><div class="ttname"><a href="class_cleaner.html#a4fd1d8eb883d1a7b271d6d4e1b1df71b">Cleaner::getClustering</a></div><div class="ttdeci">Alignment * getClustering(float identityThreshold)</div><div class="ttdoc">Method to select the most representative sequence (the longest one) for each cluster from the input a...</div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8cpp_source.html#l01183">Cleaner.cpp:1183</a></div></div>
<div class="ttc" id="class_cleaner_html_a6e219be8cd47b2d084e4563c2c66a947"><div class="ttname"><a href="class_cleaner.html#a6e219be8cd47b2d084e4563c2c66a947">Cleaner::selectMethod</a></div><div class="ttdeci">int selectMethod()</div><div class="ttdoc">Method that selects the best cleaning method based on statistics of the alignment. </div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8cpp_source.html#l00014">Cleaner.cpp:14</a></div></div>
<div class="ttc" id="class_cleaner_html"><div class="ttname"><a href="class_cleaner.html">Cleaner</a></div><div class="ttdoc">Submodule contained by Alignment . </div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8h_source.html#l00027">Cleaner.h:27</a></div></div>
<div class="ttc" id="class_cleaner_html_a932af26c56652410dc2a30c553376c0b"><div class="ttname"><a href="class_cleaner.html#a932af26c56652410dc2a30c553376c0b">Cleaner::removeSequences</a></div><div class="ttdeci">Alignment * removeSequences(int *seqs, int init, int size, bool complementary)</div><div class="ttdoc">Method to remove sequences, expressed as ranges. </div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8cpp_source.html#l01234">Cleaner.cpp:1234</a></div></div>
<div class="ttc" id="class_cleaner_html_ac8e92eb8ae8a5caf021801e56cdb9faf"><div class="ttname"><a href="class_cleaner.html#ac8e92eb8ae8a5caf021801e56cdb9faf">Cleaner::removeColumns</a></div><div class="ttdeci">Alignment * removeColumns(int *columns, int init, int size, bool complementary)</div><div class="ttdoc">Method to remove columns, expressed as ranges. </div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8cpp_source.html#l01212">Cleaner.cpp:1212</a></div></div>
<div class="ttc" id="class_cleaner_html_af7c9e1a177424168fa4214aca9ebd8e2"><div class="ttname"><a href="class_cleaner.html#af7c9e1a177424168fa4214aca9ebd8e2">Cleaner::cleanGaps</a></div><div class="ttdeci">Alignment * cleanGaps(float baseLine, float gapsPct, bool complementary)</div><div class="ttdoc">Method to trim an alignment based on the gap distribution values. Column blocks that don&amp;#39;t have a min...</div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8cpp_source.html#l00708">Cleaner.cpp:708</a></div></div>
<div class="ttc" id="class_cleaner_html_ab2db8eacfbe545c68fc287c43309e439"><div class="ttname"><a href="class_cleaner.html#ab2db8eacfbe545c68fc287c43309e439">Cleaner::calculateSpuriousVector</a></div><div class="ttdeci">bool calculateSpuriousVector(float overlap, float *spuriousVector)</div><div class="ttdoc">Method to compute the overlap values.  See Alignment::overlaps. </div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8cpp_source.html#l00827">Cleaner.cpp:827</a></div></div>
<div class="ttc" id="class_cleaner_html_a3af7bde2142886d6d723c95694b7b9ba"><div class="ttname"><a href="class_cleaner.html#a3af7bde2142886d6d723c95694b7b9ba">Cleaner::cleanNoAllGaps</a></div><div class="ttdeci">Alignment * cleanNoAllGaps(bool complementary)</div><div class="ttdoc">Method to remove columns composed only by gaps This method is specially useful when we remove missali...</div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8cpp_source.html#l01021">Cleaner.cpp:1021</a></div></div>
<div class="ttc" id="class_cleaner_html_a5afcae6b995a229b59785e4690b25a0f"><div class="ttname"><a href="class_cleaner.html#a5afcae6b995a229b59785e4690b25a0f">Cleaner::cleanByCutValueOverpassOrEquals</a></div><div class="ttdeci">Alignment * cleanByCutValueOverpassOrEquals(double cutGaps, const int *gInCol, float baseLine, float cutCons, const float *MDK_Win, bool complementary)</div><div class="ttdoc">Method to clean an alignment.  It removes sequences that overpass or equals  the gap threshold but  f...</div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8cpp_source.html#l00329">Cleaner.cpp:329</a></div></div>
<div class="ttc" id="class_cleaner_html_afe42cb635ddd6bd968ae57e378deaac8"><div class="ttname"><a href="class_cleaner.html#afe42cb635ddd6bd968ae57e378deaac8">Cleaner::Cleaner</a></div><div class="ttdeci">Cleaner(Alignment *parent, Cleaner *mold)</div><div class="ttdoc">Copy Constructor - Called by Alignment. </div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8cpp_source.html#l01613">Cleaner.cpp:1613</a></div></div>
<div class="ttc" id="class_alignment_html"><div class="ttname"><a href="class_alignment.html">Alignment</a></div><div class="ttdoc">Class containing an alignment  This class stores the alignment sequences with it&amp;#39;s names...</div><div class="ttdef"><b>Definition:</b> <a href="_alignment_8h_source.html#l00049">Alignment.h:49</a></div></div>
<div class="ttc" id="class_cleaner_html_a3d3f55edb6c9e43890b68c8fcb50a22a"><div class="ttname"><a href="class_cleaner.html#a3d3f55edb6c9e43890b68c8fcb50a22a">Cleaner::Cleaner</a></div><div class="ttdeci">Cleaner(Alignment *parent)</div><div class="ttdoc">Class Constructor - Called by Alignment. </div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8cpp_source.html#l01598">Cleaner.cpp:1598</a></div></div>
<div class="ttc" id="class_cleaner_html_ab7f5b746b97697181f4cd06063cbb49a"><div class="ttname"><a href="class_cleaner.html#ab7f5b746b97697181f4cd06063cbb49a">Cleaner::removeOnlyTerminal</a></div><div class="ttdeci">bool removeOnlyTerminal()</div><div class="ttdoc">Method to detect right and left borders. Borders are the first column found with no gaps...</div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8cpp_source.html#l01255">Cleaner.cpp:1255</a></div></div>
<div class="ttc" id="class_cleaner_html_a65d829578be97c192561a129435b3c58"><div class="ttname"><a href="class_cleaner.html#a65d829578be97c192561a129435b3c58">Cleaner::calculateSeqIdentity</a></div><div class="ttdeci">void calculateSeqIdentity()</div><div class="ttdoc">Method to calculate identities between the sequences from the alignment. See Alignment::identities. </div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8cpp_source.html#l01421">Cleaner.cpp:1421</a></div></div>
<div class="ttc" id="class_cleaner_html_a1f4cdd8e06a4c461534a694ffa4ec1a2"><div class="ttname"><a href="class_cleaner.html#a1f4cdd8e06a4c461534a694ffa4ec1a2">Cleaner::setTrimTerminalGapsFlag</a></div><div class="ttdeci">void setTrimTerminalGapsFlag(bool terminalOnly_)</div><div class="ttdoc">Setter method to Terminal Only Flag. </div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8cpp_source.html#l01166">Cleaner.cpp:1166</a></div></div>
<div class="ttc" id="class_cleaner_html_a8ce7358a90df6a6be326b5a88de8b909"><div class="ttname"><a href="class_cleaner.html#a8ce7358a90df6a6be326b5a88de8b909">Cleaner::keepSequences</a></div><div class="ttdeci">bool keepSequences</div><div class="ttdoc">Flag for keeping sequences even when they are composed only by gaps. </div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8h_source.html#l00038">Cleaner.h:38</a></div></div>
<div class="ttc" id="class_cleaner_html_ada8ad076dd037f00ae3f4fd17762641f"><div class="ttname"><a href="class_cleaner.html#ada8ad076dd037f00ae3f4fd17762641f">Cleaner::removeAllGapsSeqsAndCols</a></div><div class="ttdeci">void removeAllGapsSeqsAndCols(bool seqs=true, bool cols=true)</div><div class="ttdoc">Method that identifies and removes columns and sequences composed only by gaps. </div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8cpp_source.html#l01354">Cleaner.cpp:1354</a></div></div>
<div class="ttc" id="class_cleaner_html_a5ceceb5b637a6d4e6a13c3b5d8d76c1d"><div class="ttname"><a href="class_cleaner.html#a5ceceb5b637a6d4e6a13c3b5d8d76c1d">Cleaner::cleanSpuriousSeq</a></div><div class="ttdeci">Alignment * cleanSpuriousSeq(float overlapColumn, float minimumOverlap, bool complementary)</div><div class="ttdoc">Method to remove sequences missaligned with the rest of sequences in the alignment.  For each residue in the sequence, it tests it&amp;#39;s similarity. If the similarity of that residue is higher than overlapColumn value, it counts as a hit for the sequence. After calculating the number of hits for the sequence, it removes the sequence if it has a proportion hits/residues lower tan minimumOverlap. </div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8cpp_source.html#l00906">Cleaner.cpp:906</a></div></div>
<div class="ttc" id="class_cleaner_html_a33143efd1ca0b5ef5b9569bcc39b2505"><div class="ttname"><a href="class_cleaner.html#a33143efd1ca0b5ef5b9569bcc39b2505">Cleaner::right_boundary</a></div><div class="ttdeci">int right_boundary</div><div class="ttdoc">right boundary of the alignment </div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8h_source.html#l00050">Cleaner.h:50</a></div></div>
<div class="ttc" id="class_cleaner_html_afb01eec0519abc849aee82743827b9c4"><div class="ttname"><a href="class_cleaner.html#afb01eec0519abc849aee82743827b9c4">Cleaner::terminalGapOnly</a></div><div class="ttdeci">bool terminalGapOnly</div><div class="ttdoc">Flag for trimming only on the terminal positions. </div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8h_source.html#l00034">Cleaner.h:34</a></div></div>
<div class="ttc" id="class_cleaner_html_a24bd28e4191afc9471adff329bee1466"><div class="ttname"><a href="class_cleaner.html#a24bd28e4191afc9471adff329bee1466">Cleaner::computeComplementaryAlig</a></div><div class="ttdeci">void computeComplementaryAlig(bool residues, bool sequences)</div><div class="ttdoc">Method for computing the complementary alignment.  Complementary alignment is an alignment containing...</div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8cpp_source.html#l01576">Cleaner.cpp:1576</a></div></div>
<div class="ttc" id="class_cleaner_html_a9cdbd6ebf78a284dd065b31319795b0c"><div class="ttname"><a href="class_cleaner.html#a9cdbd6ebf78a284dd065b31319795b0c">Cleaner::cleanConservation</a></div><div class="ttdeci">Alignment * cleanConservation(float baseLine, float conservationPct, bool complementary)</div><div class="ttdoc">Method to trim an alignment based on the similarity distribution values. </div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8cpp_source.html#l00732">Cleaner.cpp:732</a></div></div>
<div class="ttc" id="class_cleaner_html_a60e7c96314e666c4ab8cade7c10341a3"><div class="ttname"><a href="class_cleaner.html#a60e7c96314e666c4ab8cade7c10341a3">Cleaner::setBoundaries</a></div><div class="ttdeci">void setBoundaries(int *boundaries)</div><div class="ttdoc">Boundaries setter. </div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8cpp_source.html#l01173">Cleaner.cpp:1173</a></div></div>
<div class="ttc" id="class_cleaner_html_afcc9a3a0759ebdaaa6fa07c0d1702a99"><div class="ttname"><a href="class_cleaner.html#afcc9a3a0759ebdaaa6fa07c0d1702a99">Cleaner::cleanStrict</a></div><div class="ttdeci">Alignment * cleanStrict(int gapCut, const int *gInCol, float simCut, const float *MDK_W, bool complementary, bool variable)</div><div class="ttdoc">Method to clean an alignment. It carries out strict and strictplus. It removes sequences that overpas...</div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8cpp_source.html#l00485">Cleaner.cpp:485</a></div></div>
<div class="ttc" id="class_cleaner_html_a0e1e26d09055de52208ac74adf93b760"><div class="ttname"><a href="class_cleaner.html#a0e1e26d09055de52208ac74adf93b760">Cleaner::cleanByCutValueFallBehind</a></div><div class="ttdeci">Alignment * cleanByCutValueFallBehind(float cut, float baseLine, const float *ValueVect, bool complementary)</div><div class="ttdoc">Method to clean an alignment.  It removes sequences that fall behind a certain threshold.  The function detects if it would clean too many sequences, and relaxes the threshold until we have enough sequences to achieve the given percentage desired to keep.  To achieve this, the method starts in the middle of the sequence and, alternating sides, adds column one by one. </div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8cpp_source.html#l00203">Cleaner.cpp:203</a></div></div>
<div class="ttc" id="class_cleaner_html_a60955e2ae3faa3ccf84780a52fb1a08a"><div class="ttname"><a href="class_cleaner.html#a60955e2ae3faa3ccf84780a52fb1a08a">Cleaner::getCutPointClusters</a></div><div class="ttdeci">float getCutPointClusters(int clusterNumber)</div><div class="ttdoc">Method that calculates the optimal cut point for a given clusters number.  The idea is to obtain a cu...</div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8cpp_source.html#l01040">Cleaner.cpp:1040</a></div></div>
<div class="ttc" id="class_cleaner_html_abe5d03c820a6bee7935b719b9fc7be60"><div class="ttname"><a href="class_cleaner.html#abe5d03c820a6bee7935b719b9fc7be60">Cleaner::cleanOverlapSeq</a></div><div class="ttdeci">Alignment * cleanOverlapSeq(float minimumOverlap, float *overlapSeq, bool complementary)</div><div class="ttdoc">Method to trim an alignment based on a minimum sequence overlap threshold.  The method selects a comb...</div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8cpp_source.html#l00686">Cleaner.cpp:686</a></div></div>
<div class="ttc" id="class_cleaner_html_a385f785ecf54bd5e0b07e61325483973"><div class="ttname"><a href="class_cleaner.html#a385f785ecf54bd5e0b07e61325483973">Cleaner::cleanCompareFile</a></div><div class="ttdeci">Alignment * cleanCompareFile(float cutpoint, float baseLine, float *vectValues, bool complementary)</div><div class="ttdoc">Method to trim an alignment based on consistency values obtained from a dataset of alignments...</div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8cpp_source.html#l00792">Cleaner.cpp:792</a></div></div>
<div class="ttc" id="class_cleaner_html_aa57106470d2104a925b9396b8a9f33b3"><div class="ttname"><a href="class_cleaner.html#aa57106470d2104a925b9396b8a9f33b3">Cleaner::clean2ndSlope</a></div><div class="ttdeci">Alignment * clean2ndSlope(bool complementary)</div><div class="ttdoc">Method that carries the gappyout approach. This methods calculates the slope in gaps distribution on ...</div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8cpp_source.html#l00929">Cleaner.cpp:929</a></div></div>
<div class="ttc" id="class_cleaner_html_a13ae2074afb38708bc5cee9489d8ab6f"><div class="ttname"><a href="class_cleaner.html#a13ae2074afb38708bc5cee9489d8ab6f">Cleaner::cleanByCutValueOverpass</a></div><div class="ttdeci">Alignment * cleanByCutValueOverpass(double cut, float baseLine, const int *gInCol, bool complementary)</div><div class="ttdoc">Method to clean an alignment.  It removes sequences that overpass or equals a certain threshold...</div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8cpp_source.html#l00062">Cleaner.cpp:62</a></div></div>
<div class="ttc" id="class_cleaner_html_aee04f0a0d0662ed8ecb93766051414b9"><div class="ttname"><a href="class_cleaner.html#aee04f0a0d0662ed8ecb93766051414b9">Cleaner::alig</a></div><div class="ttdeci">Alignment * alig</div><div class="ttdoc">Pointer to the alignment that contains this object. </div><div class="ttdef"><b>Definition:</b> <a href="_cleaner_8h_source.html#l00455">Cleaner.h:455</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="_cleaner_8h.html">Cleaner.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
